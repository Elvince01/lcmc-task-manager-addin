{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js"],"sourcesContent":["// Task Manager task pane logic, wired to Excel via Office.js\n// Based on the scaffold in Task Manager Excel/addin/taskpane.js\n\n/* global document, Excel, Office */\n\n(function(){\n  const qs = (s)=>document.querySelector(s);\n  const qsa = (s)=>Array.from(document.querySelectorAll(s));\n  let teamMembersLoaded = false;\n  let hasUnsavedChanges = false;\n\n  // Email Summarizer API configuration\n  // For development: http://localhost:5002\n  // For production: Update to your internal server URL (e.g., http://summarizer.lcmcommodities.com:5002)\n  const EMAIL_SUMMARIZER_API_URL = 'http://192.168.1.141:5002';\n\n  // SmartBrief matching configuration\n  // Combined matching uses company name (60%) + date proximity (40%)\n  const SMARTBRIEF_MATCH_THRESHOLD = 0.5; // 0.0 to 1.0 (minimum combined score)\n\n  // Toast notification helper\n  function showToast(message, type = 'success') {\n    const toast = qs('#toast');\n    if (!toast) return;\n    toast.textContent = message;\n    toast.className = 'toast ' + type + ' show';\n    setTimeout(() => {\n      toast.classList.remove('show');\n    }, 3000);\n  }\n\n  // Check for missing fields and return array of missing field names\n  function checkMissingFields() {\n    const missing = [];\n\n    // Check company name\n    const companyName = qs('#companyName');\n    if (!companyName || !companyName.value.trim()) {\n      missing.push('Company Name');\n    }\n\n    // Check task category\n    const selectedCategories = Array.from(document.querySelectorAll('.category-toggle:checked'));\n    if (selectedCategories.length === 0) {\n      missing.push('Task Category');\n    }\n\n    // Check broker lead\n    const brokerLead = qs('#brokerLead');\n    if (!brokerLead || !brokerLead.value) {\n      missing.push('Broker Lead');\n    }\n\n    // Check assignees\n    const selectedAssignees = Array.from(document.querySelectorAll('#assignees input[type=checkbox]:checked'));\n    if (selectedAssignees.length === 0) {\n      missing.push('Assigned To');\n    }\n\n    // Check visible task cards for status and deadline\n    const visibleTaskCards = Array.from(document.querySelectorAll('.task-card')).filter(card => {\n      return card.style.display !== 'none' && card.id !== 'otherTaskCard';\n    });\n\n    visibleTaskCards.forEach(card => {\n      const taskName = card.dataset.task || 'Task';\n      const activeChip = card.querySelector('.chip.active');\n      const deadlineInput = card.querySelector('[data-role=\"deadline\"]');\n\n      if (!activeChip) {\n        missing.push(`${taskName}: Status`);\n      }\n      if (!deadlineInput || !deadlineInput.value) {\n        missing.push(`${taskName}: Deadline`);\n      }\n    });\n\n    // Check \"Other Task\" card if visible\n    const otherTaskCard = qs('#otherTaskCard');\n    if (otherTaskCard && otherTaskCard.style.display !== 'none') {\n      const taskNameInput = qs('#taskName');\n      if (!taskNameInput || !taskNameInput.value.trim()) {\n        missing.push('Other Task: Task Name');\n      }\n      const activeChip = otherTaskCard.querySelector('.chip.active');\n      if (!activeChip) {\n        missing.push('Other Task: Status');\n      }\n      const deadlineInput = otherTaskCard.querySelector('[data-role=\"deadline\"]');\n      if (!deadlineInput || !deadlineInput.value) {\n        missing.push('Other Task: Deadline');\n      }\n    }\n\n    return missing;\n  }\n\n  // Show missing fields warning in a styled popup\n  function showMissingFieldsWarning(missingFields) {\n    // Create overlay\n    const overlay = document.createElement('div');\n    overlay.className = 'confirm-overlay';\n    overlay.id = 'missingFieldsOverlay';\n\n    // Create box\n    const box = document.createElement('div');\n    box.className = 'confirm-box';\n    box.style.maxWidth = '320px';\n    box.style.textAlign = 'left';\n\n    // Title\n    const title = document.createElement('p');\n    title.innerHTML = '<strong style=\"color:#f59e0b;\"> Missing Fields</strong>';\n    title.style.marginBottom = '12px';\n    title.style.textAlign = 'center';\n    box.appendChild(title);\n\n    // Description\n    const desc = document.createElement('p');\n    desc.textContent = 'The following fields are empty:';\n    desc.style.fontSize = '12px';\n    desc.style.color = '#64748b';\n    desc.style.marginBottom = '8px';\n    box.appendChild(desc);\n\n    // List of missing fields\n    const list = document.createElement('ul');\n    list.style.cssText = 'margin:0 0 16px 0;padding-left:20px;font-size:12px;color:#334155;max-height:150px;overflow-y:auto;';\n    missingFields.forEach(field => {\n      const li = document.createElement('li');\n      li.textContent = field;\n      li.style.marginBottom = '4px';\n      list.appendChild(li);\n    });\n    box.appendChild(list);\n\n    // Close button\n    const btnWrap = document.createElement('div');\n    btnWrap.style.textAlign = 'center';\n    const closeBtn = document.createElement('button');\n    closeBtn.textContent = 'Got it';\n    closeBtn.style.cssText = 'padding:8px 24px;font-size:13px;font-weight:500;border:none;border-radius:6px;background:#1e40af;color:#fff;cursor:pointer;';\n    closeBtn.addEventListener('click', () => {\n      overlay.remove();\n    });\n    btnWrap.appendChild(closeBtn);\n    box.appendChild(btnWrap);\n\n    overlay.appendChild(box);\n    document.body.appendChild(overlay);\n  }\n\n  // Unsaved changes indicator\n  function setUnsavedChanges(unsaved) {\n    hasUnsavedChanges = unsaved;\n    const indicator = qs('#unsavedIndicator');\n    if (indicator) {\n      indicator.classList.toggle('visible', unsaved);\n    }\n  }\n\n  // Track form changes\n  function wireChangeTracking() {\n    const formElements = qsa('input, select, textarea');\n    formElements.forEach(el => {\n      el.addEventListener('change', () => setUnsavedChanges(true));\n      el.addEventListener('input', () => setUnsavedChanges(true));\n    });\n    // Also track chip clicks\n    qsa('.chip').forEach(chip => {\n      chip.addEventListener('click', () => setUnsavedChanges(true));\n    });\n  }\n\n  // Warn before leaving with unsaved changes\n  window.addEventListener('beforeunload', (e) => {\n    if (hasUnsavedChanges) {\n      e.preventDefault();\n      e.returnValue = '';\n      return '';\n    }\n  });\n\n  // Escape HTML helper\n  function escapeHtml(text) {\n    const div = document.createElement('div');\n    div.textContent = String(text || '');\n    return div.innerHTML;\n  }\n\n  // Due date warning helper\n  function getDueDateWarningClass(deadlineStr) {\n    if (!deadlineStr) return '';\n    const deadline = new Date(deadlineStr);\n    if (isNaN(deadline.getTime())) return '';\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n    deadline.setHours(0, 0, 0, 0);\n    const diffDays = Math.ceil((deadline - today) / (1000 * 60 * 60 * 24));\n    if (diffDays < 0) return 'overdue';\n    if (diffDays <= 3) return 'warning';\n    return '';\n  }\n\n  function formatDeadlineBadge(deadlineStr) {\n    const warningClass = getDueDateWarningClass(deadlineStr);\n    if (!warningClass) return '';\n    if (warningClass === 'overdue') {\n      return '<span class=\"deadline-badge overdue\"> Overdue</span>';\n    }\n    const deadline = new Date(deadlineStr);\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n    deadline.setHours(0, 0, 0, 0);\n    const diffDays = Math.ceil((deadline - today) / (1000 * 60 * 60 * 24));\n    if (diffDays === 0) return '<span class=\"deadline-badge warning\"> Due today</span>';\n    if (diffDays === 1) return '<span class=\"deadline-badge warning\"> Due tomorrow</span>';\n    return `<span class=\"deadline-badge warning\"> ${diffDays} days left</span>`;\n  }\n\n  // Apply deadline warnings to task cards\n  function applyDeadlineWarnings() {\n    qsa('.task-card').forEach(card => {\n      const deadlineInput = card.querySelector('[data-role=\"deadline\"]');\n      if (!deadlineInput) return;\n      const deadline = deadlineInput.value;\n      const warningClass = getDueDateWarningClass(deadline);\n      card.classList.remove('deadline-warning', 'deadline-overdue');\n      if (warningClass === 'overdue') {\n        card.classList.add('deadline-overdue');\n      } else if (warningClass === 'warning') {\n        card.classList.add('deadline-warning');\n      }\n    });\n  }\n\n  const companyNameInput = qs('#companyName');\n  // taskDescriptionEl is now a container with checkboxes, not a select\n  const brokerLeadEl = qs('#brokerLead');\n  const initialRequestInput = qs('#initialRequest');\n  const introEmailInput = qs('#introEmail');\n  const remindersStartInput = qs('#remindersStart');\n  const emailFrequencyEl = qs('#emailFrequency');\n  const extraNoteEl = qs('#extraNote');\n  const auditTextEl = qs('#auditText');\n  const tasksRowEl = qs('#tasksRow');\n  const taskCardsContainer = qs('#taskCards');\n  const taskNameInput = qs('#taskName'); // only for __other__ card\n\n  // Wire Save, New Task, Load Selected, and KYC Portal buttons\n  const saveBtn = qs('#saveBtn');\n  const newTaskBtn = qs('#newTaskBtn');\n  const loadSelectedBtn = qs('#loadSelectedBtn');\n  const openKycPortalBtn = qs('#openKycPortal');\n\n  // Track current row for display\n  let currentRowNum = null;\n\n  if (saveBtn) {\n    saveBtn.addEventListener('click', async () => {\n      try {\n        // Check for missing fields before saving\n        const missingFields = checkMissingFields();\n\n        if (currentRowNum === null || currentRowNum === 'new') {\n          await addNewTask();\n          showToast(' New task added successfully!', 'success');\n        } else {\n          await saveToActiveRow();\n          showToast(' Changes saved to row ' + currentRowNum, 'success');\n        }\n        setUnsavedChanges(false);\n\n        // Show missing fields warning after successful save\n        if (missingFields.length > 0) {\n          setTimeout(() => {\n            showMissingFieldsWarning(missingFields);\n          }, 500); // Delay to let the success toast show first\n        }\n      } catch (e) {\n        console.error('Save error:', e);\n        showToast(' Save failed: ' + e.message, 'error');\n      }\n    });\n  }\n\n  // Load Selected Row button (in By Row tab)\n  if (loadSelectedBtn) {\n    loadSelectedBtn.addEventListener('click', async () => {\n      try {\n        await loadFromActiveRow();\n        showToast(' Loaded row ' + currentRowNum, 'success');\n      } catch (e) {\n        console.error('Load error:', e);\n        showToast(' Failed to load row', 'error');\n      }\n    });\n  }\n\n  if (newTaskBtn) {\n    newTaskBtn.addEventListener('click', () => {\n      clearFormForNewTask();\n    });\n  }\n\n  // Custom confirm dialog (since window.confirm is not supported in Office Add-ins)\n  function showConfirmDialog(message) {\n    return new Promise((resolve) => {\n      const dialog = qs('#confirmDialog');\n      const msgEl = qs('#confirmMessage');\n      const cancelBtn = qs('#confirmCancel');\n      const okBtn = qs('#confirmOk');\n      \n      if (!dialog || !msgEl || !cancelBtn || !okBtn) {\n        resolve(false);\n        return;\n      }\n      \n      msgEl.textContent = message;\n      dialog.style.display = 'flex';\n      \n      const cleanup = () => {\n        dialog.style.display = 'none';\n        cancelBtn.removeEventListener('click', onCancel);\n        okBtn.removeEventListener('click', onOk);\n      };\n      \n      const onCancel = () => {\n        cleanup();\n        resolve(false);\n      };\n      \n      const onOk = () => {\n        cleanup();\n        resolve(true);\n      };\n      \n      cancelBtn.addEventListener('click', onCancel);\n      okBtn.addEventListener('click', onOk);\n    });\n  }\n\n  // Delete Task button\n  const deleteTaskBtn = qs('#deleteTaskBtn');\n  if (deleteTaskBtn) {\n    deleteTaskBtn.addEventListener('click', async () => {\n      // Don't allow delete if this is a new unsaved task\n      if (currentRowNum === null || currentRowNum === 'new') {\n        showToast('No task to delete - this is a new task', 'error');\n        return;\n      }\n      \n      // Confirm before deleting\n      const confirmed = await showConfirmDialog('Are you sure you want to delete this Task?');\n      if (!confirmed) return;\n      \n      try {\n        await deleteCurrentRow();\n        showToast(' Task deleted successfully', 'success');\n        clearFormForNewTask();\n      } catch (e) {\n        console.error('Delete error:', e);\n        showToast(' Failed to delete task: ' + e.message, 'error');\n      }\n    });\n  }\n\n  // Guard on the DOM element so we don't wire multiple listeners or open twice\n  if (openKycPortalBtn && openKycPortalBtn.dataset.kycListenerAttached !== '1') {\n    openKycPortalBtn.dataset.kycListenerAttached = '1';\n    openKycPortalBtn.addEventListener('click', (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n      if (openKycPortalBtn.dataset.kycOpening === '1') return;\n      openKycPortalBtn.dataset.kycOpening = '1';\n      window.open('http://192.168.1.141:8080/', '_blank');\n      setTimeout(() => { openKycPortalBtn.dataset.kycOpening = '0'; }, 1000);\n    });\n  }\n\n  // Statistics Navigation\n  const tasksView = qs('#tasksView');\n  const statsView = qs('#statsView');\n  const tasksHeader = qs('#tasksHeader');\n  const statsHeader = qs('#statsHeader');\n  const openStatsBtn = qs('#openStatsBtn');\n  const returnToTasksBtn = qs('#returnToTasksBtn');\n  const refreshStatsBtn = qs('#refreshStatsBtn');\n\n  if (openStatsBtn) {\n    openStatsBtn.addEventListener('click', () => {\n      if (tasksView) tasksView.style.display = 'none';\n      if (tasksHeader) tasksHeader.style.display = 'none';\n      if (statsView) statsView.style.display = '';\n      if (statsHeader) statsHeader.style.display = 'flex';\n      loadStatistics();\n    });\n  }\n\n  if (returnToTasksBtn) {\n    returnToTasksBtn.addEventListener('click', () => {\n      if (tasksView) tasksView.style.display = '';\n      if (tasksHeader) tasksHeader.style.display = 'flex';\n      if (statsView) statsView.style.display = 'none';\n      if (statsHeader) statsHeader.style.display = 'none';\n    });\n  }\n\n  if (refreshStatsBtn) {\n    refreshStatsBtn.addEventListener('click', () => {\n      loadStatistics();\n    });\n  }\n\n  // Statistics calculation\n  async function loadStatistics() {\n    try {\n      await Excel.run(async (context) => {\n        const sheet = context.workbook.worksheets.getItemOrNullObject('TASK MANAGER FORM');\n        sheet.load('name');\n        await context.sync();\n        if (sheet.isNullObject) {\n          console.error('Sheet not found for statistics');\n          return;\n        }\n\n        // Load all data\n        const dataRange = sheet.getRange('A1:K5000');\n        dataRange.load('values');\n        await context.sync();\n\n        const rows = dataRange.values || [];\n        if (rows.length < 2) return;\n\n        // Parse all tasks\n        const tasks = [];\n        let todoCount = 0, inProgressCount = 0, doneCount = 0;\n        const brokerStats = {};\n        const monthlyStats = {};\n        const kycMonthly = {};\n        let totalDuration = 0, durationCount = 0;\n        \n        // Attention items with details\n        const overdueItems = [];\n        const upcomingItems = [];\n        const staleItems = [];\n\n        const today = new Date();\n        today.setHours(0, 0, 0, 0);\n        const sevenDaysFromNow = new Date(today);\n        sevenDaysFromNow.setDate(sevenDaysFromNow.getDate() + 7);\n        const thirtyDaysAgo = new Date(today);\n        thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);\n\n        for (let i = 1; i < rows.length; i++) {\n          const row = rows[i];\n          const company = row[0] ? String(row[0]).trim() : '';\n          if (!company) continue;\n\n          const category = row[1] ? String(row[1]).trim() : '';\n          const broker = row[3] ? String(row[3]).trim() : '(none)';\n          const initialRequest = row[4]; // Column E - Initial Request Date\n          const introEmail = row[5]; // Column F - Intro Email Date\n          const remindersStart = row[6]; // Column G - Reminders Start Date\n          const taskSummary = row[7] ? String(row[7]).trim() : '';\n\n          // Parse dates from columns E, F, G for monthly stats\n          // Use the earliest available date as the task creation date\n          let taskDate = null;\n          const dateE = parseDate(initialRequest);\n          const dateF = parseDate(introEmail);\n          const dateG = parseDate(remindersStart);\n          \n          // Pick the earliest non-null date\n          const availableDates = [dateE, dateF, dateG].filter(d => d !== null);\n          if (availableDates.length > 0) {\n            taskDate = availableDates.reduce((min, d) => d < min ? d : min);\n          }\n          \n          if (taskDate) {\n            const monthKey = `${taskDate.getFullYear()}-${String(taskDate.getMonth() + 1).padStart(2, '0')}`;\n            monthlyStats[monthKey] = (monthlyStats[monthKey] || 0) + 1;\n          }\n\n          // Broker stats\n          if (!brokerStats[broker]) {\n            brokerStats[broker] = { total: 0, active: 0, completed: 0 };\n          }\n          brokerStats[broker].total++;\n\n          // Parse task summary for status\n          if (taskSummary) {\n            const lines = taskSummary.split(/\\r?\\n/).filter(Boolean);\n            lines.forEach(line => {\n              const lower = line.toLowerCase();\n              \n              // Count statuses\n              if (lower.includes(': to do')) {\n                todoCount++;\n                brokerStats[broker].active++;\n              } else if (lower.includes(': in progress')) {\n                inProgressCount++;\n                brokerStats[broker].active++;\n              } else if (lower.includes(': done')) {\n                doneCount++;\n                brokerStats[broker].completed++;\n              }\n\n              // Check for KYC completed\n              if (lower.includes('kyc') && lower.includes(': done')) {\n                const completedMatch = line.match(/completed:\\s*(\\d{1,2}[-\\s][A-Za-z]{3}[-\\s]\\d{2,4})/i);\n                if (completedMatch) {\n                  const kycDate = parseDate(completedMatch[1]);\n                  if (kycDate) {\n                    const monthKey = `${kycDate.getFullYear()}-${String(kycDate.getMonth() + 1).padStart(2, '0')}`;\n                    kycMonthly[monthKey] = (kycMonthly[monthKey] || 0) + 1;\n                  }\n                }\n              }\n\n              // Extract task name and assignee for attention items\n              const taskNameMatch = line.match(/^(.*?)\\s*:\\s*(to do|in progress|done)/i);\n              const assigneeMatch = line.match(/assigned to\\s+([^|]+)/i);\n              const taskName = taskNameMatch ? taskNameMatch[1].trim() : 'Unknown';\n              const assignee = assigneeMatch ? assigneeMatch[1].trim() : '';\n\n              // Check deadlines (support both formats)\n              const deadlineMatch = line.match(/deadline:\\s*(\\d{4}-\\d{2}-\\d{2}|\\d{1,2}[-\\s][A-Za-z]{3}[-\\s]\\d{2,4})/i);\n              if (deadlineMatch && !lower.includes(': done')) {\n                const deadline = parseDate(deadlineMatch[1]);\n                if (deadline) {\n                  const daysUntil = Math.ceil((deadline - today) / (1000 * 60 * 60 * 24));\n                  if (deadline < today) {\n                    overdueItems.push({\n                      company,\n                      task: taskName,\n                      assignee,\n                      detail: `${Math.abs(daysUntil)}d overdue`\n                    });\n                  } else if (deadline <= sevenDaysFromNow) {\n                    upcomingItems.push({\n                      company,\n                      task: taskName,\n                      assignee,\n                      detail: daysUntil === 0 ? 'Today' : `${daysUntil}d left`\n                    });\n                  }\n                }\n              }\n\n              // Check for stale tasks (no status update for 30+ days, not Done)\n              if (!lower.includes(': done')) {\n                // Look for the last action date (initiated, updated, or completed)\n                const initiatedMatch = line.match(/initiated:\\s*(\\d{1,2}[-\\s][A-Za-z]{3}[-\\s]\\d{2,4})/i);\n                const updatedMatch = line.match(/updated:\\s*(\\d{1,2}[-\\s][A-Za-z]{3}[-\\s]\\d{2,4})/i);\n                \n                let lastActionDate = null;\n                if (updatedMatch) {\n                  lastActionDate = parseDate(updatedMatch[1]);\n                } else if (initiatedMatch) {\n                  lastActionDate = parseDate(initiatedMatch[1]);\n                }\n                \n                if (lastActionDate && lastActionDate < thirtyDaysAgo) {\n                  const daysSince = Math.ceil((today - lastActionDate) / (1000 * 60 * 60 * 24));\n                  staleItems.push({\n                    company,\n                    task: taskName,\n                    assignee,\n                    detail: `${daysSince}d ago`\n                  });\n                }\n              }\n\n              // Calculate duration for completed tasks\n              if (lower.includes(': done')) {\n                const initiatedMatch = line.match(/initiated:\\s*(\\d{1,2}[-\\s][A-Za-z]{3}[-\\s]\\d{2,4})/i);\n                const completedMatch = line.match(/completed:\\s*(\\d{1,2}[-\\s][A-Za-z]{3}[-\\s]\\d{2,4})/i);\n                if (initiatedMatch && completedMatch) {\n                  const initiated = parseDate(initiatedMatch[1]);\n                  const completed = parseDate(completedMatch[1]);\n                  if (initiated && completed) {\n                    const days = Math.ceil((completed - initiated) / (1000 * 60 * 60 * 24));\n                    if (days >= 0 && days < 365) {\n                      totalDuration += days;\n                      durationCount++;\n                    }\n                  }\n                }\n              }\n            });\n          }\n        }\n\n        // Update UI\n        const activeTasks = todoCount + inProgressCount;\n        qs('#statActiveTasks').textContent = activeTasks;\n        qs('#statAvgDuration').textContent = durationCount > 0 ? Math.round(totalDuration / durationCount) : '-';\n\n        // Status bars\n        const totalStatus = todoCount + inProgressCount + doneCount;\n        if (totalStatus > 0) {\n          qs('#barToDo').style.width = (todoCount / totalStatus * 100) + '%';\n          qs('#barInProgress').style.width = (inProgressCount / totalStatus * 100) + '%';\n          qs('#barDone').style.width = (doneCount / totalStatus * 100) + '%';\n        }\n        qs('#countToDo').textContent = todoCount;\n        qs('#countInProgress').textContent = inProgressCount;\n        qs('#countDone').textContent = doneCount;\n\n        // Attention Required section - render counts and task lists\n        // Helper to render attention items and show/hide group\n        const renderAttentionGroup = (items, groupId, listId, countId) => {\n          const group = qs(`#${groupId}`);\n          const container = qs(`#${listId}`);\n          const countEl = qs(`#${countId}`);\n          \n          if (countEl) countEl.textContent = items.length;\n          \n          if (!group || !container) return;\n          \n          if (items.length === 0) {\n            group.classList.remove('has-items');\n            container.innerHTML = '';\n            return;\n          }\n          \n          group.classList.add('has-items');\n          // Format: \"Company: Task to Assignee\" with detail on right\n          container.innerHTML = items.slice(0, 10).map(item => {\n            const assigneePart = item.assignee ? ` <span class=\"to-assignee\">to ${escapeHtml(item.assignee)}</span>` : '';\n            return `<div class=\"attention-item\">\n              <span class=\"task-info\" title=\"${escapeHtml(item.company)}: ${escapeHtml(item.task)}\">${escapeHtml(item.company)}: ${escapeHtml(item.task)}${assigneePart}</span>\n              <span class=\"task-detail\">${escapeHtml(item.detail)}</span>\n            </div>`;\n          }).join('');\n        };\n        \n        // Sort and render each list\n        overdueItems.sort((a, b) => parseInt(b.detail) - parseInt(a.detail)); // Most overdue first\n        upcomingItems.sort((a, b) => parseInt(a.detail) - parseInt(b.detail)); // Soonest first\n        staleItems.sort((a, b) => parseInt(b.detail) - parseInt(a.detail)); // Oldest first\n        \n        renderAttentionGroup(overdueItems, 'overdueGroup', 'overdueList', 'statOverdue');\n        renderAttentionGroup(upcomingItems, 'upcomingGroup', 'upcomingList', 'statUpcoming');\n        renderAttentionGroup(staleItems, 'staleGroup', 'staleList', 'statStale');\n\n        // Monthly Activity Visual Chart\n        const monthlyChart = qs('#monthlyChart');\n        if (monthlyChart) {\n          const sortedMonths = Object.keys(monthlyStats).sort().reverse().slice(0, 6).reverse();\n          const maxTasks = Math.max(...sortedMonths.map(m => monthlyStats[m] || 0), 1);\n          const maxKyc = Math.max(...sortedMonths.map(m => kycMonthly[m] || 0), 1);\n          const maxVal = Math.max(maxTasks, maxKyc);\n          \n          const monthNames = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];\n          monthlyChart.innerHTML = sortedMonths.map(month => {\n            const [year, m] = month.split('-');\n            const shortMonth = monthNames[parseInt(m) - 1];\n            const tasks = monthlyStats[month] || 0;\n            const kyc = kycMonthly[month] || 0;\n            const taskHeight = maxVal > 0 ? (tasks / maxVal * 80) : 0;\n            const kycHeight = maxVal > 0 ? (kyc / maxVal * 80) : 0;\n            return `<div class=\"month-bar-group\">\n              <div class=\"month-bars\">\n                <div class=\"month-bar tasks\" style=\"height:${taskHeight}px\">\n                  ${tasks > 0 ? `<span class=\"month-bar-value\">${tasks}</span>` : ''}\n                </div>\n                <div class=\"month-bar kyc\" style=\"height:${kycHeight}px\">\n                  ${kyc > 0 ? `<span class=\"month-bar-value\">${kyc}</span>` : ''}\n                </div>\n              </div>\n              <div class=\"month-bar-label\">${shortMonth}</div>\n            </div>`;\n          }).join('');\n        }\n\n        // Broker Activity Visual Chart - Horizontal Bars like Status Distribution\n        const brokerChart = qs('#brokerChart');\n        if (brokerChart) {\n          const sortedBrokers = Object.entries(brokerStats)\n            .filter(([name]) => name && name !== '(none)' && name.trim() !== '')\n            .sort((a, b) => (b[1].active + b[1].completed) - (a[1].active + a[1].completed));\n          // Find max for scaling (active + completed combined)\n          const maxTasks = Math.max(...sortedBrokers.map(([,s]) => s.active + s.completed), 1);\n          \n          brokerChart.innerHTML = sortedBrokers.map(([name, stats]) => {\n            const activeWidth = maxTasks > 0 ? (stats.active / maxTasks * 100) : 0;\n            const completedWidth = maxTasks > 0 ? (stats.completed / maxTasks * 100) : 0;\n            return `<div class=\"broker-row\">\n              <span class=\"broker-name\" title=\"${escapeHtml(name)}\">${escapeHtml(name)}</span>\n              <div class=\"broker-bar-track\">\n                <div class=\"broker-bar-fill active\" style=\"width:${activeWidth}%\">${stats.active > 0 ? `<span class=\"bar-num\">${stats.active}</span>` : ''}</div>\n                <div class=\"broker-bar-fill completed\" style=\"width:${completedWidth}%\">${stats.completed > 0 ? `<span class=\"bar-num\">${stats.completed}</span>` : ''}</div>\n              </div>\n            </div>`;\n          }).join('');\n        }\n      });\n    } catch (e) {\n      console.error('Error loading statistics:', e);\n    }\n  }\n\n  // Helper to parse various date formats including Excel serial numbers\n  // Fix for timezone-related date parsing bug\n  // When parsing yyyy-MM-dd strings, JavaScript interprets them as UTC midnight.\n  // This can cause day shifts when the local timezone is behind UTC.\n  function parseDate(dateVal) {\n    if (!dateVal) return null;\n    \n    // Check if it's an Excel serial number (numeric value)\n    // Excel dates are days since Jan 1, 1900 (with a bug for 1900 leap year)\n    if (typeof dateVal === 'number' && dateVal > 1 && dateVal < 100000) {\n      // Excel serial date: days since Dec 30, 1899 (accounting for Excel's leap year bug)\n      // Use UTC to avoid timezone issues, then create local date\n      const excelEpoch = Date.UTC(1899, 11, 30); // Dec 30, 1899 in UTC\n      const utcDate = new Date(excelEpoch + dateVal * 24 * 60 * 60 * 1000);\n      // Create a local date with the same year/month/day\n      const result = new Date(utcDate.getUTCFullYear(), utcDate.getUTCMonth(), utcDate.getUTCDate());\n      if (!isNaN(result.getTime()) && result.getFullYear() > 1970) {\n        return result;\n      }\n    }\n    \n    // Try as string\n    const dateStr = String(dateVal).trim();\n    \n    // Handle yyyy-MM-dd format (ISO) - parse directly to avoid timezone issues\n    const isoMatch = dateStr.match(/^(\\d{4})-(\\d{2})-(\\d{2})$/);\n    if (isoMatch) {\n      const year = parseInt(isoMatch[1], 10);\n      const month = parseInt(isoMatch[2], 10) - 1; // 0-indexed\n      const day = parseInt(isoMatch[3], 10);\n      return new Date(year, month, day);\n    }\n    \n    // Try d-MMM-yyyy format (e.g., \"15-Nov-2025\")\n    const match = dateStr.match(/(\\d{1,2})[-\\s]([A-Za-z]{3})[-\\s](\\d{2,4})/);\n    if (match) {\n      const months = {jan:0,feb:1,mar:2,apr:3,may:4,jun:5,jul:6,aug:7,sep:8,oct:9,nov:10,dec:11};\n      const day = parseInt(match[1]);\n      const month = months[match[2].toLowerCase()];\n      let year = parseInt(match[3]);\n      if (year < 100) year += 2000;\n      if (month !== undefined) {\n        return new Date(year, month, day);\n      }\n    }\n    \n    // Fallback: try native parsing (but this may have timezone issues)\n    let d = new Date(dateStr);\n    if (!isNaN(d.getTime()) && d.getFullYear() > 1970) return d;\n    \n    return null;\n  }\n\n  // Search functionality\n  const searchInput = qs('#searchInput');\n  const searchInputWrap = qs('#searchInputWrap');\n  const searchBtn = qs('#searchBtn');\n  const searchResults = qs('#searchResults');\n  const searchHint = qs('#searchHint');\n  const searchTabs = qsa('.search-tab');\n  let currentSearchMode = 'active'; // Default to active tasks\n\n  // Update search UI based on mode\n  const loadRowHint = qs('#loadRowHint');\n  \n  function updateSearchUI() {\n    if (!searchHint || !searchInput || !searchInputWrap) return;\n    \n    if (currentSearchMode === 'active') {\n      searchInputWrap.style.display = 'none'; // No input needed\n      if (loadRowHint) loadRowHint.style.display = 'none';\n      searchHint.textContent = ' Showing tasks with status: To Do or In Progress';\n    } else if (currentSearchMode === 'company') {\n      searchInputWrap.style.display = 'flex';\n      if (loadRowHint) loadRowHint.style.display = 'flex';\n      searchInput.placeholder = 'Type company name...';\n      searchInput.type = 'text';\n      searchHint.textContent = '';\n    }\n  }\n\n  // Search tab switching\n  searchTabs.forEach(tab => {\n    tab.addEventListener('click', async () => {\n      searchTabs.forEach(t => t.classList.remove('active'));\n      tab.classList.add('active');\n      currentSearchMode = tab.getAttribute('data-search');\n      if (searchInput) {\n        searchInput.value = '';\n      }\n      updateSearchUI();\n      \n      // Auto-load active tasks when that tab is selected\n      if (currentSearchMode === 'active') {\n        await performSearch();\n      } else {\n        // Clear results for other modes until user searches\n        if (searchResults) {\n          searchResults.classList.remove('visible');\n          searchResults.innerHTML = '';\n        }\n      }\n    });\n  });\n\n  // Search button click\n  if (searchBtn) {\n    searchBtn.addEventListener('click', async () => {\n      await performSearch();\n    });\n  }\n\n  // Enter key in search input\n  if (searchInput) {\n    searchInput.addEventListener('keypress', async (e) => {\n      if (e.key === 'Enter') {\n        hideAutocomplete();\n        await performSearch();\n      }\n    });\n  }\n\n  // Autocomplete for company search\n  const autocompleteDropdown = qs('#autocompleteDropdown');\n  let companyList = []; // Cache of all companies with row numbers\n  let autocompleteTimeout = null;\n\n  // Load all companies for autocomplete (includes ALL rows, not just unique companies)\n  async function loadCompanyList() {\n    if (companyList.length > 0) return; // Already loaded\n    try {\n      await Excel.run(async (context) => {\n        const sheet = context.workbook.worksheets.getItemOrNullObject('TASK MANAGER FORM');\n        sheet.load('name');\n        await context.sync();\n        if (sheet.isNullObject) return;\n\n        // Load columns A (company) and B (task category) to differentiate multiple rows\n        const dataRange = sheet.getRange('A2:B5000');\n        dataRange.load('values');\n        await context.sync();\n\n        const values = dataRange.values || [];\n        companyList = [];\n        for (let i = 0; i < values.length; i++) {\n          const name = values[i][0] ? String(values[i][0]).trim() : '';\n          const category = values[i][1] ? String(values[i][1]).trim() : '';\n          if (name) {\n            companyList.push({ name, category, rowNum: i + 2 });\n          }\n        }\n        // Keep ALL entries - don't remove duplicates so users can see all tasks for a company\n        console.log('Loaded', companyList.length, 'company rows for autocomplete');\n      });\n    } catch (e) {\n      console.error('Failed to load company list:', e);\n    }\n  }\n\n  function showAutocomplete(query) {\n    if (!autocompleteDropdown || !query || currentSearchMode !== 'company') {\n      hideAutocomplete();\n      return;\n    }\n    const q = query.toLowerCase();\n    \n    // Filter matches and sort: companies starting with query first, then contains\n    const allMatches = companyList.filter(c => c.name.toLowerCase().includes(q));\n    const startsWithMatches = allMatches.filter(c => c.name.toLowerCase().startsWith(q));\n    const containsMatches = allMatches.filter(c => !c.name.toLowerCase().startsWith(q));\n    const sortedMatches = [...startsWithMatches, ...containsMatches].slice(0, 15);\n    \n    if (sortedMatches.length === 0) {\n      hideAutocomplete();\n      return;\n    }\n    autocompleteDropdown.innerHTML = sortedMatches.map(c => {\n      const categoryHint = c.category ? `  ${escapeHtml(c.category)}` : '';\n      return `<div class=\"autocomplete-item\" data-row=\"${c.rowNum}\" data-name=\"${escapeHtml(c.name)}\">\n        <span class=\"company-name\">${escapeHtml(c.name)}</span>\n        <span class=\"row-hint\">Row ${c.rowNum}${categoryHint}</span>\n      </div>`;\n    }).join('');\n    autocompleteDropdown.classList.add('visible');\n\n    // Wire click handlers\n    autocompleteDropdown.querySelectorAll('.autocomplete-item').forEach(item => {\n      item.addEventListener('click', async () => {\n        const rowNum = parseInt(item.getAttribute('data-row'), 10);\n        const name = item.getAttribute('data-name');\n        if (searchInput) searchInput.value = name;\n        hideAutocomplete();\n        await selectAndLoadRow(rowNum);\n      });\n    });\n  }\n\n  function hideAutocomplete() {\n    if (autocompleteDropdown) {\n      autocompleteDropdown.classList.remove('visible');\n      autocompleteDropdown.innerHTML = '';\n    }\n  }\n\n  // Wire autocomplete on input\n  if (searchInput) {\n    searchInput.addEventListener('input', (e) => {\n      if (currentSearchMode !== 'company') return;\n      clearTimeout(autocompleteTimeout);\n      const val = e.target.value.trim();\n      if (val.length < 1) {\n        hideAutocomplete();\n        return;\n      }\n      // Debounce to avoid too many updates\n      autocompleteTimeout = setTimeout(() => {\n        showAutocomplete(val);\n      }, 150);\n    });\n\n    searchInput.addEventListener('focus', async () => {\n      if (currentSearchMode === 'company') {\n        await loadCompanyList();\n        if (searchInput.value.trim().length >= 1) {\n          showAutocomplete(searchInput.value.trim());\n        }\n      }\n    });\n\n    searchInput.addEventListener('blur', () => {\n      // Delay hide to allow click on dropdown\n      setTimeout(hideAutocomplete, 200);\n    });\n  }\n\n  // Initialize search UI on load\n  updateSearchUI();\n\n  async function performSearch() {\n    if (!searchResults) return;\n    \n    searchResults.innerHTML = '<div class=\"no-results\">Searching...</div>';\n    searchResults.classList.add('visible');\n    console.log('Search started, mode:', currentSearchMode);\n\n    try {\n      await Excel.run(async (context) => {\n        const sheet = context.workbook.worksheets.getItemOrNullObject('TASK MANAGER FORM');\n        sheet.load('name');\n        await context.sync();\n        console.log('Sheet found:', !sheet.isNullObject);\n        if (sheet.isNullObject) {\n          searchResults.innerHTML = '<div class=\"no-results\">Sheet not found</div>';\n          return;\n        }\n\n        // Read a fixed block of rows to avoid issues with usedRange returning too small an area.\n        const maxRows = 5000;\n        const dataRange = sheet.getRange(`A1:K${maxRows}`);\n        dataRange.load('values');\n        await context.sync();\n\n        const rawValues = dataRange.values || [];\n        console.log('Raw rows loaded (including header and blanks):', rawValues.length);\n\n        const values = Array.isArray(rawValues) ? rawValues : [];\n        const results = [];\n        let scannedRows = 0;\n\n        for (let i = 1; i < values.length; i++) { // Skip header row\n          const row = values[i] || [];\n          const isEmpty = row.every(c => c === null || c === '');\n          if (isEmpty) continue;\n          scannedRows++;\n          const companyName = row[0] ? String(row[0]).trim() : '';\n          const taskCategory = row[1] ? String(row[1]).trim() : '';\n          const taskSummary = row[7] ? String(row[7]).trim() : ''; // Column H\n\n          // Determine status and dates from Column H\n          let hasActiveTasks = false;\n          let dominantStatus = 'unknown';\n          let hasTodo = false, hasProgress = false, hasDone = false;\n          let todoDates = [];\n          let progressDates = [];\n          let doneDates = [];\n\n          if (taskSummary) {\n            const lines = taskSummary.split(/\\r?\\n/).filter(Boolean);\n            lines.forEach(line => {\n              const parsed = parseTaskLine(line);\n              if (!parsed) return;\n              const st = (parsed.status || '').toLowerCase();\n              if (st === 'to do') {\n                hasTodo = true;\n                if (parsed.initiated) todoDates.push(parsed.initiated);\n              } else if (st === 'in progress') {\n                hasProgress = true;\n                if (parsed.updated) progressDates.push(parsed.updated);\n              } else if (st === 'done') {\n                hasDone = true;\n                if (parsed.completed) doneDates.push(parsed.completed);\n              }\n            });\n            hasActiveTasks = hasTodo || hasProgress;\n            if (hasProgress) dominantStatus = 'progress';\n            else if (hasTodo) dominantStatus = 'todo';\n            else if (hasDone) dominantStatus = 'done';\n          }\n\n          // Choose a status-specific date to display\n          function mostRecentDate(dateArr) {\n            if (!dateArr || dateArr.length === 0) return '';\n            let best = null;\n            dateArr.forEach(dStr => {\n              if (!dStr) return;\n              const d = new Date(dStr);\n              if (isNaN(d.getTime())) return;\n              if (!best || d > best) best = d;\n            });\n            if (!best) return '';\n            const yyyy = best.getFullYear();\n            const mm = String(best.getMonth() + 1).padStart(2,'0');\n            const dd = String(best.getDate()).padStart(2,'0');\n            return `${yyyy}-${mm}-${dd}`; // normalized for display formatter\n          }\n\n          let statusDateLabel = '';\n          let statusDateRaw = '';\n          if (dominantStatus === 'progress') {\n            statusDateRaw = mostRecentDate(progressDates);\n            statusDateLabel = statusDateRaw ? 'Updated' : '';\n          } else if (dominantStatus === 'todo') {\n            statusDateRaw = mostRecentDate(todoDates);\n            statusDateLabel = statusDateRaw ? 'Initiated' : '';\n          } else if (dominantStatus === 'done') {\n            statusDateRaw = mostRecentDate(doneDates);\n            statusDateLabel = statusDateRaw ? 'Completed' : '';\n          }\n\n          const statusDateDisplay = statusDateRaw ? formatDateForDisplay(statusDateRaw) : '';\n\n          const rowNum = i + 1; // 1-based row number\n\n          if (currentSearchMode === 'company') {\n            const query = (searchInput ? searchInput.value : '').toLowerCase().trim();\n            console.log('Checking row', rowNum, '- Company:', companyName, '- Query:', query);\n            if (query && companyName.toLowerCase().includes(query)) {\n              console.log('Match found:', companyName);\n              results.push({ rowNum, companyName, taskCategory, dominantStatus, hasActiveTasks, statusDateLabel, statusDateDisplay });\n            }\n          } else if (currentSearchMode === 'active') {\n            console.log('Checking row', rowNum, '- Company:', companyName, '- Active:', hasActiveTasks);\n            if (hasActiveTasks) {\n              results.push({ rowNum, companyName, taskCategory, dominantStatus, hasActiveTasks, statusDateLabel, statusDateDisplay });\n            }\n          }\n        }\n\n        const totalRows = scannedRows;\n        const modeLabel = currentSearchMode === 'company' ? 'Company' : 'Active tasks';\n        const rawQuery = (searchInput ? searchInput.value : '').trim();\n        console.log('Search complete, mode:', modeLabel, 'rows scanned:', totalRows, 'matches:', results.length, 'query:', rawQuery);\n        if (results.length === 0) {\n          searchResults.innerHTML = '<div class=\"no-results\">No results found</div>';\n        } else {\n          searchResults.innerHTML = results.map(r => {\n            const statusBadge = r.dominantStatus === 'progress' \n              ? '<span class=\"status-badge progress\">In Progress</span>'\n              : r.dominantStatus === 'todo'\n              ? '<span class=\"status-badge todo\">To Do</span>'\n              : r.dominantStatus === 'done'\n              ? '<span class=\"status-badge done\">Done</span>'\n              : '';\n\n            const datePart = (r.statusDateLabel && r.statusDateDisplay)\n              ? `  ${r.statusDateLabel} ${escapeHtml(r.statusDateDisplay)}`\n              : '';\n\n            return `<div class=\"search-result-item\" data-row=\"${r.rowNum}\">\n              <div class=\"company\">${escapeHtml(r.companyName || '(No name)')}${statusBadge}</div>\n              <div class=\"meta\">Row ${r.rowNum}  ${escapeHtml(r.taskCategory || 'No category')}${datePart}</div>\n            </div>`;\n          }).join('');\n\n          // Wire click handlers\n          searchResults.querySelectorAll('.search-result-item').forEach(item => {\n            item.addEventListener('click', async () => {\n              const rowNum = parseInt(item.getAttribute('data-row'), 10);\n              await selectAndLoadRow(rowNum);\n              searchResults.classList.remove('visible');\n            });\n          });\n        }\n      });\n    } catch (e) {\n      console.error('Search error:', e);\n      searchResults.innerHTML = '<div class=\"no-results\">Search error</div>';\n    }\n  }\n\n  async function selectAndLoadRow(rowNum) {\n    await Excel.run(async (context) => {\n      const sheet = context.workbook.worksheets.getItemOrNullObject('TASK MANAGER FORM');\n      sheet.load('name');\n      await context.sync();\n      if (sheet.isNullObject) return;\n\n      const targetRange = sheet.getRange(`A${rowNum}`);\n      targetRange.select();\n      await context.sync();\n    });\n    await loadFromActiveRow();\n  }\n\n  // Find Last KYC Produced date for a company\n  async function findLastKycDate(companyName) {\n    if (!companyName) return null;\n    \n    return Excel.run(async (context) => {\n      const sheet = context.workbook.worksheets.getItemOrNullObject('TASK MANAGER FORM');\n      sheet.load('name');\n      await context.sync();\n      if (sheet.isNullObject) return null;\n\n      const usedRange = sheet.getUsedRange();\n      usedRange.load('values');\n      await context.sync();\n\n      const values = usedRange.values || [];\n      let lastKycDate = null;\n\n      for (let i = 1; i < values.length; i++) {\n        const row = values[i];\n        const rowCompany = row[0] ? String(row[0]).trim().toLowerCase() : '';\n        const taskSummary = row[7] ? String(row[7]).trim() : ''; // Column H\n\n        if (rowCompany === companyName.toLowerCase() && taskSummary) {\n          // Look for KYC task with Done status\n          const lines = taskSummary.split(/\\r?\\n/).filter(Boolean);\n          lines.forEach(line => {\n            const lower = line.toLowerCase();\n            if ((lower.includes('kyc') && lower.includes(': done'))) {\n              // Try to extract completed date\n              const completedMatch = line.match(/completed:\\s*(\\d{1,2}[-\\s][A-Za-z]{3}[-\\s]\\d{2,4})/i);\n              if (completedMatch) {\n                lastKycDate = completedMatch[1];\n              }\n            }\n          });\n        }\n      }\n      return lastKycDate;\n    });\n  }\n\n  // Format date as d-MMM-yyyy (e.g., 1-Jul-2025)\n  // Fix for timezone-related date shift bug\n  // When parsing yyyy-MM-dd strings, JavaScript interprets them as UTC midnight.\n  // This can cause day shifts when converting back to local time.\n  function formatDateForDisplay(dateStr) {\n    if (!dateStr) return '';\n    \n    // Handle yyyy-MM-dd format specially to avoid timezone issues\n    const ymdMatch = String(dateStr).match(/^(\\d{4})-(\\d{2})-(\\d{2})$/);\n    if (ymdMatch) {\n      // Parse components directly to avoid UTC interpretation\n      const year = parseInt(ymdMatch[1], 10);\n      const month = parseInt(ymdMatch[2], 10) - 1; // 0-indexed\n      const day = parseInt(ymdMatch[3], 10);\n      const months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];\n      return `${day}-${months[month]}-${year}`;\n    }\n    \n    // For other formats, use Date parsing\n    const d = new Date(dateStr);\n    if (isNaN(d.getTime())) return '';\n    const months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];\n    const day = d.getDate();\n    const month = months[d.getMonth()];\n    const year = d.getFullYear();\n    return `${day}-${month}-${year}`;\n  }\n  \n  // Alias for Excel output (same format)\n  const formatDateForExcel = formatDateForDisplay;\n\n  // Get selected task categories\n  function getSelectedCategories() {\n    return qsa('#taskCategories .category-toggle:checked').map(cb => cb.value);\n  }\n\n  // Check if \"Other Task\" is selected\n  function isOtherTaskSelected() {\n    const cb = qs('#taskCategories .category-toggle[value=\"Other Task\"]');\n    return cb && cb.checked;\n  }\n\n  function getTaskCard(taskName){\n    // __other__ card is now outside #taskCards\n    if (taskName === '__other__') {\n      return qs('#otherTaskCard');\n    }\n    return taskCardsContainer ? taskCardsContainer.querySelector(`.task-card[data-task=\"${taskName}\"]`) : null;\n  }\n\n  function getTaskStatusChips(card){\n    if (!card) return [];\n    const container = card.querySelector('[data-role=\"status-chips\"]');\n    return container ? Array.from(container.querySelectorAll('.chip')) : [];\n  }\n\n  function setCardStatus(card, val){\n    const chips = getTaskStatusChips(card);\n    chips.forEach(c=>{\n      c.classList.toggle('active', c.getAttribute('data-value')===val);\n    });\n  }\n\n  function getCardStatus(card){\n    const chips = getTaskStatusChips(card);\n    const active = chips.find(c=>c.classList.contains('active'));\n    return active ? active.getAttribute('data-value') : 'To Do';\n  }\n\n  function wireCardChips(){\n    // Wire chips in #taskCards and #otherTaskCard\n    qsa('#taskCards [data-role=\"status-chips\"] .chip, #otherTaskCard [data-role=\"status-chips\"] .chip').forEach(chip => {\n      chip.addEventListener('click', () => {\n        const container = chip.closest('[data-role=\"status-chips\"]');\n        if (!container) return;\n        const siblings = Array.from(container.querySelectorAll('.chip'));\n        siblings.forEach(c=>{\n          c.classList.toggle('active', c === chip);\n        });\n      });\n    });\n  }\n\n  function syncTasksVisibility(){\n    if (!tasksRowEl || !taskCardsContainer) return;\n    const isOther = isOtherTaskSelected();\n    const otherCard = qs('#otherTaskCard'); // Now outside #taskCards\n    const selectedCategories = getSelectedCategories();\n    const hasNonOtherCategory = selectedCategories.some(c => c !== 'Other Task');\n\n    // Show tasks section if any non-\"Other Task\" category is selected\n    if (hasNonOtherCategory) {\n      tasksRowEl.style.display = '';\n    } else {\n      tasksRowEl.style.display = 'none';\n    }\n\n    // Show/hide fixed task cards based on task toggles\n    const selected = new Set(getSelectedTaskToggles());\n    const fixedCards = qsa('#taskCards .task-card');\n    fixedCards.forEach(card => {\n      const name = card.getAttribute('data-task');\n      card.style.display = selected.has(name) ? '' : 'none';\n    });\n\n    // Show __other__ card if \"Other Task\" category is selected\n    if (otherCard) {\n      otherCard.style.display = isOther ? '' : 'none';\n    }\n  }\n\n  // Update Extra Note placeholder based on selected categories\n  function updateExtraNotePlaceholder() {\n    if (!extraNoteEl) return;\n    const categories = getSelectedCategories().filter(c => c !== 'Other Task');\n    if (categories.length === 0) {\n      extraNoteEl.placeholder = 'General note about this task';\n    } else if (categories.length === 1) {\n      extraNoteEl.placeholder = 'General note about this ' + categories[0];\n    } else {\n      extraNoteEl.placeholder = 'General note about these tasks';\n    }\n  }\n\n  // Wire category checkboxes to update visibility and placeholder\n  qsa('#taskCategories .category-toggle').forEach(cb => {\n    cb.addEventListener('change', () => {\n      syncTasksVisibility();\n      updateExtraNotePlaceholder();\n    });\n  });\n\n  function getSelectedTaskToggles(){\n    return qsa('#tasksChecklist .task-toggle:checked').map(cb => cb.value);\n  }\n\n  // Reorder checkboxes so checked ones appear at the top\n  function reorderCheckboxesToTop(containerSelector) {\n    const container = qs(containerSelector);\n    if (!container) return;\n    \n    // Get all items - could be direct children (div wrappers) or labels\n    const items = Array.from(container.children);\n    if (items.length === 0) return;\n    \n    // Sort: checked items first, then unchecked (maintain original order within each group)\n    const checked = [];\n    const unchecked = [];\n    items.forEach(item => {\n      const cb = item.querySelector('input[type=checkbox]') || item.querySelector('input[type=\"checkbox\"]');\n      if (cb && cb.checked) {\n        checked.push(item);\n      } else {\n        unchecked.push(item);\n      }\n    });\n    \n    // Re-append in sorted order: checked first, then unchecked\n    [...checked, ...unchecked].forEach(item => container.appendChild(item));\n  }\n\n  async function loadTeamMembers(){\n    if (teamMembersLoaded) return;\n    teamMembersLoaded = true; // guard immediately to avoid overlapping calls\n    const box = qs('#assignees');\n    if (!box) return;\n    // Additional DOM-level guard in case the script is evaluated more than once\n    if (box.dataset.initialized === '1') {\n      return;\n    }\n    box.dataset.initialized = '1';\n    box.innerHTML='';\n\n    await Excel.run(async (context) => {\n      const sheet = context.workbook.worksheets.getItemOrNullObject('Team members');\n      sheet.load('name');\n      await context.sync();\n      if (sheet.isNullObject) {\n        console.error('Team members sheet not found');\n        return;\n      }\n\n      // Read column A only for team member names\n      const usedRange = sheet.getUsedRange();\n      usedRange.load('values');\n      await context.sync();\n\n      const values = usedRange.values || [];\n      const namesRaw = values.slice(1) // skip header row\n        .map(row => row[0])\n        .filter(n => n && String(n).trim().length > 0)\n        .map(n => String(n).trim());\n\n      const names = Array.from(new Set(namesRaw)); // dedupe\n      console.log('Team members loaded from column A:', names); // Debug log\n\n      names.forEach(n => {\n        const w = document.createElement('div');\n        w.innerHTML = `<label><input type=\"checkbox\" value=\"${n}\"> ${n}</label>`;\n        box.appendChild(w);\n      });\n\n      if (brokerLeadEl) {\n        brokerLeadEl.innerHTML = '';\n        const noneOpt = document.createElement('option');\n        noneOpt.value = '';\n        noneOpt.textContent = '(none)';\n        brokerLeadEl.appendChild(noneOpt);\n        names.forEach(n => {\n          const opt = document.createElement('option');\n          opt.value = n;\n          opt.textContent = n;\n          brokerLeadEl.appendChild(opt);\n        });\n      }\n    });\n  }\n\n  function getSelectedAssignees(){\n    return Array.from(document.querySelectorAll('#assignees input[type=checkbox]:checked')).map(i=>i.value);\n  }\n\n  // Populate per-task assignee dropdowns with selected assignees\n  function updateTaskAssigneeDropdowns() {\n    const selectedAssignees = getSelectedAssignees();\n    const dropdowns = qsa('.task-assignee-select');\n    \n    dropdowns.forEach(dropdown => {\n      const currentValue = dropdown.value;\n      dropdown.innerHTML = '';\n      \n      // Add empty option\n      const emptyOpt = document.createElement('option');\n      emptyOpt.value = '';\n      emptyOpt.textContent = '(Select assignee)';\n      dropdown.appendChild(emptyOpt);\n      \n      // Add selected assignees as options\n      selectedAssignees.forEach(name => {\n        const opt = document.createElement('option');\n        opt.value = name;\n        opt.textContent = name;\n        dropdown.appendChild(opt);\n      });\n      \n      // Auto-select if only one assignee\n      if (selectedAssignees.length === 1) {\n        dropdown.value = selectedAssignees[0];\n      } else if (selectedAssignees.includes(currentValue)) {\n        // Restore previous selection if still valid\n        dropdown.value = currentValue;\n      }\n    });\n  }\n\n  // Wire assignee checkboxes to update per-task dropdowns\n  document.querySelectorAll('#assignees').forEach(container => {\n    container.addEventListener('change', (e) => {\n      if (e.target.type === 'checkbox') {\n        updateTaskAssigneeDropdowns();\n      }\n    });\n  });\n\n  async function getActiveRowIndex(){\n    return Excel.run(async (context) => {\n      // Use the currently selected range in the workbook\n      const range = context.workbook.getSelectedRange();\n      range.load('rowIndex');\n      await context.sync();\n      // rowIndex is 0-based; UI shows 1-based row numbers\n      return range.rowIndex + 1;\n    });\n  }\n\n  function parseTaskLine(raw){\n    // More flexible parsing that handles fields in any order\n    if (!raw) return null;\n    \n    // First, check basic structure: \"TaskName: Status || Assigned to ...\"\n    const basicMatch = /^(.*?)\\s*:\\s*(to do|in progress|done)\\s*\\|\\|\\s*assigned to\\s+([^|]+)/i.exec(raw);\n    if (!basicMatch) return null;\n    \n    const result = {\n      name: basicMatch[1].trim(),\n      status: basicMatch[2],\n      assignee: basicMatch[3].trim(),\n      comment: '',\n      giveUpId: '',\n      initiated: '',\n      updated: '',\n      completed: '',\n      deadline: ''\n    };\n    \n    // Extract optional fields in any order\n    const commentMatch = /\\|\\|\\s*comment:\\s*([^|]+)/i.exec(raw);\n    if (commentMatch) result.comment = commentMatch[1].trim();\n    \n    const giveUpMatch = /\\|\\|\\s*give-up id:\\s*([^|]+)/i.exec(raw);\n    if (giveUpMatch) result.giveUpId = giveUpMatch[1].trim();\n    \n    const initiatedMatch = /\\|\\|\\s*task initiated:\\s*([^|]+)/i.exec(raw);\n    if (initiatedMatch) result.initiated = initiatedMatch[1].trim();\n    \n    const updatedMatch = /\\|\\|\\s*status updated:\\s*([^|]+)/i.exec(raw);\n    if (updatedMatch) result.updated = updatedMatch[1].trim();\n    \n    const completedMatch = /\\|\\|\\s*completed:\\s*([^|]+)/i.exec(raw);\n    if (completedMatch) result.completed = completedMatch[1].trim();\n    \n    const deadlineMatch = /\\|\\|\\s*deadline:\\s*([^|]+)/i.exec(raw);\n    if (deadlineMatch) result.deadline = deadlineMatch[1].trim();\n    \n    return result;\n  }\n\n  function buildSummaryLine(v){\n    const parts = [];\n    const status = v.status || 'To Do';\n    // First segment must match parseTaskLine: \"<TaskName>: <Status>\"\n    parts.push(`${v.name}: ${status}`);\n    parts.push(`Assigned to ${v.assignees}`);\n    if (v.comment) parts.push(`Comment: ${v.comment}`);\n    if (v.giveUpId) parts.push(`Give-up ID: ${v.giveUpId}`);\n    // Only one date field will be set based on status (last action)\n    if (v.initiated) parts.push(`Task initiated: ${v.initiated}`);\n    if (v.updated) parts.push(`Status updated: ${v.updated}`);\n    if (v.completed) parts.push(`Completed: ${v.completed}`);\n    if (v.deadline) parts.push(`Deadline: ${v.deadline}`);\n    return parts.join(' || ');\n  }\n\n  async function loadFromActiveRow(){\n    await loadTeamMembers();\n    await Excel.run(async (context) => {\n      // Get active row within the same context to avoid sync issues\n      const selectedRange = context.workbook.getSelectedRange();\n      selectedRange.load('rowIndex');\n      await context.sync();\n      const uiRow = selectedRange.rowIndex + 1;\n\n      const sheet = context.workbook.worksheets.getItemOrNullObject('TASK MANAGER FORM');\n      sheet.load('name');\n      await context.sync();\n      if (sheet.isNullObject) return;\n\n      // Load row-level metadata and Column H, J, K in one go\n      const companyRange = sheet.getRange(`A${uiRow}`);\n      const descRange = sheet.getRange(`B${uiRow}`);\n      const assigneesRange = sheet.getRange(`C${uiRow}`);\n      const brokerRange = sheet.getRange(`D${uiRow}`);\n      const datesRange = sheet.getRange(`E${uiRow}:G${uiRow}`);\n      const hRange = sheet.getRange(`H${uiRow}`);\n      const jRange = sheet.getRange(`J${uiRow}`);\n      const kRange = sheet.getRange(`K${uiRow}`);\n      companyRange.load('values');\n      descRange.load('values');\n      assigneesRange.load('values');\n      brokerRange.load('values');\n      datesRange.load('values');\n      hRange.load('values');\n      jRange.load('values');\n      kRange.load('values');\n      await context.sync();\n\n      // Company name from column A\n      const companyVal = (companyRange.values && companyRange.values[0] && companyRange.values[0][0])\n        ? String(companyRange.values[0][0])\n        : '';\n      if (companyNameInput) companyNameInput.value = companyVal;\n\n      const descVal = (descRange.values && descRange.values[0] && descRange.values[0][0])\n        ? String(descRange.values[0][0])\n        : '';\n      // Parse comma-separated categories and check the corresponding checkboxes\n      const categories = descVal.split(',').map(s => s.trim()).filter(Boolean);\n      const allowedDescs = ['Onboarding', 'Amended Product/Rate', 'KYC update', 'Other Task'];\n      qsa('#taskCategories .category-toggle').forEach(cb => {\n        const match = categories.some(cat => cat.toLowerCase() === cb.value.toLowerCase());\n        cb.checked = match;\n      });\n\n      const brokerVal = (brokerRange.values && brokerRange.values[0] && brokerRange.values[0][0])\n        ? String(brokerRange.values[0][0])\n        : '';\n\n      if (brokerLeadEl) {\n        brokerLeadEl.value = brokerVal;\n      }\n\n      // Assignees from column C\n      const assigneesVal = (assigneesRange.values && assigneesRange.values[0] && assigneesRange.values[0][0])\n        ? String(assigneesRange.values[0][0])\n        : '';\n      const assigneesList = assigneesVal.split(/[,;]+/).map(s => s.trim().toLowerCase()).filter(Boolean);\n      console.log('Assignees from column C:', assigneesList);\n      document.querySelectorAll('#assignees input[type=checkbox]').forEach(cb => {\n        cb.checked = assigneesList.includes(cb.value.toLowerCase());\n      });\n\n      const datesRow = (datesRange.values && datesRange.values[0]) ? datesRange.values[0] : [null, null, null];\n\n      // Fix for timezone-related date shift bug in toInputDate\n      // When parsing yyyy-MM-dd strings, JavaScript interprets them as UTC midnight.\n      // This can cause day shifts when converting back to local time.\n      function toInputDate(v){\n        if (v == null || v === '') return '';\n        \n        // Excel serial number (days since 1900-01-01, with Excel's leap year bug)\n        if (typeof v === 'number') {\n          // Excel serial date: 1 = Jan 1, 1900\n          // Use UTC to avoid timezone issues\n          const excelEpoch = Date.UTC(1899, 11, 30); // Dec 30, 1899 (Excel's day 0) in UTC\n          const d = new Date(excelEpoch + v * 86400000);\n          const yyyy = d.getUTCFullYear();\n          const mm = String(d.getUTCMonth() + 1).padStart(2,'0');\n          const dd = String(d.getUTCDate()).padStart(2,'0');\n          return `${yyyy}-${mm}-${dd}`;\n        }\n        \n        // Excel usually returns Date objects for date cells\n        if (v instanceof Date) {\n          const yyyy = v.getFullYear();\n          const mm = String(v.getMonth() + 1).padStart(2,'0');\n          const dd = String(v.getDate()).padStart(2,'0');\n          return `${yyyy}-${mm}-${dd}`;\n        }\n        \n        const s = String(v).trim();\n        \n        // Handle yyyy-MM-dd format (ISO) - parse directly to avoid timezone issues\n        const ymdMatch = s.match(/^(\\d{4})-(\\d{2})-(\\d{2})$/);\n        if (ymdMatch) {\n          return s; // Already in correct format, return as-is\n        }\n        \n        // Handle d-MMM-yyyy format (e.g., \"1-Jul-2025\")\n        const dmmyMatch = s.match(/^(\\d{1,2})-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\\d{4})$/i);\n        if (dmmyMatch) {\n          const months = {jan:0,feb:1,mar:2,apr:3,may:4,jun:5,jul:6,aug:7,sep:8,oct:9,nov:10,dec:11};\n          const day = parseInt(dmmyMatch[1], 10);\n          const mon = months[dmmyMatch[2].toLowerCase()];\n          const year = parseInt(dmmyMatch[3], 10);\n          const dd = String(day).padStart(2,'0');\n          const mm = String(mon + 1).padStart(2,'0');\n          return `${year}-${mm}-${dd}`;\n        }\n        \n        // Try to parse strings / other values as dates\n        // But be careful with timezone issues\n        const d = new Date(v);\n        if (!isNaN(d.getTime())) {\n          const yyyy = d.getFullYear();\n          const mm = String(d.getMonth() + 1).padStart(2,'0');\n          const dd = String(d.getDate()).padStart(2,'0');\n          return `${yyyy}-${mm}-${dd}`;\n        }\n        \n        // Fallback: attempt to slice a yyyy-MM-dd looking prefix\n        return s.length >= 10 ? s.slice(0,10) : '';\n      }\n\n      console.log('Date values from Excel:', datesRow); // Debug log\n      if (initialRequestInput) initialRequestInput.value = toInputDate(datesRow[0]);\n      if (introEmailInput) introEmailInput.value = toInputDate(datesRow[1]);\n      if (remindersStartInput) remindersStartInput.value = toInputDate(datesRow[2]);\n      console.log('Parsed dates:', initialRequestInput?.value, introEmailInput?.value, remindersStartInput?.value); // Debug log\n\n      // Email Frequency from column J\n      const freqVal = (jRange.values && jRange.values[0] && jRange.values[0][0])\n        ? String(jRange.values[0][0])\n        : '';\n      if (emailFrequencyEl) emailFrequencyEl.value = freqVal;\n\n      // Extra Note from column K\n      const noteVal = (kRange.values && kRange.values[0] && kRange.values[0][0])\n        ? String(kRange.values[0][0])\n        : '';\n      if (extraNoteEl) extraNoteEl.value = noteVal;\n\n      const summary = (hRange.values && hRange.values[0] && hRange.values[0][0])\n        ? String(hRange.values[0][0])\n        : '';\n\n      // Parse all task lines in H\n      const lines = summary\n        .split(/\\r?\\n/)\n        .map(s => s.trim())\n        .filter(Boolean);\n      const parsedTasks = [];\n      const nonTaskLines = [];\n      for (let i = 0; i < lines.length; i++) {\n        const cand = parseTaskLine(lines[i]);\n        if (cand) {\n          parsedTasks.push(cand);\n        } else {\n          nonTaskLines.push(lines[i]);\n        }\n      }\n\n      // Sort tasks by status priority: To Do > In Progress > Done\n      const statusPriority = { 'to do': 1, 'in progress': 2, 'done': 3 };\n      parsedTasks.sort((a, b) => {\n        const aPriority = statusPriority[(a.status || '').toLowerCase()] || 4;\n        const bPriority = statusPriority[(b.status || '').toLowerCase()] || 4;\n        return aPriority - bPriority;\n      });\n\n      // Note: Assignees are already loaded from Column C (lines 1297-1305)\n      // Column C contains ALL assignees including \"passive\" ones not assigned to specific tasks\n      // We don't overwrite here - the checkboxes are already correctly set from Column C\n      console.log('Parsed tasks:', parsedTasks); // Debug log\n\n      // Update per-task assignee dropdowns with selected assignees\n      updateTaskAssigneeDropdowns();\n\n      // Reset all cards and task selections\n      qsa('#tasksChecklist .task-toggle').forEach(cb => { cb.checked = false; });\n      qsa('#taskCards .task-card, #otherTaskCard').forEach(card => {\n        const statusChips = getTaskStatusChips(card);\n        statusChips.forEach(c => c.classList.remove('active'));\n        const commentEl = card.querySelector('[data-role=\"comment\"]');\n        const deadlineEl = card.querySelector('[data-role=\"deadline\"]');\n        const giveUpIdEl = card.querySelector('[data-role=\"giveUpId\"]');\n        const taskAssigneeEl = card.querySelector('[data-role=\"task-assignee\"]');\n        if (commentEl) commentEl.value = '';\n        if (deadlineEl) deadlineEl.value = '';\n        if (giveUpIdEl) giveUpIdEl.value = '';\n        if (taskAssigneeEl) taskAssigneeEl.value = '';\n      });\n\n      const isOther = isOtherTaskSelected();\n      if (isOther) {\n        // Use __other__ card with first parsed task if present\n        const otherCard = getTaskCard('__other__');\n        if (otherCard) {\n          const t = parsedTasks[0] || null;\n          if (taskNameInput) taskNameInput.value = t && t.name ? t.name : '';\n          if (t) {\n            const sNorm = (t.status || '').toLowerCase();\n            const displayStatus = sNorm === 'in progress' ? 'In Progress'\n              : sNorm === 'done' ? 'Done'\n              : 'To Do';\n            setCardStatus(otherCard, displayStatus);\n            const commentEl = otherCard.querySelector('[data-role=\"comment\"]');\n            const deadlineEl = otherCard.querySelector('[data-role=\"deadline\"]');\n            const taskAssigneeEl = otherCard.querySelector('[data-role=\"task-assignee\"]');\n            if (commentEl) commentEl.value = t.comment || '';\n            if (deadlineEl) deadlineEl.value = (t.deadline || '').slice(0,10);\n            // Set per-task assignee from parsed task\n            if (taskAssigneeEl && t.assignee) {\n              taskAssigneeEl.value = t.assignee.trim();\n            }\n          }\n        }\n      } else {\n        // Fixed tasks: tick checkboxes and populate corresponding cards\n        const toggles = qsa('#tasksChecklist .task-toggle');\n        toggles.forEach(cb => {\n          const name = cb.value;\n          // Map legacy \"KYC (Internal)\" to \"KYC (produced by LCMC)\"\n          const t = parsedTasks.find(pt => {\n            const ptName = (pt.name || '').toLowerCase();\n            const cbName = name.toLowerCase();\n            if (ptName === cbName) return true;\n            // Legacy mapping\n            if (cbName === 'kyc (produced by lcmc)' && ptName === 'kyc (internal)') return true;\n            return false;\n          });\n          cb.checked = !!t;\n          const card = getTaskCard(name);\n          if (card && t) {\n            const sNorm = (t.status || '').toLowerCase();\n            const displayStatus = sNorm === 'in progress' ? 'In Progress'\n              : sNorm === 'done' ? 'Done'\n              : 'To Do';\n            setCardStatus(card, displayStatus);\n            const commentEl = card.querySelector('[data-role=\"comment\"]');\n            const deadlineEl = card.querySelector('[data-role=\"deadline\"]');\n            const giveUpIdEl = card.querySelector('[data-role=\"giveUpId\"]');\n            const taskAssigneeEl = card.querySelector('[data-role=\"task-assignee\"]');\n            if (commentEl) commentEl.value = t.comment || '';\n            if (deadlineEl) deadlineEl.value = (t.deadline || '').slice(0,10);\n            if (giveUpIdEl) giveUpIdEl.value = t.giveUpId || '';\n            // Set per-task assignee from parsed task\n            if (taskAssigneeEl && t.assignee) {\n              taskAssigneeEl.value = t.assignee.trim();\n            }\n          }\n        });\n      }\n\n      // Audit info from the most recently completed/updated task if available\n      if (auditTextEl) {\n        let chosenAudit = null;\n        if (parsedTasks.length > 0) {\n          chosenAudit = parsedTasks[0];\n        }\n        if (chosenAudit) {\n          const parts = [];\n          if (chosenAudit.initiated) parts.push(`Task initiated: ${chosenAudit.initiated}`);\n          if (chosenAudit.updated) parts.push(`Status updated: ${chosenAudit.updated}`);\n          if (chosenAudit.completed) parts.push(`Completed: ${chosenAudit.completed}`);\n          auditTextEl.textContent = parts.join(' | ');\n        } else {\n          auditTextEl.textContent = '';\n        }\n      }\n\n      // Update Last KYC Produced date\n      const lastKycEl = qs('#lastKycDate');\n      if (lastKycEl && companyVal) {\n        // Look for KYC Done status in current row's tasks\n        let kycCompletedDate = null;\n        parsedTasks.forEach(t => {\n          if (t.name && t.name.toLowerCase().includes('kyc') && \n              t.status && t.status.toLowerCase() === 'done' && t.completed) {\n            kycCompletedDate = t.completed;\n          }\n        });\n        if (kycCompletedDate) {\n          lastKycEl.textContent = kycCompletedDate;\n        } else {\n          // Search all rows for this company's last KYC\n          findLastKycDate(companyVal).then(date => {\n            lastKycEl.textContent = date || '';\n          });\n        }\n      } else if (lastKycEl) {\n        lastKycEl.textContent = '';\n      }\n\n      syncTasksVisibility();\n      updateDateDisplays();\n      updateExtraNotePlaceholder();\n      \n      // Reorder checked items to top\n      reorderCheckboxesToTop('#assignees');\n      reorderCheckboxesToTop('#tasksChecklist');\n      reorderCheckboxesToTop('#taskCategories');\n\n      // Track current row number for save logic\n      currentRowNum = uiRow;\n\n      // Apply deadline warnings to task cards\n      applyDeadlineWarnings();\n\n      // Update email summary button state\n      updateEmailSummaryButton();\n\n      // Close email summary section when switching rows\n      if (emailSummarySection) {\n        emailSummarySection.classList.remove('visible');\n      }\n    });\n  }\n\n  async function saveToActiveRow(){\n    const descVal = getSelectedCategories().join(', ');\n    const assignees = getSelectedAssignees().join(', ');\n    const isOther = isOtherTaskSelected();\n    console.log('Saving - Categories:', descVal, 'Assignees:', assignees, 'IsOther:', isOther);\n    await Excel.run(async (context) => {\n      // Get active row within the same context to avoid sync issues\n      const selectedRange = context.workbook.getSelectedRange();\n      selectedRange.load('rowIndex');\n      await context.sync();\n      const uiRow = selectedRange.rowIndex + 1;\n\n      const sheet = context.workbook.worksheets.getItemOrNullObject('TASK MANAGER FORM');\n      sheet.load('name');\n      await context.sync();\n      if (sheet.isNullObject) return;\n\n      // Persist row-level dates (E-G)\n      const datesRange = sheet.getRange(`E${uiRow}:G${uiRow}`);\n      datesRange.load('values');\n\n      // Persist company name (A), task category (B), assignees (C), broker lead (D)\n      const companyRange = sheet.getRange(`A${uiRow}`);\n      const descRange = sheet.getRange(`B${uiRow}`);\n      const assigneesRange = sheet.getRange(`C${uiRow}`);\n      const brokerRange = sheet.getRange(`D${uiRow}`);\n\n      const hRange = sheet.getRange(`H${uiRow}`);\n      const jRange = sheet.getRange(`J${uiRow}`);\n      const kRange = sheet.getRange(`K${uiRow}`);\n      hRange.load('values');\n      await context.sync();\n\n      const datesRow = (datesRange.values && datesRange.values[0]) ? datesRange.values[0] : [null,null,null];\n\n      // Format dates as d-MMM-yyyy for Excel display\n      if (initialRequestInput) datesRow[0] = formatDateForExcel(initialRequestInput.value);\n      if (introEmailInput) datesRow[1] = formatDateForExcel(introEmailInput.value);\n      if (remindersStartInput) datesRow[2] = formatDateForExcel(remindersStartInput.value);\n\n      datesRange.values = [datesRow];\n\n      descRange.values = [[descVal]];\n\n      if (brokerLeadEl) {\n        brokerRange.values = [[brokerLeadEl.value || '']];\n      }\n\n      if (companyNameInput) {\n        companyRange.values = [[companyNameInput.value || '']];\n      }\n\n      // Save assignees to Column C\n      assigneesRange.values = [[assignees]];\n      console.log('Saving assignees to column C:', assignees);\n\n      // Save Email Frequency (J) and Extra Note (K)\n      if (emailFrequencyEl) {\n        jRange.values = [[emailFrequencyEl.value || '']];\n      }\n      if (extraNoteEl) {\n        kRange.values = [[extraNoteEl.value || '']];\n      }\n\n      const existing = (hRange.values && hRange.values[0] && hRange.values[0][0])\n        ? String(hRange.values[0][0])\n        : '';\n\n      const lines = existing\n        .split(/\\r?\\n/)\n        .map(s => s.trim())\n        .filter(Boolean);\n\n      const nonTaskLines = lines.filter(l => !parseTaskLine(l));\n      const newTaskLines = [];\n\n      // Parse existing tasks to preserve dates\n      const existingTasks = {};\n      lines.forEach(l => {\n        const parsed = parseTaskLine(l);\n        if (parsed) {\n          existingTasks[parsed.name.toLowerCase()] = parsed;\n        }\n      });\n\n      // Helper to get today's date in d-MMM-yyyy format\n      const getTodayFormatted = () => {\n        const d = new Date();\n        const months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];\n        return `${String(d.getDate()).padStart(2,'0')} ${months[d.getMonth()]} ${String(d.getFullYear()).slice(-2)}`;\n      };\n\n      // Helper to compute dates based on status and existing task\n      // Only show ONE date field based on current status (last action):\n      // - To Do: Task initiated\n      // - In Progress: Status updated\n      // - Done: Completed\n      const computeDates = (name, newStatus, existingTask) => {\n        const today = getTodayFormatted();\n        const oldStatus = existingTask ? (existingTask.status || '').toLowerCase() : '';\n        const newStatusLower = (newStatus || '').toLowerCase();\n        \n        // Preserve existing dates (use empty string if not present)\n        let initiated = (existingTask && existingTask.initiated) ? existingTask.initiated : '';\n        let updated = (existingTask && existingTask.updated) ? existingTask.updated : '';\n        let completed = (existingTask && existingTask.completed) ? existingTask.completed : '';\n        \n        // Check if this task has ANY date - if not, it's effectively new\n        const hasAnyDate = initiated || updated || completed;\n\n        // Update the relevant date based on status\n        // We show only ONE date field based on current status (last action)\n        if (newStatusLower === 'to do') {\n          // For To Do: always show initiated date\n          initiated = initiated || today;\n          // Clear other dates for display\n          updated = '';\n          completed = '';\n        } else if (newStatusLower === 'in progress') {\n          // For In Progress: set updated date if new or status changed\n          if (!hasAnyDate || oldStatus !== newStatusLower) {\n            updated = today;\n          }\n          // Clear other dates for display\n          initiated = '';\n          completed = '';\n        } else if (newStatusLower === 'done') {\n          // For Done: set completed date if new or status changed\n          if (!hasAnyDate || !completed || oldStatus !== newStatusLower) {\n            completed = today;\n          }\n          // Clear other dates for display\n          initiated = '';\n          updated = '';\n        }\n\n        return { initiated, updated, completed };\n      };\n\n      if (isOther) {\n        const otherCard = getTaskCard('__other__');\n        const name = taskNameInput ? taskNameInput.value.trim() : '';\n        if (name) {\n          const status = getCardStatus(otherCard) || 'To Do';\n          const commentEl = otherCard ? otherCard.querySelector('[data-role=\"comment\"]') : null;\n          const deadlineEl = otherCard ? otherCard.querySelector('[data-role=\"deadline\"]') : null;\n          const taskAssigneeEl = otherCard ? otherCard.querySelector('[data-role=\"task-assignee\"]') : null;\n          // Use per-task assignee if set, otherwise fall back to global assignees\n          const taskAssignee = taskAssigneeEl && taskAssigneeEl.value ? taskAssigneeEl.value : assignees;\n          \n          // Look up existing task to preserve dates\n          const existingTask = existingTasks[name.toLowerCase()];\n          const dates = computeDates(name, status, existingTask);\n          \n          const payload = {\n            name,\n            status,\n            assignees: taskAssignee,\n            comment: commentEl ? commentEl.value.trim() : '',\n            giveUpId: '',\n            initiated: dates.initiated,\n            updated: dates.updated,\n            completed: dates.completed,\n            deadline: deadlineEl ? deadlineEl.value : ''\n          };\n          const builtLine = buildSummaryLine(payload);\n          newTaskLines.push({ line: builtLine, status });\n        }\n      } else {\n        const toggles = getSelectedTaskToggles();\n        const fixedNames = ['Broker Agreement','Give-up Agreement','Amend Annex A','KYC (produced by LCMC)','KYC External'];\n        toggles.forEach(name => {\n          if (!fixedNames.includes(name)) return;\n          const card = getTaskCard(name);\n          if (!card) return;\n          const status = getCardStatus(card);\n          const commentEl = card.querySelector('[data-role=\"comment\"]');\n          const deadlineEl = card.querySelector('[data-role=\"deadline\"]');\n          const giveUpIdEl = card.querySelector('[data-role=\"giveUpId\"]');\n          const taskAssigneeEl = card.querySelector('[data-role=\"task-assignee\"]');\n          // Use per-task assignee if set, otherwise fall back to global assignees\n          const taskAssignee = taskAssigneeEl && taskAssigneeEl.value ? taskAssigneeEl.value : assignees;\n          \n          // Look up existing task to preserve dates (handle legacy KYC name)\n          let existingTask = existingTasks[name.toLowerCase()];\n          if (!existingTask && name.toLowerCase() === 'kyc (produced by lcmc)') {\n            existingTask = existingTasks['kyc (internal)'];\n          }\n          const dates = computeDates(name, status, existingTask);\n          \n          const payload = {\n            name,\n            status,\n            assignees: taskAssignee,\n            comment: commentEl ? commentEl.value.trim() : '',\n            giveUpId: giveUpIdEl ? giveUpIdEl.value.trim() : '',\n            initiated: dates.initiated,\n            updated: dates.updated,\n            completed: dates.completed,\n            deadline: deadlineEl ? deadlineEl.value : ''\n          };\n          newTaskLines.push({ line: buildSummaryLine(payload), status });\n        });\n      }\n\n      // Sort task lines by status priority: To Do > In Progress > Done\n      const statusPriority = { 'to do': 1, 'in progress': 2, 'done': 3 };\n      newTaskLines.sort((a, b) => {\n        const aPriority = statusPriority[(a.status || '').toLowerCase()] || 4;\n        const bPriority = statusPriority[(b.status || '').toLowerCase()] || 4;\n        return aPriority - bPriority;\n      });\n      const sortedLines = newTaskLines.map(t => t.line);\n\n      const newValue = nonTaskLines.concat(sortedLines).filter(Boolean).join('\\n');\n      console.log('Saving to H - newTaskLines:', sortedLines, 'newValue:', newValue);\n\n      hRange.values = [[newValue]];\n\n      // Apply font color based on status priority: In Progress > To Do > Done\n      // Since Excel.js can't do per-line colors, use the \"most urgent\" status\n      if (sortedLines.length > 0) {\n        let hasInProgress = false;\n        let hasToDo = false;\n        let hasDone = false;\n        \n        sortedLines.forEach(line => {\n          const lower = line.toLowerCase();\n          if (lower.includes(': in progress')) hasInProgress = true;\n          else if (lower.includes(': to do')) hasToDo = true;\n          else if (lower.includes(': done')) hasDone = true;\n        });\n        \n        // Priority: In Progress (orange) > To Do (green) > Done (red)\n        // Use original Google Sheet colours: To Do #34a853, In Progress #ff9900, Done #cc6666\n        let fontColor;\n        if (hasInProgress) {\n          fontColor = '#ff9900'; // In Progress (orange)\n        } else if (hasToDo) {\n          fontColor = '#34a853'; // To Do (green)\n        } else if (hasDone) {\n          fontColor = '#cc6666'; // Done (soft red)\n        } else {\n          fontColor = '#34a853'; // default green\n        }\n        hRange.format.font.color = fontColor;\n      }\n\n      await context.sync();\n      console.log('Save completed successfully for row', uiRow);\n    });\n  }\n\n  // Clear form for a fresh new task entry\n  function clearFormForNewTask() {\n    // Clear company name\n    if (companyNameInput) companyNameInput.value = '';\n    \n    // Reset task category checkboxes\n    qsa('#taskCategories .category-toggle').forEach(cb => {\n      cb.checked = false;\n    });\n    \n    // Clear broker lead\n    if (brokerLeadEl) brokerLeadEl.value = '';\n    \n    // Clear all assignee checkboxes\n    document.querySelectorAll('#assignees input[type=checkbox]').forEach(cb => {\n      cb.checked = false;\n    });\n    \n    // Clear dates\n    if (initialRequestInput) initialRequestInput.value = '';\n    if (introEmailInput) introEmailInput.value = '';\n    if (remindersStartInput) remindersStartInput.value = '';\n    \n    // Clear email frequency and extra note\n    if (emailFrequencyEl) emailFrequencyEl.value = '';\n    if (extraNoteEl) extraNoteEl.value = '';\n    \n    // Uncheck all task toggles\n    qsa('#tasksChecklist .task-toggle').forEach(cb => {\n      cb.checked = false;\n    });\n    \n    // Reset all task cards (including Other Task card)\n    qsa('#taskCards .task-card, #otherTaskCard').forEach(card => {\n      // Reset status chips\n      const chips = card.querySelectorAll('[data-role=\"status-chips\"] .chip');\n      chips.forEach(c => c.classList.remove('active'));\n      \n      // Clear comment\n      const commentEl = card.querySelector('[data-role=\"comment\"]');\n      if (commentEl) commentEl.value = '';\n      \n      // Clear deadline\n      const deadlineEl = card.querySelector('[data-role=\"deadline\"]');\n      if (deadlineEl) deadlineEl.value = '';\n      \n      // Clear give-up ID\n      const giveUpIdEl = card.querySelector('[data-role=\"giveUpId\"]');\n      if (giveUpIdEl) giveUpIdEl.value = '';\n      \n      // Clear per-task assignee\n      const taskAssigneeEl = card.querySelector('[data-role=\"task-assignee\"]');\n      if (taskAssigneeEl) taskAssigneeEl.value = '';\n    });\n    \n    // Clear other task name\n    if (taskNameInput) taskNameInput.value = '';\n    \n    // Clear audit text\n    if (auditTextEl) auditTextEl.textContent = '';\n    \n    // Clear Last KYC date\n    const lastKycEl = qs('#lastKycDate');\n    if (lastKycEl) lastKycEl.textContent = '';\n    \n    // Clear search results\n    if (searchResults) {\n      searchResults.classList.remove('visible');\n      searchResults.innerHTML = '';\n    }\n\n    // Close email summary section\n    if (emailSummarySection) {\n      emailSummarySection.classList.remove('visible');\n    }\n\n    // Mark as new task for save logic\n    currentRowNum = 'new';\n\n    // Update email summary button state\n    updateEmailSummaryButton();\n    \n    // Clear date displays\n    updateDateDisplays();\n    \n    // Update visibility and placeholder\n    syncTasksVisibility();\n    updateExtraNotePlaceholder();\n\n    // Autofocus first visible task comment field after a short delay\n    setTimeout(() => {\n      const visibleCard = document.querySelector('#taskCards .task-card:not([style*=\"display: none\"]), #otherTaskCard:not([style*=\"display: none\"])');\n      if (visibleCard) {\n        const commentEl = visibleCard.querySelector('[data-role=\"comment\"]');\n        if (commentEl && typeof commentEl.focus === 'function') {\n          commentEl.focus();\n        }\n      }\n    }, 100);\n  }\n\n  // Delete the current row from Excel\n  async function deleteCurrentRow() {\n    if (currentRowNum === null || currentRowNum === 'new') {\n      throw new Error('No row to delete');\n    }\n    \n    await Excel.run(async (context) => {\n      const sheet = context.workbook.worksheets.getItemOrNullObject('TASK MANAGER FORM');\n      sheet.load('name');\n      await context.sync();\n      \n      if (sheet.isNullObject) {\n        throw new Error('Sheet TASK MANAGER FORM not found');\n      }\n      \n      // Delete the entire row\n      const rowRange = sheet.getRange(`${currentRowNum}:${currentRowNum}`);\n      rowRange.delete(Excel.DeleteShiftDirection.up);\n      \n      await context.sync();\n      console.log('Deleted row', currentRowNum);\n    });\n  }\n\n  // Add a new task to the next available row\n  async function addNewTask() {\n    await Excel.run(async (context) => {\n      const sheet = context.workbook.worksheets.getItemOrNullObject('TASK MANAGER FORM');\n      sheet.load('name');\n      await context.sync();\n      if (sheet.isNullObject) {\n        console.error('Sheet TASK MANAGER FORM not found');\n        return;\n      }\n\n      // Find the first empty row by scanning column A from row 2 onwards\n      const colA = sheet.getRange('A2:A1000');\n      colA.load('values');\n      await context.sync();\n\n      let nextRow = 2; // Start from row 2 (after header)\n      const values = colA.values || [];\n      for (let i = 0; i < values.length; i++) {\n        if (values[i][0] && String(values[i][0]).trim() !== '') {\n          nextRow = i + 3; // i is 0-indexed, row 2 is first data row, so next empty is i+2+1\n        } else {\n          // Found an empty cell\n          nextRow = i + 2; // i is 0-indexed from row 2\n          break;\n        }\n      }\n\n      // Collect current form data\n      const companyVal = companyNameInput ? companyNameInput.value.trim() : '';\n      const descVal = getSelectedCategories().join(', ');\n      const isOther = isOtherTaskSelected();\n      const brokerVal = brokerLeadEl ? brokerLeadEl.value : '';\n      const assignees = getSelectedAssignees().join(', ');\n\n      // Write company name to column A\n      sheet.getRange(`A${nextRow}`).values = [[companyVal]];\n      // Write task category to column B\n      sheet.getRange(`B${nextRow}`).values = [[descVal]];\n      // Write assignees to column C\n      sheet.getRange(`C${nextRow}`).values = [[assignees]];\n      // Write broker lead to column D\n      sheet.getRange(`D${nextRow}`).values = [[brokerVal]];\n\n      // Write dates to columns E, F, G\n      const dateE = formatDateForExcel(initialRequestInput ? initialRequestInput.value : '');\n      const dateF = formatDateForExcel(introEmailInput ? introEmailInput.value : '');\n      const dateG = formatDateForExcel(remindersStartInput ? remindersStartInput.value : '');\n      sheet.getRange(`E${nextRow}:G${nextRow}`).values = [[dateE, dateF, dateG]];\n\n      // Write Email Frequency (J) and Extra Note (K)\n      sheet.getRange(`J${nextRow}`).values = [[emailFrequencyEl ? emailFrequencyEl.value : '']];\n      sheet.getRange(`K${nextRow}`).values = [[extraNoteEl ? extraNoteEl.value : '']];\n\n      // Helper to get today's date in d-MMM-yy format\n      const getTodayFormatted = () => {\n        const d = new Date();\n        const months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];\n        return `${String(d.getDate()).padStart(2,'0')} ${months[d.getMonth()]} ${String(d.getFullYear()).slice(-2)}`;\n      };\n      const today = getTodayFormatted();\n\n      // Build Column H from selected tasks\n      const newTaskLines = [];\n      if (isOther) {\n        const otherCard = getTaskCard('__other__');\n        const name = taskNameInput ? taskNameInput.value.trim() : '';\n        if (name) {\n          const status = getCardStatus(otherCard) || 'To Do';\n          const commentEl = otherCard ? otherCard.querySelector('[data-role=\"comment\"]') : null;\n          const deadlineEl = otherCard ? otherCard.querySelector('[data-role=\"deadline\"]') : null;\n          const taskAssigneeEl = otherCard ? otherCard.querySelector('[data-role=\"task-assignee\"]') : null;\n          const taskAssignee = taskAssigneeEl && taskAssigneeEl.value ? taskAssigneeEl.value : assignees;\n          \n          // Set date based on status for new task\n          let initiated = '', updated = '', completed = '';\n          const statusLower = status.toLowerCase();\n          if (statusLower === 'to do') {\n            initiated = today;\n          } else if (statusLower === 'in progress') {\n            updated = today;\n          } else if (statusLower === 'done') {\n            completed = today;\n          }\n          \n          const payload = {\n            name,\n            status,\n            assignees: taskAssignee,\n            comment: commentEl ? commentEl.value.trim() : '',\n            giveUpId: '',\n            initiated,\n            updated,\n            completed,\n            deadline: deadlineEl ? deadlineEl.value : ''\n          };\n          newTaskLines.push(buildSummaryLine(payload));\n        }\n      } else {\n        const toggles = getSelectedTaskToggles();\n        const fixedNames = ['Broker Agreement','Give-up Agreement','Amend Annex A','KYC (produced by LCMC)','KYC External'];\n        toggles.forEach(name => {\n          if (!fixedNames.includes(name)) return;\n          const card = getTaskCard(name);\n          if (!card) return;\n          const status = getCardStatus(card) || 'To Do';\n          const commentEl = card.querySelector('[data-role=\"comment\"]');\n          const deadlineEl = card.querySelector('[data-role=\"deadline\"]');\n          const giveUpIdEl = card.querySelector('[data-role=\"giveUpId\"]');\n          const taskAssigneeEl = card.querySelector('[data-role=\"task-assignee\"]');\n          const taskAssignee = taskAssigneeEl && taskAssigneeEl.value ? taskAssigneeEl.value : assignees;\n          \n          // Set date based on status for new task\n          let initiated = '', updated = '', completed = '';\n          const statusLower = status.toLowerCase();\n          if (statusLower === 'to do') {\n            initiated = today;\n          } else if (statusLower === 'in progress') {\n            updated = today;\n          } else if (statusLower === 'done') {\n            completed = today;\n          }\n          \n          const payload = {\n            name,\n            status,\n            assignees: taskAssignee,\n            comment: commentEl ? commentEl.value.trim() : '',\n            giveUpId: giveUpIdEl ? giveUpIdEl.value.trim() : '',\n            initiated,\n            updated,\n            completed,\n            deadline: deadlineEl ? deadlineEl.value : ''\n          };\n          newTaskLines.push(buildSummaryLine(payload));\n        });\n      }\n\n      const hRangeNew = sheet.getRange(`H${nextRow}`);\n      hRangeNew.values = [[newTaskLines.join('\\n')]];\n\n      // Apply font color based on status priority: In Progress > To Do > Done\n      // Use original Google Sheet colours: To Do #34a853, In Progress #ff9900, Done #cc6666\n      if (newTaskLines.length > 0) {\n        let hasInProgress = false;\n        let hasToDo = false;\n        let hasDone = false;\n        \n        newTaskLines.forEach(line => {\n          const lower = line.toLowerCase();\n          if (lower.includes(': in progress')) hasInProgress = true;\n          else if (lower.includes(': to do')) hasToDo = true;\n          else if (lower.includes(': done')) hasDone = true;\n        });\n        \n        let fontColor;\n        if (hasInProgress) {\n          fontColor = '#ff9900'; // In Progress (orange)\n        } else if (hasToDo) {\n          fontColor = '#34a853'; // To Do (green)\n        } else if (hasDone) {\n          fontColor = '#cc6666'; // Done (soft red)\n        } else {\n          fontColor = '#34a853'; // default green\n        }\n        hRangeNew.format.font.color = fontColor;\n      }\n\n      await context.sync();\n\n      // Select the new row so user can see it\n      const newRowRange = sheet.getRange(`A${nextRow}`);\n      newRowRange.select();\n      await context.sync();\n\n      // Update current row number for save logic\n      currentRowNum = nextRow;\n    });\n  }\n\n  // Update date display helpers to show d-MMM-yyyy format\n  function updateDateDisplays() {\n    const dateFields = [\n      { input: '#initialRequest', display: '#initialRequestDisplay' },\n      { input: '#introEmail', display: '#introEmailDisplay' },\n      { input: '#remindersStart', display: '#remindersStartDisplay' }\n    ];\n    dateFields.forEach(({ input, display }) => {\n      const inputEl = qs(input);\n      const displayEl = qs(display);\n      if (inputEl && displayEl) {\n        const formatted = formatDateForDisplay(inputEl.value);\n        displayEl.textContent = formatted ? ` ${formatted}` : '';\n      }\n    });\n  }\n\n  // Wire date inputs to update displays\n  function wireDateInputs() {\n    const dateInputs = ['#initialRequest', '#introEmail', '#remindersStart'];\n    dateInputs.forEach(selector => {\n      const el = qs(selector);\n      if (el) {\n        el.addEventListener('change', updateDateDisplays);\n      }\n    });\n  }\n\n  // Wire deadline inputs to update warnings\n  function wireDeadlineInputs() {\n    qsa('[data-role=\"deadline\"]').forEach(input => {\n      input.addEventListener('change', () => {\n        applyDeadlineWarnings();\n      });\n    });\n  }\n\n  // ============== Email Summary Integration ==============\n\n  const emailSummaryBtn = qs('#viewEmailSummaryBtn');\n  const emailSummarySection = qs('#emailSummarySection');\n  const emailSummaryList = qs('#emailSummaryList');\n  const emailSummaryCount = qs('#emailSummaryCount');\n  const closeEmailSummaryBtn = qs('#closeEmailSummaryBtn');\n\n  // Update email summary button state based on company name\n  function updateEmailSummaryButton() {\n    const company = companyNameInput ? companyNameInput.value.trim() : '';\n    if (emailSummaryBtn) {\n      emailSummaryBtn.disabled = !company;\n    }\n  }\n\n  // Wire company name input to update button state\n  if (companyNameInput) {\n    companyNameInput.addEventListener('input', updateEmailSummaryButton);\n    companyNameInput.addEventListener('change', updateEmailSummaryButton);\n  }\n\n  // Wire email summary button click\n  if (emailSummaryBtn) {\n    emailSummaryBtn.addEventListener('click', async () => {\n      await loadEmailSummaries();\n    });\n  }\n\n  // Wire close button\n  if (closeEmailSummaryBtn) {\n    closeEmailSummaryBtn.addEventListener('click', () => {\n      if (emailSummarySection) {\n        emailSummarySection.classList.remove('visible');\n      }\n    });\n  }\n\n  // Load email summaries from the API\n  async function loadEmailSummaries() {\n    const company = companyNameInput ? companyNameInput.value.trim() : '';\n    if (!company) {\n      showToast('No company name entered', 'error');\n      return;\n    }\n\n    // Show the section with loading state\n    if (emailSummarySection) {\n      emailSummarySection.classList.add('visible');\n    }\n    if (emailSummaryList) {\n      emailSummaryList.innerHTML = '<div class=\"email-loading\">Loading summaries...</div>';\n    }\n\n    try {\n      // Get task dates from form inputs for smart matching\n      const initialRequest = initialRequestInput ? initialRequestInput.value : '';\n      const introEmail = introEmailInput ? introEmailInput.value : '';\n      const remindersStart = remindersStartInput ? remindersStartInput.value : '';\n\n      // Use POST with dates for combined company + date matching\n      const response = await fetch(\n        `${EMAIL_SUMMARIZER_API_URL}/api/task-manager/summaries/${encodeURIComponent(company)}`,\n        {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({\n            initial_request: initialRequest,\n            intro_email: introEmail,\n            reminders_start: remindersStart,\n            threshold: SMARTBRIEF_MATCH_THRESHOLD\n          })\n        }\n      );\n\n      if (!response.ok) {\n        throw new Error(`Server returned ${response.status}`);\n      }\n\n      const data = await response.json();\n      const summaries = data.summaries || [];\n\n      // Update count badge\n      if (emailSummaryCount) {\n        emailSummaryCount.textContent = summaries.length;\n      }\n\n      // Render summaries - seamless display, no confirmation needed\n      if (summaries.length === 0) {\n        emailSummaryList.innerHTML = '<div class=\"email-no-summaries\">No email summaries found for this company and timeframe.</div>';\n        return;\n      }\n\n      emailSummaryList.innerHTML = summaries.map(s => {\n        // Calculate match quality indicator\n        const matchPercent = Math.round((s.match_score || 1) * 100);\n        const companyPercent = Math.round((s.company_score || 1) * 100);\n        const datePercent = Math.round((s.date_score || 0.5) * 100);\n\n        // Color code by match quality\n        let matchClass = 'match-high';\n        if (matchPercent < 70) matchClass = 'match-medium';\n        if (matchPercent < 50) matchClass = 'match-low';\n\n        return `\n          <div class=\"email-summary-item\" data-id=\"${s.id}\">\n            <div class=\"email-summary-subject\">\n              ${escapeHtml(s.subject || 'No subject')}\n              <span class=\"match-score ${matchClass}\" title=\"Company: ${companyPercent}% | Date: ${datePercent}%\">\n                ${matchPercent}% match\n              </span>\n            </div>\n            <div class=\"email-summary-meta\">\n              From: ${escapeHtml(s.from || 'Unknown')} | ${formatEmailDate(s.date)}\n            </div>\n            <div class=\"email-summary-text\">${escapeHtml(s.summary || 'No summary available')}</div>\n          </div>\n        `;\n      }).join('');\n\n    } catch (err) {\n      console.error('Error loading email summaries:', err);\n      if (emailSummaryList) {\n        emailSummaryList.innerHTML = `<div class=\"email-no-summaries\">Error loading summaries: ${escapeHtml(err.message)}<br><small>Make sure the Email Summarizer service is running.</small></div>`;\n      }\n    }\n  }\n\n  // Format date for display\n  function formatEmailDate(dateStr) {\n    if (!dateStr) return 'Unknown date';\n    try {\n      const d = new Date(dateStr);\n      if (isNaN(d.getTime())) return dateStr;\n      return d.toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' });\n    } catch (e) {\n      return dateStr;\n    }\n  }\n\n  // Confirm a draft summary and link it to the current task\n  window.confirmEmailSummary = async function(summaryId) {\n    if (currentRowNum === null || currentRowNum === 'new') {\n      showToast('Please save the task first', 'error');\n      return;\n    }\n\n    try {\n      // Call the API to confirm the summary\n      const response = await fetch(`${EMAIL_SUMMARIZER_API_URL}/api/task-manager/confirm/${summaryId}`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ task_row: currentRowNum })\n      });\n\n      if (!response.ok) {\n        throw new Error(`Server returned ${response.status}`);\n      }\n\n      // Write summary reference to column L in Excel\n      await Excel.run(async (context) => {\n        const sheet = context.workbook.worksheets.getItemOrNullObject('TASK MANAGER FORM');\n        sheet.load('name');\n        await context.sync();\n\n        if (sheet.isNullObject) {\n          throw new Error('Sheet not found');\n        }\n\n        const cell = sheet.getRange(`L${currentRowNum}`);\n        cell.load('values');\n        await context.sync();\n\n        // Append or create new reference\n        const existing = (cell.values && cell.values[0] && cell.values[0][0])\n          ? String(cell.values[0][0])\n          : '';\n        const newRef = `[Email Summary #${summaryId}]`;\n        cell.values = [[existing ? `${existing} ${newRef}` : newRef]];\n        await context.sync();\n      });\n\n      showToast('Summary confirmed and linked!', 'success');\n\n      // Reload summaries to reflect the change\n      await loadEmailSummaries();\n\n    } catch (err) {\n      console.error('Error confirming summary:', err);\n      showToast('Error confirming summary: ' + err.message, 'error');\n    }\n  };\n\n  // Initial load when Office host is ready\n  if (typeof Office !== 'undefined' && typeof Office.onReady === 'function') {\n  \n      Office.onReady((info) => {\n        if (info.host === Office.HostType.Excel) {\n          wireCardChips();\n          wireDateInputs();\n          wireDeadlineInputs(); // Wire deadline warnings\n          wireChangeTracking(); // Track unsaved changes\n        // Wire task checkbox visibility\n        qsa('#tasksChecklist .task-toggle').forEach(cb => {\n          cb.addEventListener('change', () => syncTasksVisibility());\n        });\n        // Wire category checkbox visibility\n        qsa('#taskCategories .category-toggle').forEach(cb => {\n          cb.addEventListener('change', () => syncTasksVisibility());\n        });\n        loadFromActiveRow().then(() => {\n          // Reset unsaved indicator after initial load\n          setUnsavedChanges(false);\n          // Auto-load active tasks on startup\n          performSearch();\n        });\n      }\n    });\n  }\n})();\n"],"names":["e","t","r","Symbol","n","iterator","o","toStringTag","i","c","prototype","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","length","l","TypeError","call","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","m","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","qs","s","document","querySelector","qsa","Array","from","querySelectorAll","teamMembersLoaded","hasUnsavedChanges","EMAIL_SUMMARIZER_API_URL","showToast","message","type","undefined","toast","textContent","className","setTimeout","classList","remove","checkMissingFields","missing","companyName","trim","push","brokerLead","filter","card","style","display","id","forEach","taskName","dataset","task","activeChip","deadlineInput","concat","otherTaskCard","taskNameInput","showMissingFieldsWarning","missingFields","overlay","createElement","box","maxWidth","textAlign","title","innerHTML","marginBottom","appendChild","desc","fontSize","color","list","cssText","field","li","btnWrap","closeBtn","addEventListener","body","setUnsavedChanges","unsaved","indicator","toggle","escapeHtml","text","div","String","applyDeadlineWarnings","warningClass","deadlineStr","deadline","Date","isNaN","getTime","today","setHours","diffDays","Math","ceil","getDueDateWarningClass","add","window","preventDefault","returnValue","companyNameInput","brokerLeadEl","initialRequestInput","introEmailInput","remindersStartInput","emailFrequencyEl","extraNoteEl","auditTextEl","tasksRowEl","taskCardsContainer","saveBtn","newTaskBtn","loadSelectedBtn","openKycPortalBtn","currentRowNum","showConfirmDialog","dialog","msgEl","cancelBtn","okBtn","cleanup","removeEventListener","onCancel","onOk","_callee","_t","_context","addNewTask","saveToActiveRow","console","error","_callee2","_t2","_context2","loadFromActiveRow","clearFormForNewTask","deleteTaskBtn","_callee3","_t3","_context3","deleteCurrentRow","kycListenerAttached","stopPropagation","kycOpening","open","tasksView","statsView","tasksHeader","statsHeader","openStatsBtn","returnToTasksBtn","refreshStatsBtn","loadStatistics","_loadStatistics","_callee11","_t5","_context12","Excel","run","_ref11","_callee10","context","sheet","dataRange","rows","todoCount","inProgressCount","doneCount","brokerStats","monthlyStats","kycMonthly","totalDuration","durationCount","overdueItems","upcomingItems","staleItems","sevenDaysFromNow","thirtyDaysAgo","_loop","activeTasks","totalStatus","renderAttentionGroup","monthlyChart","sortedMonths","maxTasks","maxKyc","maxVal","monthNames","brokerChart","sortedBrokers","_maxTasks","_context11","workbook","worksheets","getItemOrNullObject","load","sync","isNullObject","getRange","values","setDate","getDate","row","company","broker","initialRequest","introEmail","remindersStart","taskSummary","taskDate","dateE","dateF","dateG","availableDates","monthKey","_context10","parseDate","reduce","min","getFullYear","getMonth","padStart","total","active","completed","split","Boolean","line","lower","toLowerCase","includes","completedMatch","match","kycDate","taskNameMatch","assigneeMatch","assignee","deadlineMatch","daysUntil","detail","abs","initiatedMatch","updatedMatch","lastActionDate","daysSince","initiated","days","_regeneratorValues","round","width","items","groupId","listId","countId","group","container","countEl","slice","map","item","assigneePart","join","sort","b","parseInt","keys","reverse","max","_toConsumableArray","month","_month$split2","_slicedToArray","shortMonth","tasks","kyc","kycHeight","entries","_ref12","name","_ref14","_ref16","_ref17","stats","activeWidth","completedWidth","_x6","dateVal","excelEpoch","UTC","utcDate","result","getUTCFullYear","getUTCMonth","getUTCDate","dateStr","isoMatch","year","day","jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec","searchInput","searchInputWrap","searchBtn","searchResults","searchHint","searchTabs","currentSearchMode","loadRowHint","updateSearchUI","placeholder","tab","_callee4","_context4","getAttribute","performSearch","_callee5","_context5","_ref6","_callee6","_context6","key","hideAutocomplete","_x","autocompleteDropdown","companyList","autocompleteTimeout","loadCompanyList","_loadCompanyList","_callee13","_t6","_context14","_ref18","_callee12","category","_context13","rowNum","log","_x7","showAutocomplete","query","q","allMatches","startsWithMatches","startsWith","containsMatches","sortedMatches","categoryHint","_callee7","_context7","selectAndLoadRow","_performSearch","_callee16","_t7","_context18","_ref19","_callee15","rawValues","results","scannedRows","_loop2","totalRows","modeLabel","rawQuery","_context17","isArray","taskCategory","hasActiveTasks","dominantStatus","hasTodo","hasProgress","hasDone","todoDates","progressDates","doneDates","mostRecentDate","statusDateLabel","statusDateRaw","statusDateDisplay","_context16","dateArr","best","dStr","yyyy","mm","dd","every","parsed","parseTaskLine","st","status","updated","formatDateForDisplay","statusBadge","datePart","_callee14","_context15","_x8","_x2","_selectAndLoadRow","_callee18","_context20","_ref21","_callee17","_context19","select","_x9","findLastKycDate","_x3","_findLastKycDate","_callee20","_context22","_ref22","_callee19","usedRange","lastKycDate","rowCompany","_context21","getUsedRange","_x0","ymdMatch","clearTimeout","val","target","_callee8","_context8","formatDateForExcel","getSelectedCategories","cb","isOtherTaskSelected","checked","getTaskCard","getTaskStatusChips","setCardStatus","getCardStatus","find","contains","syncTasksVisibility","isOther","otherCard","hasNonOtherCategory","some","selected","Set","getSelectedTaskToggles","has","updateExtraNotePlaceholder","categories","reorderCheckboxesToTop","containerSelector","children","unchecked","loadTeamMembers","_loadTeamMembers","_callee22","_context24","initialized","_ref23","_callee21","namesRaw","names","noneOpt","_context23","opt","_x1","getSelectedAssignees","updateTaskAssigneeDropdowns","selectedAssignees","dropdown","currentValue","emptyOpt","raw","basicMatch","exec","comment","giveUpId","commentMatch","giveUpMatch","buildSummaryLine","parts","assignees","_loadFromActiveRow","_callee26","_context28","_ref25","_callee25","selectedRange","uiRow","companyRange","descRange","assigneesRange","brokerRange","datesRange","hRange","jRange","kRange","companyVal","descVal","brokerVal","assigneesVal","assigneesList","datesRow","toInputDate","freqVal","noteVal","summary","lines","parsedTasks","nonTaskLines","cand","statusPriority","sNorm","commentEl","deadlineEl","taskAssigneeEl","chosenAudit","lastKycEl","kycCompletedDate","_context27","dmmyMatch","mon","getSelectedRange","rowIndex","cat","giveUpIdEl","pt","ptName","cbName","date","updateDateDisplays","updateEmailSummaryButton","emailSummarySection","_x11","_saveToActiveRow","_callee28","_context30","_ref26","_callee27","existing","newTaskLines","existingTasks","getTodayFormatted","computeDates","taskAssignee","existingTask","dates","payload","builtLine","toggles","fixedNames","sortedLines","newValue","hasInProgress","hasToDo","fontColor","_context29","newStatus","oldStatus","newStatusLower","hasAnyDate","format","font","_x12","visibleCard","focus","_deleteCurrentRow","_callee30","_context32","Error","_ref27","_callee29","_context31","delete","DeleteShiftDirection","up","_x13","_addNewTask","_callee32","_context34","_ref28","_callee31","colA","nextRow","statusLower","hRangeNew","_context33","_x14","input","_ref9","inputEl","displayEl","formatted","emailSummaryBtn","emailSummaryList","emailSummaryCount","closeEmailSummaryBtn","disabled","loadEmailSummaries","_loadEmailSummaries","_callee33","response","data","summaries","_t8","_context35","fetch","encodeURIComponent","method","headers","JSON","stringify","initial_request","intro_email","reminders_start","threshold","ok","json","matchPercent","match_score","companyPercent","company_score","datePercent","date_score","matchClass","subject","formatEmailDate","toLocaleDateString","_callee9","_context9","confirmEmailSummary","_ref1","_callee1","summaryId","_t4","_context1","task_row","_ref10","_callee0","cell","newRef","_context0","_x5","_x4","Office","onReady","info","host","HostType","chip","closest","selector","el"],"ignoreList":[],"sourceRoot":""}