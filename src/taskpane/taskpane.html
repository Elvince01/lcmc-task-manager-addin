<!doctype html><html><head><meta charset="utf-8"/><title>LCMC Task Manager</title><meta name="viewport" content="width=device-width,initial-scale=1"/><script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script><style>:root{--primary:#1e40af;--primary-hover:#1e3a8a;--primary-light:#3b82f6;--success:#10b981;--success-dark:#059669;--warning:#f59e0b;--danger:#ef4444;--gray-50:#f8fafc;--gray-100:#f1f5f9;--gray-200:#e2e8f0;--gray-300:#cbd5e1;--gray-400:#94a3b8;--gray-500:#64748b;--gray-600:#475569;--gray-700:#334155;--gray-800:#1e293b;--gray-900:#0f172a;--radius:10px;--radius-lg:14px;--shadow-sm:0 1px 2px rgba(0,0,0,0.04);--shadow:0 4px 6px -1px rgba(0,0,0,0.07),0 2px 4px -1px rgba(0,0,0,0.04);--shadow-md:0 10px 15px -3px rgba(0,0,0,0.08),0 4px 6px -2px rgba(0,0,0,0.04);--shadow-lg:0 20px 25px -5px rgba(0,0,0,0.1),0 10px 10px -5px rgba(0,0,0,0.04);--shadow-glow:0 0 20px rgba(59,130,246,0.15);--transition-fast:150ms cubic-bezier(0.4,0,0.2,1);--transition:200ms cubic-bezier(0.4,0,0.2,1);--transition-slow:300ms cubic-bezier(0.4,0,0.2,1)}*{box-sizing:border-box}body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,sans-serif;font-size:13px;margin:0;padding:16px;background:linear-gradient(180deg,#f8fafc 0,#f1f5f9 50%,#e2e8f0 100%);background-attachment:fixed;color:var(--gray-900);line-height:1.5;min-height:100vh}.header{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px;padding-bottom:10px}.btn-stats{padding:6px 12px;font-size:12px;font-weight:500;border:1px solid var(--primary);border-radius:6px;background:0 0;color:var(--primary);cursor:pointer;transition:all .2s ease}.btn-stats:hover{background:var(--primary);color:#fff}.btn-return{padding:8px 14px;font-size:13px;font-weight:500;border:none;border-radius:6px;background:var(--gray-100);color:var(--gray-700);cursor:pointer;transition:all .2s ease}.btn-return:hover{background:var(--gray-200);color:var(--gray-900)}.stats-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}.stats-header h2{font-size:16px;font-weight:700;color:var(--gray-900);margin:0}.stats-cards{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:16px}.stat-card{background:linear-gradient(135deg,#1e40af 0,#3b82f6 100%);border-radius:14px;padding:18px 16px;text-align:center;color:#fff;box-shadow:0 8px 24px rgba(30,64,175,.35),inset 0 1px 0 rgba(255,255,255,.15);position:relative;overflow:hidden;transition:all .3s ease}.stat-card::before{content:'';position:absolute;top:-50%;right:-50%;width:100%;height:100%;background:radial-gradient(circle,rgba(255,255,255,.12) 0,transparent 60%);pointer-events:none}.stat-card:hover{transform:translateY(-2px);box-shadow:0 12px 32px rgba(30,64,175,.45)}.stat-value{font-size:32px;font-weight:700;line-height:1.2;text-shadow:0 2px 4px rgba(0,0,0,.15)}.stat-label{font-size:10px;opacity:.85;margin-top:6px;text-transform:uppercase;letter-spacing:.8px;font-weight:500}.stats-section{background:#fff;border-radius:10px;padding:14px;margin-bottom:12px;box-shadow:var(--shadow-sm);border:1px solid var(--gray-200)}.stats-section-title{font-size:13px;font-weight:600;color:var(--gray-800);margin-bottom:12px}.stats-table-wrap{overflow-x:auto}.stats-table{width:100%;border-collapse:collapse;font-size:12px}.stats-table th{text-align:left;padding:8px 6px;border-bottom:2px solid var(--gray-200);font-weight:600;color:var(--gray-600);font-size:10px;text-transform:uppercase}.stats-table td{padding:8px 6px;border-bottom:1px solid var(--gray-100);color:var(--gray-800)}.stats-table tr:last-child td{border-bottom:none}.stats-table tr:hover td{background:var(--gray-50)}.status-bar-row{display:flex;align-items:center;gap:10px;margin-bottom:10px}.status-bar-row:last-child{margin-bottom:0}.status-label{width:80px;font-size:12px;color:var(--gray-700)}.status-bar-track{flex:1;height:20px;background:var(--gray-100);border-radius:10px;overflow:hidden}.status-bar-fill{height:100%;border-radius:10px;transition:width .5s ease}.status-bar-fill.todo{background:linear-gradient(90deg,#34d399,#10b981)}.status-bar-fill.inprogress{background:linear-gradient(90deg,#fbbf24,#f59e0b)}.status-bar-fill.done{background:linear-gradient(90deg,#f87171,#ef4444)}.status-count{width:35px;text-align:right;font-size:12px;font-weight:600;color:var(--gray-700)}.deadline-stats{display:flex;gap:12px}.deadline-stat{flex:1;text-align:center;padding:12px;border-radius:8px;background:var(--gray-50)}.deadline-value{font-size:24px;font-weight:700}.deadline-value.warning{color:#f59e0b}.deadline-value.danger{color:#ef4444}.deadline-label{font-size:11px;color:var(--gray-600);margin-top:4px}.attention-stats{display:flex;flex-direction:column;gap:8px}.attention-group{border-radius:8px;overflow:hidden;border:1px solid var(--gray-200);display:none}.attention-group.has-items{display:block}.attention-group.danger{border-left:3px solid #ef4444}.attention-group.warning{border-left:3px solid #f59e0b}.attention-group.stale{border-left:3px solid #eab308}.attention-group.danger .attention-header{background:#fef2f2}.attention-group.warning .attention-header{background:#fffbeb}.attention-group.stale .attention-header{background:#fefce8}.attention-header{display:flex;align-items:center;gap:8px;padding:8px 10px;cursor:pointer}.attention-badge{font-size:13px;font-weight:600}.attention-badge span{font-weight:700}.attention-title{font-size:12px;color:var(--gray-600)}.attention-list{background:#fff;max-height:120px;overflow-y:auto}.attention-list:empty{display:none}.attention-item{display:flex;align-items:center;gap:6px;padding:5px 10px;font-size:11px;border-top:1px solid var(--gray-100)}.attention-item:first-child{border-top:none}.attention-item .task-info{flex:1;color:var(--gray-700);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.attention-item .task-info .to-assignee{color:var(--gray-500)}.attention-item .task-detail{color:var(--gray-400);font-size:10px;white-space:nowrap;flex-shrink:0}.chart-legend{display:flex;gap:16px;margin-bottom:10px;font-size:11px;color:var(--gray-600)}.stats-caption{margin-top:6px;font-size:10px;color:var(--gray-500)}.legend-item{display:flex;align-items:center;gap:4px}.legend-dot{width:10px;height:10px;border-radius:2px}.legend-dot.tasks{background:linear-gradient(135deg,#3b82f6,#60a5fa)}.legend-dot.kyc{background:linear-gradient(135deg,#10b981,#059669)}.legend-dot.active{background:linear-gradient(135deg,#f59e0b,#d97706)}.legend-dot.completed{background:linear-gradient(135deg,#10b981,#059669)}.monthly-chart{display:flex;align-items:flex-end;gap:8px;height:120px;padding-top:10px}.month-bar-group{flex:1;display:flex;flex-direction:column;align-items:center;gap:4px}.month-bars{display:flex;gap:3px;align-items:flex-end;height:90px}.month-bar{width:14px;border-radius:3px 3px 0 0;transition:height .5s ease;position:relative}.month-bar.tasks{background:linear-gradient(180deg,#3b82f6,#60a5fa)}.month-bar.kyc{background:linear-gradient(180deg,#10b981,#059669)}.month-bar-label{font-size:9px;color:var(--gray-500);text-align:center}.month-bar-value{position:absolute;top:-16px;left:50%;transform:translateX(-50%);font-size:9px;font-weight:600;color:var(--gray-700)}.broker-chart{display:flex;flex-direction:column;gap:8px}.broker-row{display:flex;align-items:center;gap:10px}.broker-name{width:80px;font-size:12px;color:var(--gray-700);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.broker-bar-track{flex:1;height:20px;background:var(--gray-100);border-radius:10px;overflow:hidden;display:flex}.broker-bar-fill{height:100%;transition:width .5s ease}.broker-bar-fill.active{background:linear-gradient(90deg,#f59e0b,#d97706)}.broker-bar-fill.completed{background:linear-gradient(90deg,#10b981,#059669)}.broker-bar-fill .bar-num{display:flex;align-items:center;justify-content:center;height:100%;font-size:10px;font-weight:600;color:#fff;padding:0 4px;min-width:16px}.task-assignee-select{flex:1;padding:6px 10px;font-size:12px;border:1px solid var(--gray-300);border-radius:6px;background:#fff;color:var(--gray-700);cursor:pointer}.task-assignee-select:focus{outline:0;border-color:var(--primary);box-shadow:0 0 0 2px rgba(30,64,175,.1)}.btn-new-task{display:inline-flex;align-items:center;gap:6px;padding:10px 20px;font-size:13px;font-weight:600;border-radius:10px;border:none;background:linear-gradient(135deg,#10b981 0,#059669 100%);color:#fff;cursor:pointer;box-shadow:0 3px 10px rgba(16,185,129,.35),inset 0 1px 0 rgba(255,255,255,.2);transition:all .2s ease}.btn-new-task:hover{transform:translateY(-1px);box-shadow:0 5px 15px rgba(16,185,129,.45),inset 0 1px 0 rgba(255,255,255,.2)}.btn-new-task:active{transform:translateY(0)}.btn-new-task .plus-icon{font-size:16px;font-weight:700}.section{background:rgba(255,255,255,.85);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);border-radius:var(--radius-lg);padding:16px;margin-bottom:14px;box-shadow:0 4px 20px rgba(0,0,0,.06),0 1px 3px rgba(0,0,0,.04);border:1px solid rgba(255,255,255,.8);transition:all .25s cubic-bezier(.4,0,.2,1)}.section:hover{box-shadow:0 8px 30px rgba(0,0,0,.08),0 2px 6px rgba(0,0,0,.04);transform:translateY(-1px)}.section-title{font-size:11px;font-weight:600;text-transform:uppercase;letter-spacing:.5px;color:var(--gray-500);margin-bottom:10px}.row{margin-bottom:12px}.row:last-child{margin-bottom:0}label{display:block;margin-bottom:4px;font-weight:500;font-size:12px;color:var(--gray-700)}input[type=date],input[type=text],select,textarea{width:100%;padding:8px 10px;border:1px solid var(--gray-300);border-radius:6px;font-size:13px;background:#fff;transition:border-color .15s,box-shadow .15s}input[type=date]:focus,input[type=text]:focus,select:focus,textarea:focus{outline:0;border-color:var(--primary);box-shadow:0 0 0 3px rgba(30,64,175,.1)}textarea{resize:vertical;min-height:48px}#companyName{padding:12px 14px;font-size:15px;font-weight:500;border-width:2px}#companyName:focus{border-color:var(--primary);box-shadow:0 0 0 4px rgba(30,64,175,.12)}.chips{display:flex;gap:8px;margin:8px 0;flex-wrap:wrap}.chip{padding:6px 14px;border-radius:999px;cursor:pointer;border:1px solid var(--gray-200);background:var(--gray-50);color:var(--gray-600);font-size:12px;font-weight:500;transition:all .2s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden}.chip::before{content:'';position:absolute;inset:0;background:linear-gradient(135deg,rgba(255,255,255,.3) 0,transparent 100%);opacity:0;transition:opacity .2s}.chip:hover{background:var(--gray-100);transform:translateY(-1px);box-shadow:0 2px 8px rgba(0,0,0,.08)}.chip:hover::before{opacity:1}.chip.active{color:#fff;border-color:transparent;box-shadow:0 3px 10px rgba(0,0,0,.2)}.chip.active::before{opacity:1}.chip[data-value="To Do"].active{background:linear-gradient(135deg,#10b981 0,#059669 100%);box-shadow:0 3px 10px rgba(16,185,129,.4)}.chip[data-value="In Progress"].active{background:linear-gradient(135deg,#f59e0b 0,#d97706 100%);box-shadow:0 3px 10px rgba(245,158,11,.4)}.chip[data-value=Done].active{background:linear-gradient(135deg,#ef4444 0,#dc2626 100%);box-shadow:0 3px 10px rgba(239,68,68,.4)}.actions{display:flex;gap:8px;flex-wrap:wrap;margin-top:16px}.btn{background:var(--primary);color:#fff;border:none;padding:10px 16px;cursor:pointer;border-radius:6px;font-size:13px;font-weight:500;transition:background .15s;display:inline-flex;align-items:center;gap:6px}.btn:hover{background:var(--primary-hover)}.btn.secondary{background:var(--gray-500)}.btn.secondary:hover{background:var(--gray-700)}.btn.success{background:var(--success)}.btn.success:hover{background:#15803d}.btn-sm{padding:6px 10px;font-size:12px}.btn-link{background:0 0;color:var(--primary);padding:6px 10px;border:1px solid var(--primary)}.btn-link:hover{background:rgba(30,64,175,.05)}.toggle-list{max-height:78px;overflow-y:auto;border:1px solid var(--gray-200);border-radius:8px;padding:8px 10px;background:#fff}.toggle-list label{display:inline-flex;align-items:center;gap:8px;margin-right:12px;margin-bottom:4px;font-weight:400;cursor:pointer;font-size:12px;color:var(--gray-700);transition:color .15s}.toggle-list label:hover{color:var(--gray-900)}.toggle-list input[type=checkbox]{appearance:none;-webkit-appearance:none;width:18px;height:18px;border:2px solid var(--gray-300);border-radius:5px;background:#fff;cursor:pointer;position:relative;transition:all .2s ease;flex-shrink:0}.toggle-list input[type=checkbox]:hover{border-color:var(--primary)}.toggle-list input[type=checkbox]:checked{background:linear-gradient(135deg,#10b981 0,#059669 100%);border-color:#059669}.toggle-list input[type=checkbox]:checked::after{content:'';position:absolute;left:5px;top:2px;width:5px;height:9px;border:solid #fff;border-width:0 2px 2px 0;transform:rotate(45deg)}#assignees{max-height:78px}#tasksChecklist{max-height:70px}#taskCategories{max-height:78px;padding:2px 0}.task-card{background:linear-gradient(135deg,rgba(248,250,252,.9) 0,rgba(241,245,249,.95) 100%);border:1px solid var(--gray-200);border-radius:10px;padding:14px;margin-top:12px;box-shadow:0 2px 8px rgba(0,0,0,.04);transition:all .2s ease;position:relative}.task-card::before{content:'';position:absolute;left:0;top:0;bottom:0;width:3px;border-radius:10px 0 0 10px;background:linear-gradient(180deg,var(--primary) 0,#3b82f6 100%);opacity:.7}.task-card:hover{box-shadow:0 4px 16px rgba(0,0,0,.08);transform:translateY(-1px)}.task-card strong{font-size:13px;color:var(--primary);font-weight:600}.task-card .row{margin-bottom:10px}#auditInfo{font-size:11px;color:var(--gray-500);background:var(--gray-100);padding:8px 10px;border-radius:6px;margin-top:12px}#auditInfo label{font-size:11px;margin-bottom:2px}#lastKycDate{color:var(--primary);font-weight:600}.search-section{background:linear-gradient(135deg,#1e40af 0,#3b82f6 100%);border-radius:var(--radius-lg);padding:16px;margin-bottom:14px;box-shadow:0 8px 32px rgba(30,64,175,.35),0 2px 8px rgba(0,0,0,.1);position:relative;overflow:hidden}.search-section::before{content:'';position:absolute;top:-50%;right:-50%;width:100%;height:100%;background:radial-gradient(circle,rgba(255,255,255,.1) 0,transparent 60%);pointer-events:none}.search-section::after{content:'';position:absolute;bottom:0;left:0;right:0;height:1px;background:linear-gradient(90deg,transparent,rgba(255,255,255,.3),transparent)}.search-section .section-title{color:rgba(255,255,255,.9);margin-bottom:12px}.search-tabs{display:flex;gap:6px;margin-bottom:12px;background:rgba(0,0,0,.15);padding:4px;border-radius:10px}.search-tab{flex:1;padding:10px 12px;border:none;border-radius:8px;font-size:11px;font-weight:500;cursor:pointer;background:transparent;color:rgba(255,255,255,.8);transition:all .25s cubic-bezier(.4,0,.2,1);text-align:center;position:relative}.search-tab:hover{background:rgba(255,255,255,.15);color:#fff}.search-tab.active{background:#fff;color:var(--primary);font-weight:600;box-shadow:0 2px 8px rgba(0,0,0,.2)}.search-input-wrap{display:flex;gap:8px}.autocomplete-wrap{flex:1;position:relative}.search-input-wrap input{width:100%;padding:10px 12px;border:none;border-radius:6px;font-size:13px}.autocomplete-dropdown{position:absolute;top:100%;left:0;right:0;background:#fff;border-radius:0 0 6px 6px;box-shadow:0 4px 12px rgba(0,0,0,.15);max-height:200px;overflow-y:auto;z-index:100;display:none}.autocomplete-dropdown.visible{display:block}.autocomplete-item{padding:10px 12px;cursor:pointer;border-bottom:1px solid var(--gray-100);display:flex;justify-content:space-between;align-items:center;gap:8px}.autocomplete-item:last-child{border-bottom:none}.autocomplete-item:hover{background:var(--gray-50)}.autocomplete-item .company-name{font-size:13px;font-weight:500;color:var(--gray-900);flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.autocomplete-item .row-hint{font-size:10px;color:var(--gray-500);white-space:nowrap;text-align:right}.search-input-wrap button{padding:10px 16px;border:none;border-radius:6px;background:#fff;color:var(--primary);font-weight:600;cursor:pointer;transition:all .2s}.search-input-wrap button:hover{background:#f0f0f0}.search-results{background:#fff;border-radius:6px;margin-top:10px;max-height:200px;overflow-y:auto;display:none}.search-results.visible{display:block}.search-result-item{padding:10px 12px;border-bottom:1px solid var(--gray-200);cursor:pointer;transition:background .15s}.search-result-item:last-child{border-bottom:none}.search-result-item:hover{background:var(--gray-50)}.search-result-item .company{font-weight:600;color:var(--gray-900)}.search-result-item .meta{font-size:11px;color:var(--gray-500);margin-top:2px}.search-result-item .status-badge{display:inline-block;padding:2px 8px;border-radius:999px;font-size:10px;font-weight:600;margin-left:6px}.status-badge.todo{background:#e8f5e9;color:#2e7d32}.status-badge.progress{background:#fff3e0;color:#ef6c00}.status-badge.done{background:#ffebee;color:#d04949}.no-results{padding:12px;text-align:center;color:var(--gray-500);font-size:12px}.search-hint{font-size:11px;color:rgba(255,255,255,.6);margin-top:6px;font-style:italic}.btn-magic{background:linear-gradient(135deg,#667eea 0,#764ba2 50%,#f093fb 100%);background-size:200% 200%;animation:gradientShift 3s ease infinite;color:#fff;border:none;padding:8px 14px;border-radius:8px;font-size:12px;font-weight:600;cursor:pointer;position:relative;overflow:hidden;box-shadow:0 4px 15px rgba(102,126,234,.4);transition:all .3s ease}.btn-magic:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(102,126,234,.6)}.btn-magic::before{content:'';position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:linear-gradient(45deg,transparent,rgba(255,255,255,.3),transparent);transform:rotate(45deg);animation:shimmer 2s infinite}.btn-magic .sparkle{display:inline-block;margin-right:6px;animation:sparkle 1.5s ease-in-out infinite}@keyframes gradientShift{0%{background-position:0 50%}50%{background-position:100% 50%}100%{background-position:0 50%}}@keyframes shimmer{0%{transform:translateX(-100%) rotate(45deg)}100%{transform:translateX(100%) rotate(45deg)}}@keyframes sparkle{0%,100%{opacity:1;transform:scale(1)}50%{opacity:.6;transform:scale(1.2)}}.date-display{font-size:11px;color:var(--gray-500);margin-top:4px}.bottom-save-section{background:linear-gradient(135deg,#f8fafc 0,#f1f5f9 100%);border-radius:var(--radius);padding:12px 16px;margin-top:12px;box-shadow:0 -4px 20px rgba(0,0,0,.05);border:1px solid var(--gray-200);display:flex;align-items:center;justify-content:center;gap:14px;position:sticky;bottom:0}.btn-save-main{position:relative;padding:10px 28px;font-size:13px;font-weight:600;letter-spacing:.3px;border-radius:10px;border:none;background:linear-gradient(135deg,#10b981 0,#059669 50%,#047857 100%);background-size:200% 200%;color:#fff;cursor:pointer;box-shadow:0 3px 12px rgba(16,185,129,.4),0 1px 3px rgba(0,0,0,.1),inset 0 1px 0 rgba(255,255,255,.2);transition:all .3s cubic-bezier(.4, 0, .2, 1);overflow:hidden}.btn-save-main::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);transition:left .5s}.btn-save-main:hover{transform:translateY(-2px);box-shadow:0 8px 25px rgba(16,185,129,.5),0 4px 10px rgba(0,0,0,.1),inset 0 1px 0 rgba(255,255,255,.2);background-position:100% 100%}.btn-save-main:hover::before{left:100%}.btn-save-main:active{transform:translateY(0);box-shadow:0 2px 8px rgba(16,185,129,.4),inset 0 1px 0 rgba(255,255,255,.1)}.btn-save-main .save-icon{display:inline-flex;align-items:center;justify-content:center;margin-right:6px}.btn-save-main .save-icon svg{width:15px;height:15px;stroke:currentColor;stroke-width:2.5;fill:none}.load-row-hint{display:flex;align-items:center;gap:10px;margin-top:10px;padding:10px 12px;background:rgba(255,255,255,.15);border-radius:6px}.load-row-hint span{font-size:12px;color:rgba(255,255,255,.8)}.btn-load-selected{background:#fff;color:var(--primary);border:none;font-size:11px;padding:6px 12px;font-weight:600}.btn-load-selected:hover{background:#f0f0f0}.deadline-warning{background:#fef3c7;border:1px solid #f59e0b;color:#92400e}.deadline-overdue{background:#fee2e2;border:1px solid #ef4444;color:#991b1b}.deadline-badge{display:inline-block;padding:2px 6px;border-radius:4px;font-size:10px;font-weight:600;margin-left:8px}.deadline-badge.warning{background:#fef3c7;color:#92400e}.deadline-badge.overdue{background:#fee2e2;color:#991b1b}.toast{position:fixed;bottom:80px;right:16px;transform:translateX(120%);background:#1e40af;color:#fff;padding:12px 20px;border-radius:8px;font-size:13px;font-weight:500;box-shadow:0 4px 12px rgba(0,0,0,.2);opacity:0;transition:all .3s ease;z-index:1000;max-width:220px}.toast.show{transform:translateX(0);opacity:1}.toast.success{background:#15803d}.toast.error{background:#dc2626}.unsaved-indicator{display:none;align-items:center;gap:6px;font-size:12px;color:var(--warning);font-weight:500}.unsaved-indicator.visible{display:inline-flex}.unsaved-dot{width:8px;height:8px;background:var(--warning);border-radius:50%;animation:pulse 1.5s infinite}@keyframes pulse{0%,100%{opacity:1}50%{opacity:.4}}.delete-task-row{display:flex;justify-content:flex-end;padding:8px 0;margin-top:8px}.btn-delete-task{padding:4px 8px;font-size:10px;font-weight:400;border:none;border-radius:4px;background:0 0;color:var(--gray-400);cursor:pointer;transition:all .2s ease}.btn-delete-task:hover{color:#ef4444;background:#fef2f2}.confirm-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:2000}.confirm-box{background:#fff;border-radius:12px;padding:24px;max-width:280px;text-align:center;box-shadow:0 10px 40px rgba(0,0,0,.2)}.confirm-box p{margin:0 0 20px 0;font-size:14px;color:var(--gray-900)}.confirm-buttons{display:flex;gap:10px;justify-content:center}.btn-confirm-cancel{padding:8px 16px;font-size:13px;font-weight:500;border:1px solid var(--gray-300);border-radius:6px;background:#fff;color:var(--gray-700);cursor:pointer}.btn-confirm-cancel:hover{background:var(--gray-100)}.btn-confirm-ok{padding:8px 16px;font-size:13px;font-weight:500;border:none;border-radius:6px;background:#ef4444;color:#fff;cursor:pointer}.btn-confirm-ok:hover{background:#dc2626}.btn-email-summary{width:100%;padding:10px 14px;font-size:12px;font-weight:600;border:none;border-radius:8px;background:linear-gradient(135deg,#1976d2 0,#00b8d4 100%);color:#fff;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:8px;transition:all .2s ease;box-shadow:0 2px 8px rgba(25,118,210,.3)}.btn-email-summary:hover:not(:disabled){transform:translateY(-1px);box-shadow:0 4px 12px rgba(25,118,210,.4)}.btn-email-summary:disabled{background:var(--gray-300);color:var(--gray-500);cursor:not-allowed;box-shadow:none}.btn-email-summary .email-icon{font-size:14px}.email-summary-section{display:none;background:#fff;border:1px solid var(--gray-200);border-radius:var(--radius);margin-bottom:12px;box-shadow:var(--shadow);overflow:hidden}.email-summary-section.visible{display:block}.email-summary-header{display:flex;justify-content:space-between;align-items:center;padding:12px 14px;background:linear-gradient(135deg,#1976d2 0,#00b8d4 100%);color:#fff}.email-summary-title{font-size:13px;font-weight:600}.summary-count-badge{display:inline-block;padding:2px 8px;border-radius:10px;background:rgba(255,255,255,.2);font-size:11px;margin-left:6px}.summary-close-btn{background:0 0;border:none;color:#fff;font-size:20px;cursor:pointer;padding:0 4px;line-height:1;opacity:.8}.summary-close-btn:hover{opacity:1}.email-summary-list{max-height:300px;overflow-y:auto;padding:10px}.email-loading{text-align:center;color:var(--gray-500);padding:20px;font-size:12px}.email-no-summaries{text-align:center;color:var(--gray-500);padding:20px;font-style:italic;font-size:12px}.email-summary-item{padding:12px;margin-bottom:8px;background:var(--gray-50);border:1px solid var(--gray-200);border-radius:8px;transition:all .2s ease}.email-summary-item:last-child{margin-bottom:0}.email-summary-item.draft{border-left:3px solid var(--gray-400);opacity:.85}.email-summary-item.confirmed{border-left:3px solid #22c55e}.email-summary-subject{font-weight:600;font-size:13px;color:var(--gray-900);margin-bottom:4px}.email-summary-meta{font-size:11px;color:var(--gray-500);margin-bottom:8px}.email-summary-text{font-size:12px;line-height:1.5;color:var(--gray-700)}.email-summary-actions{margin-top:10px;display:flex;gap:8px}.btn-confirm-summary{padding:6px 12px;font-size:11px;font-weight:600;border:none;border-radius:6px;background:#22c55e;color:#fff;cursor:pointer;transition:background .2s}.btn-confirm-summary:hover{background:#16a34a}.draft-badge{display:inline-block;padding:2px 6px;border-radius:4px;font-size:10px;font-weight:600;background:var(--gray-200);color:var(--gray-600);margin-left:6px}.match-score{display:inline-block;padding:2px 6px;border-radius:4px;font-size:9px;font-weight:500;margin-left:6px;cursor:help}.match-score.match-high{background:#dcfce7;color:#166534}.match-score.match-medium{background:#fef3c7;color:#92400e}.match-score.match-low{background:#fee2e2;color:#991b1b}.match-warning{background:#fef3c7;border:1px solid #f59e0b;border-radius:6px;padding:8px 12px;margin-bottom:10px;font-size:11px;color:#92400e;display:flex;align-items:center;gap:6px}.participants-section{margin:8px 0;padding:8px 0;border-top:1px solid var(--gray-200)}.participants-label{font-size:10px;font-weight:600;color:var(--gray-500);text-transform:uppercase;letter-spacing:0.5px;margin-bottom:6px}.participants-chips{display:flex;flex-wrap:wrap;gap:4px}.participant-chip{display:inline-block;padding:3px 8px;background:var(--gray-100);border:1px solid var(--gray-200);border-radius:12px;font-size:10px;color:var(--gray-700);cursor:default;transition:all 0.2s ease}.participant-chip.matched{background:#dbeafe;border-color:#3b82f6;color:#1e40af;font-weight:500}.participant-chip:hover{background:var(--gray-200)}.smartbrief-actions{margin-top:12px;padding-top:12px;border-top:1px solid var(--gray-200);display:flex;align-items:center;gap:10px;flex-wrap:wrap}.btn-apply-smartbrief{padding:8px 16px;font-size:12px;font-weight:600;border:none;border-radius:6px;background:linear-gradient(135deg,#8b5cf6 0%,#6366f1 100%);color:#fff;cursor:pointer;display:flex;align-items:center;gap:6px;transition:all 0.2s ease;box-shadow:0 2px 8px rgba(139,92,246,0.3)}.btn-apply-smartbrief:hover{transform:translateY(-1px);box-shadow:0 4px 12px rgba(139,92,246,0.4)}.apply-hint{font-size:10px;color:var(--gray-500);flex:1}.smartbrief-confirm-box{max-width:340px;text-align:left}.smartbrief-confirm-header{font-size:15px;font-weight:600;color:var(--gray-900);margin-bottom:12px;display:flex;align-items:center;gap:6px}.smartbrief-confirm-desc{font-size:12px;color:var(--gray-600);margin-bottom:14px}.smartbrief-suggestions{margin-bottom:16px}.smartbrief-suggestion-item{padding:10px 12px;background:var(--gray-50);border:1px solid var(--gray-200);border-radius:8px;margin-bottom:8px;transition:all 0.2s ease}.smartbrief-suggestion-item:hover{background:var(--gray-100)}.smartbrief-suggestion-item:last-child{margin-bottom:0}.smartbrief-suggestion-item label{display:flex;align-items:flex-start;gap:10px;cursor:pointer}.smartbrief-assignees-group{flex-direction:column}.smartbrief-assignees-group .suggestion-label{margin-bottom:8px;font-weight:500;color:var(--gray-700)}.assignee-checkboxes-list{display:flex;flex-direction:column;gap:6px;padding-left:4px}.assignee-checkbox-item{display:flex;align-items:center;gap:8px;padding:6px 10px;background:var(--gray-100);border-radius:6px;cursor:pointer;transition:all 0.15s ease}.assignee-checkbox-item:hover{background:var(--gray-200)}.assignee-checkbox-item input[type=checkbox]{width:16px;height:16px;cursor:pointer}.assignee-checkbox-item span{font-size:13px;color:var(--gray-800)}.smartbrief-suggestion-item input[type=checkbox]{margin-top:2px;width:16px;height:16px;accent-color:var(--primary)}.suggestion-label{font-size:11px;font-weight:600;color:var(--gray-500);text-transform:uppercase;letter-spacing:0.3px;min-width:80px}.suggestion-value{font-size:12px;color:var(--gray-800);font-weight:500;flex:1}.suggestion-notes{font-size:11px;color:var(--gray-600);font-weight:400;line-height:1.4}.smartbrief-confirm-buttons{display:flex;gap:10px;justify-content:flex-end}.btn-apply-confirmed{padding:8px 16px;font-size:12px;font-weight:600;border:none;border-radius:6px;background:linear-gradient(135deg,#8b5cf6 0%,#6366f1 100%);color:#fff;cursor:pointer;transition:all 0.2s ease}.btn-apply-confirmed:hover{transform:translateY(-1px);box-shadow:0 4px 12px rgba(139,92,246,0.4)}</style></head><body><div style="height:3px;background:linear-gradient(90deg,var(--primary) 0,#3b82f6 100%);margin:-16px -16px 12px -16px"></div><div class="header" id="tasksHeader"><button class="btn-new-task" id="newTaskBtn"><span class="plus-icon">+</span> New Task</button> <button class="btn-stats" id="openStatsBtn">üìä Statistics</button></div><div class="header" id="statsHeader" style="display:none"><button class="btn-return" id="returnToTasksBtn">‚Üê Return to Tasks</button> <button class="btn btn-sm" id="refreshStatsBtn">üîÑ Refresh</button></div><div id="tasksView"><div class="search-section"><div class="section-title">üîç Quick Search</div><div class="search-tabs"><button class="search-tab active" data-search="active">Active Tasks</button> <button class="search-tab" data-search="company">By Company</button></div><div class="search-input-wrap" id="searchInputWrap"><div class="autocomplete-wrap"><input id="searchInput" placeholder="Type company name..." autocomplete="off"/><div class="autocomplete-dropdown" id="autocompleteDropdown"></div></div><button id="searchBtn">Go</button></div><div class="load-row-hint" id="loadRowHint" style="display:none"><span>üëÜ Or click a row in Excel, then:</span> <button class="btn btn-sm btn-load-selected" id="loadSelectedBtn">üîÑ Load Selected Row</button></div><div id="searchHint" class="search-hint"></div><div class="search-results" id="searchResults"></div></div><div class="section"><div class="section-title">Company</div><div class="row"><input id="companyName" placeholder="Enter company name" style="width:100%;min-width:0;box-sizing:border-box"/></div><div class="row"><button class="btn-email-summary" id="viewEmailSummaryBtn" disabled="disabled"><span class="email-icon">üìß</span> SmartBrief</button></div></div><div id="emailSummarySection" class="email-summary-section"><div class="email-summary-header"><span class="email-summary-title">üìß Email Summaries <span id="emailSummaryCount" class="summary-count-badge">0</span></span> <button class="summary-close-btn" id="closeEmailSummaryBtn">&times;</button></div><div id="emailSummaryList" class="email-summary-list"><div class="email-loading">Loading summaries...</div></div></div><div class="section"><div class="section-title">Task Details</div><div class="row"><label>Task Category:</label><div id="taskCategories" class="toggle-list"><label><input type="checkbox" class="category-toggle" value="Onboarding"> Onboarding</label> <label><input type="checkbox" class="category-toggle" value="KYC update"> KYC update</label> <label><input type="checkbox" class="category-toggle" value="Amended Product/Rate"> Amended Product/Rate</label> <label><input type="checkbox" class="category-toggle" value="Other Task"> Other Task</label></div></div><div class="row"><label>Assigned to</label><div id="assignees" class="toggle-list"></div></div><div class="row"><label>Broker Lead:</label> <select id="brokerLead"></select></div></div><div class="section"><div class="section-title">Key Dates</div><div class="row"><label>Initial Request Date:</label> <input id="initialRequest" type="date"/><div class="date-display" id="initialRequestDisplay"></div></div><div class="row"><label>Intro Email Date:</label> <input id="introEmail" type="date"/><div class="date-display" id="introEmailDisplay"></div></div><div class="row"><label>‚è∞ Reminders Starting Date:</label> <input id="remindersStart" type="date"/><div class="date-display" id="remindersStartDisplay"></div></div></div><div class="section" id="tasksRow"><div class="section-title">Tasks</div><div class="row"><label>Select Tasks:</label><div id="tasksChecklist" class="toggle-list"><label><input type="checkbox" class="task-toggle" value="Broker Agreement"> Broker Agreement</label> <label><input type="checkbox" class="task-toggle" value="Give-up Agreement"> Give-up Agreement</label> <label><input type="checkbox" class="task-toggle" value="Amend Annex A"> Amend Annex A</label> <label><input type="checkbox" class="task-toggle" value="KYC (produced by LCMC)"> KYC (produced by LCMC)</label> <label><input type="checkbox" class="task-toggle" value="KYC External"> KYC External</label></div></div><div id="taskCards"><div class="task-card" data-task="Broker Agreement"><div class="row"><strong>Broker Agreement</strong></div><div class="row"><label>Status:</label><div class="chips" data-role="status-chips"><div class="chip" data-value="To Do">To Do</div><div class="chip" data-value="In Progress">In Progress</div><div class="chip" data-value="Done">Done</div></div></div><div class="row"><label>Assigned to:</label> <select data-role="task-assignee" class="task-assignee-select"></select></div><div class="row"><label>Comment:</label> <textarea rows="2" data-role="comment" placeholder="Add a brief comment for this task"></textarea></div><div class="row"><label>Deadline:</label> <input type="date" data-role="deadline"/></div></div><div class="task-card" data-task="Give-up Agreement"><div class="row"><strong>Give-up Agreement</strong></div><div class="row"><label>Status:</label><div class="chips" data-role="status-chips"><div class="chip" data-value="To Do">To Do</div><div class="chip" data-value="In Progress">In Progress</div><div class="chip" data-value="Done">Done</div></div></div><div class="row"><label>Assigned to:</label> <select data-role="task-assignee" class="task-assignee-select"></select></div><div class="row"><label>Comment:</label> <textarea rows="2" data-role="comment" placeholder="Add a brief comment for this task"></textarea></div><div class="row"><label>Give-up ID:</label> <input data-role="giveUpId"/></div><div class="row"><label>Deadline:</label> <input type="date" data-role="deadline"/></div></div><div class="task-card" data-task="Amend Annex A"><div class="row"><strong>Amend Annex A</strong></div><div class="row"><label>Status:</label><div class="chips" data-role="status-chips"><div class="chip" data-value="To Do">To Do</div><div class="chip" data-value="In Progress">In Progress</div><div class="chip" data-value="Done">Done</div></div></div><div class="row"><label>Assigned to:</label> <select data-role="task-assignee" class="task-assignee-select"></select></div><div class="row"><label>Comment:</label> <textarea rows="2" data-role="comment" placeholder="Add a brief comment for this task"></textarea></div><div class="row"><label>Deadline:</label> <input type="date" data-role="deadline"/></div></div><div class="task-card" data-task="KYC (produced by LCMC)"><div class="row" style="display:flex;justify-content:space-between;align-items:center"><strong>KYC (produced by LCMC)</strong> <button class="btn-magic" id="openKycPortal" type="button"><span class="sparkle">‚ú®</span>Open KYCai Assistant</button></div><div class="row"><label>Status:</label><div class="chips" data-role="status-chips"><div class="chip" data-value="To Do">To Do</div><div class="chip" data-value="In Progress">In Progress</div><div class="chip" data-value="Done">Done</div></div></div><div class="row"><label>Assigned to:</label> <select data-role="task-assignee" class="task-assignee-select"></select></div><div class="row"><label>Comment:</label> <textarea rows="2" data-role="comment" placeholder="Add a brief comment for this task"></textarea></div><div class="row"><label>Deadline:</label> <input type="date" data-role="deadline"/></div></div><div class="task-card" data-task="KYC External"><div class="row"><strong>KYC External</strong></div><div class="row"><label>Status:</label><div class="chips" data-role="status-chips"><div class="chip" data-value="To Do">To Do</div><div class="chip" data-value="In Progress">In Progress</div><div class="chip" data-value="Done">Done</div></div></div><div class="row"><label>Assigned to:</label> <select data-role="task-assignee" class="task-assignee-select"></select></div><div class="row"><label>Comment:</label> <textarea rows="2" data-role="comment" placeholder="Add a brief comment for this task"></textarea></div><div class="row"><label>Deadline:</label> <input type="date" data-role="deadline"/></div></div></div></div><div class="section task-card" id="otherTaskCard" data-task="__other__" style="display:none"><div class="section-title">Other Task</div><div class="row"><label>Task Name:</label> <input id="taskName" placeholder="Name of the other task"/></div><div class="row"><label>Status:</label><div class="chips" data-role="status-chips"><div class="chip" data-value="To Do">To Do</div><div class="chip" data-value="In Progress">In Progress</div><div class="chip" data-value="Done">Done</div></div></div><div class="row"><label>Assigned to:</label> <select data-role="task-assignee" class="task-assignee-select"></select></div><div class="row"><label>Comment:</label> <textarea rows="2" data-role="comment" placeholder="Add a brief comment for this task"></textarea></div><div class="row"><label>Deadline:</label> <input type="date" data-role="deadline"/></div></div><div class="section"><div class="section-title">Reminders & Notes</div><div class="row"><label>Email Reminders Frequency (EDT):</label> <select id="emailFrequency"><option value="">(none)</option><option value="Every Monday at 8AM">Every Monday at 8AM</option><option value="Every Monday, Wednesday and Friday at 8AM">Every Monday, Wednesday and Friday at 8AM</option><option value="Every working days at 8AM">Every working days at 8AM</option><option value="Every working days at 8AM and 2PM">Every working days at 8AM and 2PM</option></select></div><div class="row"><label>Extra Note:</label> <textarea id="extraNote" rows="3" placeholder="General note about this task"></textarea></div></div><div id="auditInfo"><label>History:</label><div id="auditText"></div><div style="margin-top:8px"><strong>Last KYC Produced:</strong> <span id="lastKycDate">‚Äî</span></div></div><div class="delete-task-row"><button class="btn-delete-task" id="deleteTaskBtn">Delete Task</button></div><div class="bottom-save-section"><span class="unsaved-indicator" id="unsavedIndicator"><span class="unsaved-dot"></span>Unsaved changes</span> <button class="btn-save-main" id="saveBtn"><span class="save-icon"><svg viewBox="0 0 24 24"><path d="M5 12l5 5L20 7"/></svg> </span>Save Changes</button></div></div><div id="statsView" style="display:none"><div class="stats-cards"><div class="stat-card"><div class="stat-value" id="statActiveTasks">-</div><div class="stat-label">Active Tasks</div></div><div class="stat-card"><div class="stat-value" id="statAvgDuration">-</div><div class="stat-label">Avg Duration (days)</div></div></div><div class="stats-section"><div class="stats-section-title">üìÖ Monthly Activity</div><div class="chart-legend"><span class="legend-item"><span class="legend-dot tasks"></span> Tasks created</span> <span class="legend-item"><span class="legend-dot kyc"></span> KYC completed</span></div><div class="monthly-chart" id="monthlyChart"></div></div><div class="stats-section"><div class="stats-section-title">üë§ Broker Lead Activity</div><div class="chart-legend"><span class="legend-item"><span class="legend-dot active"></span> Active</span> <span class="legend-item"><span class="legend-dot completed"></span> Completed</span></div><div class="broker-chart" id="brokerChart"></div></div><div class="stats-section"><div class="stats-section-title">üìä Status Distribution</div><div class="status-bars" id="statusBars"><div class="status-bar-row"><span class="status-label">To Do</span><div class="status-bar-track"><div class="status-bar-fill todo" id="barToDo" style="width:0%"></div></div><span class="status-count" id="countToDo">0</span></div><div class="status-bar-row"><span class="status-label">In Progress</span><div class="status-bar-track"><div class="status-bar-fill inprogress" id="barInProgress" style="width:0%"></div></div><span class="status-count" id="countInProgress">0</span></div><div class="status-bar-row"><span class="status-label">Done</span><div class="status-bar-track"><div class="status-bar-fill done" id="barDone" style="width:0%"></div></div><span class="status-count" id="countDone">0</span></div></div></div><div class="stats-section"><div class="stats-section-title">‚ö†Ô∏è Attention Required</div><div class="attention-stats"><div class="attention-group danger" id="overdueGroup"><div class="attention-header"><span class="attention-badge">üî¥ <span id="statOverdue">0</span></span> <span class="attention-title">Overdue</span></div><div class="attention-list" id="overdueList"></div></div><div class="attention-group warning" id="upcomingGroup"><div class="attention-header"><span class="attention-badge">üü† <span id="statUpcoming">0</span></span> <span class="attention-title">Due within 7 days</span></div><div class="attention-list" id="upcomingList"></div></div><div class="attention-group stale" id="staleGroup"><div class="attention-header"><span class="attention-badge">üü° <span id="statStale">0</span></span> <span class="attention-title">No update 30+ days</span></div><div class="attention-list" id="staleList"></div></div></div></div></div><div id="toast" class="toast"></div><div id="confirmDialog" class="confirm-overlay" style="display:none"><div class="confirm-box"><p id="confirmMessage">Are you sure?</p><div class="confirm-buttons"><button class="btn-confirm-cancel" id="confirmCancel">Cancel</button> <button class="btn-confirm-ok" id="confirmOk">Delete</button></div></div></div></body></html>
