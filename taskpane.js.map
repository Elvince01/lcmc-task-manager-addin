{"version":3,"file":"taskpane.js","mappings":";gGACIA,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqBE,IAAjBD,EACH,OAAOA,EAAaE,QAGrB,IAAIC,EAASN,EAAyBE,GAAY,CAGjDG,QAAS,CAAC,GAOX,OAHAE,EAAoBL,GAAUI,EAAQA,EAAOD,QAASJ,GAG/CK,EAAOD,OACf,CAGAJ,EAAoBO,EAAID,ECzBxBN,EAAoBQ,EAAI,WACvB,GAA0B,iBAAfC,WAAyB,OAAOA,WAC3C,IACC,OAAOC,MAAQ,IAAIC,SAAS,cAAb,EAChB,CAAE,MAAOC,GACR,GAAsB,iBAAXC,OAAqB,OAAOA,MACxC,CACA,CAPuB,GCAxBb,EAAoBc,EAAI,SAASC,EAAKC,GAAQ,OAAOC,OAAOC,UAAUC,eAAeC,KAAKL,EAAKC,EAAO,E,WCAtG,IAAIK,EACArB,EAAoBQ,EAAEc,gBAAeD,EAAYrB,EAAoBQ,EAAEe,SAAW,IACtF,IAAIC,EAAWxB,EAAoBQ,EAAEgB,SACrC,IAAKH,GAAaG,IACbA,EAASC,eAAkE,WAAjDD,EAASC,cAAcC,QAAQC,gBAC5DN,EAAYG,EAASC,cAAcG,MAC/BP,GAAW,CACf,IAAIQ,EAAUL,EAASM,qBAAqB,UAC5C,GAAGD,EAAQE,OAEV,IADA,IAAIC,EAAIH,EAAQE,OAAS,EAClBC,GAAK,KAAOX,IAAc,aAAaY,KAAKZ,KAAaA,EAAYQ,EAAQG,KAAKJ,GAE3F,CAID,IAAKP,EAAW,MAAM,IAAIa,MAAM,yDAChCb,EAAYA,EAAUc,QAAQ,SAAU,IAAIA,QAAQ,OAAQ,IAAIA,QAAQ,QAAS,IAAIA,QAAQ,YAAa,KAC1GnC,EAAoBoC,EAAIf,C,IClBxBrB,EAAoBqC,EAAyB,oBAAbb,UAA4BA,SAASc,SAAYC,KAAKhB,SAASiB,K,85DCC/F,IAAA5B,EAAA6B,EAAAC,EAAA,mBAAAC,OAAAA,OAAA,GAAAC,EAAAF,EAAAG,UAAA,aAAA/B,EAAA4B,EAAAI,aAAA,yBAAAd,EAAAU,EAAAE,EAAA9B,EAAAkB,GAAA,IAAAe,EAAAH,GAAAA,EAAA1B,qBAAA8B,EAAAJ,EAAAI,EAAAC,EAAAhC,OAAAiC,OAAAH,EAAA7B,WAAA,OAAAiC,EAAAF,EAAA,mBAAAP,EAAAE,EAAA9B,GAAA,IAAAkB,EAAAe,EAAAE,EAAAG,EAAA,EAAAhB,EAAAtB,GAAA,GAAAuC,GAAA,EAAAC,EAAA,CAAAlB,EAAA,EAAAQ,EAAA,EAAAW,EAAA3C,EAAA4C,EAAAC,EAAAL,EAAAK,EAAAC,KAAA9C,EAAA,GAAA6C,EAAA,SAAAhB,EAAAC,GAAA,OAAAV,EAAAS,EAAAM,EAAA,EAAAE,EAAArC,EAAA0C,EAAAV,EAAAF,EAAAc,CAAA,YAAAC,EAAAf,EAAAE,GAAA,IAAAG,EAAAL,EAAAO,EAAAL,EAAAH,EAAA,GAAAY,GAAAD,IAAAtC,GAAA2B,EAAAL,EAAAL,OAAAU,IAAA,KAAA3B,EAAAkB,EAAAI,EAAAK,GAAAgB,EAAAH,EAAAlB,EAAAuB,EAAA3B,EAAA,GAAAU,EAAA,GAAA5B,EAAA6C,IAAAf,KAAAK,EAAAjB,GAAAe,EAAAf,EAAA,OAAAe,EAAA,MAAAf,EAAA,GAAAA,EAAA,GAAApB,GAAAoB,EAAA,IAAAyB,KAAA3C,EAAA4B,EAAA,GAAAe,EAAAzB,EAAA,KAAAe,EAAA,EAAAO,EAAAC,EAAAX,EAAAU,EAAAV,EAAAZ,EAAA,IAAAyB,EAAAE,IAAA7C,EAAA4B,EAAA,GAAAV,EAAA,GAAAY,GAAAA,EAAAe,KAAA3B,EAAA,GAAAU,EAAAV,EAAA,GAAAY,EAAAU,EAAAV,EAAAe,EAAAZ,EAAA,OAAAjC,GAAA4B,EAAA,SAAAc,EAAA,MAAAH,GAAA,EAAAT,CAAA,iBAAA9B,EAAAsB,EAAAuB,GAAA,GAAAP,EAAA,QAAAQ,UAAA,oCAAAP,GAAA,IAAAjB,GAAAqB,EAAArB,EAAAuB,GAAAZ,EAAAX,EAAAa,EAAAU,GAAAlB,EAAAM,EAAA,EAAAnC,EAAAqC,KAAAI,GAAA,CAAArB,IAAAe,EAAAA,EAAA,GAAAA,EAAA,IAAAO,EAAAV,GAAA,GAAAa,EAAAV,EAAAE,IAAAK,EAAAV,EAAAK,EAAAK,EAAAC,EAAAN,GAAA,OAAAG,EAAA,EAAApB,EAAA,IAAAe,IAAAjC,EAAA,QAAA2B,EAAAT,EAAAlB,GAAA,MAAA2B,EAAAA,EAAArB,KAAAY,EAAAiB,IAAA,MAAAW,UAAA,wCAAAnB,EAAAoB,KAAA,OAAApB,EAAAQ,EAAAR,EAAAqB,MAAAf,EAAA,IAAAA,EAAA,YAAAA,IAAAN,EAAAT,EAAA+B,SAAAtB,EAAArB,KAAAY,GAAAe,EAAA,IAAAE,EAAAW,UAAA,oCAAA9C,EAAA,YAAAiC,EAAA,GAAAf,EAAApB,CAAA,UAAA6B,GAAAY,EAAAC,EAAAV,EAAA,GAAAK,EAAAP,EAAAtB,KAAAwB,EAAAU,MAAAE,EAAA,YAAAf,GAAAT,EAAApB,EAAAmC,EAAA,EAAAE,EAAAR,CAAA,SAAAW,EAAA,UAAAU,MAAArB,EAAAoB,KAAAR,EAAA,GAAAX,EAAA5B,EAAAkB,IAAA,GAAAiB,CAAA,KAAAO,EAAA,YAAAR,IAAA,UAAAgB,IAAA,UAAAC,IAAA,CAAAxB,EAAAxB,OAAAiD,eAAA,IAAAnB,EAAA,GAAAH,GAAAH,EAAAA,EAAA,GAAAG,QAAAO,EAAAV,EAAA,GAAAG,EAAA,yBAAAH,GAAAQ,EAAAgB,EAAA/C,UAAA8B,EAAA9B,UAAAD,OAAAiC,OAAAH,GAAA,SAAAK,EAAAxC,GAAA,OAAAK,OAAAkD,eAAAlD,OAAAkD,eAAAvD,EAAAqD,IAAArD,EAAAwD,UAAAH,EAAAd,EAAAvC,EAAAE,EAAA,sBAAAF,EAAAM,UAAAD,OAAAiC,OAAAD,GAAArC,CAAA,QAAAoD,EAAA9C,UAAA+C,EAAAd,EAAAF,EAAA,cAAAgB,GAAAd,EAAAc,EAAA,cAAAD,GAAAA,EAAAK,YAAA,oBAAAlB,EAAAc,EAAAnD,EAAA,qBAAAqC,EAAAF,GAAAE,EAAAF,EAAAnC,EAAA,aAAAqC,EAAAF,EAAAL,EAAA,yBAAAO,EAAAF,EAAA,oDAAAqB,EAAA,kBAAAC,EAAAvC,EAAAzB,EAAA6C,EAAA,cAAAD,EAAAvC,EAAA8B,EAAAE,EAAAH,GAAA,IAAAT,EAAAf,OAAAuD,eAAA,IAAAxC,EAAA,gBAAApB,GAAAoB,EAAA,EAAAmB,EAAA,SAAAvC,EAAA8B,EAAAE,EAAAH,GAAA,SAAA3B,EAAA4B,EAAAE,GAAAO,EAAAvC,EAAA8B,EAAA,SAAA9B,GAAA,YAAA6D,QAAA/B,EAAAE,EAAAhC,EAAA,GAAA8B,EAAAV,EAAAA,EAAApB,EAAA8B,EAAA,CAAAoB,MAAAlB,EAAA8B,YAAAjC,EAAAkC,cAAAlC,EAAAmC,UAAAnC,IAAA7B,EAAA8B,GAAAE,GAAA9B,EAAA,UAAAA,EAAA,WAAAA,EAAA,cAAAqC,EAAAvC,EAAA8B,EAAAE,EAAAH,EAAA,UAAAoC,EAAAjC,EAAAH,EAAA7B,EAAA8B,EAAA5B,EAAA0C,EAAAT,GAAA,QAAAf,EAAAY,EAAAY,GAAAT,GAAAE,EAAAjB,EAAA8B,KAAA,OAAAlB,GAAA,YAAAhC,EAAAgC,EAAA,CAAAZ,EAAA6B,KAAApB,EAAAQ,GAAA6B,QAAAC,QAAA9B,GAAA+B,KAAAtC,EAAA5B,EAAA,UAAAmE,EAAArC,GAAA,sBAAAH,EAAA,KAAA7B,EAAAsE,UAAA,WAAAJ,QAAA,SAAApC,EAAA5B,GAAA,IAAA0C,EAAAZ,EAAAuC,MAAA1C,EAAA7B,GAAA,SAAAwE,EAAAxC,GAAAiC,EAAArB,EAAAd,EAAA5B,EAAAsE,EAAAC,EAAA,OAAAzC,EAAA,UAAAyC,EAAAzC,GAAAiC,EAAArB,EAAAd,EAAA5B,EAAAsE,EAAAC,EAAA,QAAAzC,EAAA,CAAAwC,OAAA,OAIA,WACE,IAAME,EAAK,SAACC,GAAC,OAAG/D,SAASgE,cAAcD,EAAE,EACnCE,EAAM,SAACF,GAAC,OAAGG,MAAMC,KAAKnE,SAASoE,iBAAiBL,GAAG,EACrDM,GAAoB,EACpBC,GAAoB,EAIlBC,EAA2B,wBAGjC,SAASC,EAAUC,GAA2B,IAAlBC,EAAIhB,UAAAnD,OAAA,QAAA5B,IAAA+E,UAAA,GAAAA,UAAA,GAAG,UAC3BiB,EAAQb,EAAG,UACZa,IACLA,EAAMC,YAAcH,EACpBE,EAAME,UAAY,SAAWH,EAAO,QACpCI,WAAW,WACTH,EAAMI,UAAUC,OAAO,OACzB,EAAG,KACL,CAGA,SAASC,EAAkBC,GACzBZ,EAAoBY,EACpB,IAAMC,EAAYrB,EAAG,qBACjBqB,GACFA,EAAUJ,UAAUK,OAAO,UAAWF,EAE1C,CAyBA,SAASG,EAAWC,GAClB,IAAMC,EAAMvF,SAASwF,cAAc,OAEnC,OADAD,EAAIX,YAAca,OAAOH,GAAQ,IAC1BC,EAAIG,SACb,CAiCA,SAASC,IACP1B,EAAI,cAAc2B,QAAQ,SAAAC,GACxB,IAAMC,EAAgBD,EAAK7B,cAAc,0BACzC,GAAK8B,EAAL,CACA,IACMC,EAnCV,SAAgCC,GAC9B,IAAKA,EAAa,MAAO,GACzB,IAAMC,EAAW,IAAIC,KAAKF,GAC1B,GAAIG,MAAMF,EAASG,WAAY,MAAO,GACtC,IAAMC,EAAQ,IAAIH,KAClBG,EAAMC,SAAS,EAAG,EAAG,EAAG,GACxBL,EAASK,SAAS,EAAG,EAAG,EAAG,GAC3B,IAAMC,EAAWC,KAAKC,MAAMR,EAAWI,GAAS,OAChD,OAAIE,EAAW,EAAU,UACrBA,GAAY,EAAU,UACnB,EACT,CAwByBG,CADJZ,EAAcxD,OAE/BuD,EAAKd,UAAUC,OAAO,mBAAoB,oBACrB,YAAjBe,EACFF,EAAKd,UAAU4B,IAAI,oBACO,YAAjBZ,GACTF,EAAKd,UAAU4B,IAAI,mBAPK,CAS5B,EACF,CA3DAtH,OAAOuH,iBAAiB,eAAgB,SAACxH,GACvC,GAAIkF,EAGF,OAFAlF,EAAEyH,iBACFzH,EAAE0H,YAAc,GACT,EAEX,GAuDA,IAAMC,EAAmBjD,EAAG,gBAEtBkD,EAAelD,EAAG,eAClBmD,EAAsBnD,EAAG,mBACzBoD,EAAkBpD,EAAG,eACrBqD,EAAsBrD,EAAG,mBACzBsD,EAAmBtD,EAAG,mBACtBuD,EAAcvD,EAAG,cACjBwD,EAAcxD,EAAG,cACjByD,EAAazD,EAAG,aAChB0D,EAAqB1D,EAAG,cACxB2D,EAAgB3D,EAAG,aAGnB4D,EAAU5D,EAAG,YACb6D,EAAa7D,EAAG,eAChB8D,EAAkB9D,EAAG,oBACrB+D,EAAmB/D,EAAG,kBAGxBgE,EAAgB,KAwCpB,SAASC,EAAkBtD,GACzB,OAAO,IAAInB,QAAQ,SAACC,GAClB,IAAMyE,EAASlE,EAAG,kBACZmE,EAAQnE,EAAG,mBACXoE,EAAYpE,EAAG,kBACfqE,EAAQrE,EAAG,cAEjB,GAAKkE,GAAWC,GAAUC,GAAcC,EAAxC,CAKAF,EAAMrD,YAAcH,EACpBuD,EAAOI,MAAMC,QAAU,OAEvB,IAAMC,EAAU,WACdN,EAAOI,MAAMC,QAAU,OACvBH,EAAUK,oBAAoB,QAASC,GACvCL,EAAMI,oBAAoB,QAASE,EACrC,EAEMD,EAAW,WACfF,IACA/E,GAAQ,EACV,EAEMkF,EAAO,WACXH,IACA/E,GAAQ,EACV,EAEA2E,EAAUtB,iBAAiB,QAAS4B,GACpCL,EAAMvB,iBAAiB,QAAS6B,EAtBhC,MAFElF,GAAQ,EAyBZ,EACF,CAxEImE,GACFA,EAAQd,iBAAiB,QAAOnD,EAAAX,IAAA/D,EAAE,SAAA2J,IAAA,IAAAC,EAAA,OAAA7F,IAAAC,EAAA,SAAA6F,GAAA,cAAAA,EAAAhI,EAAAgI,EAAAxH,GAAA,UAAAwH,EAAAhI,EAAA,EAER,OAAlBkH,GAA4C,QAAlBA,EAAuB,CAAAc,EAAAxH,EAAA,eAAAwH,EAAAxH,EAAA,EAC7CyH,KAAY,OAClBrE,EAAU,iCAAkC,WAAWoE,EAAAxH,EAAA,sBAAAwH,EAAAxH,EAAA,EAEjD0H,KAAiB,OACvBtE,EAAU,0BAA4BsD,EAAe,WAAW,OAElE7C,GAAkB,GAAO2D,EAAAxH,EAAA,eAAAwH,EAAAhI,EAAA,EAAA+H,EAAAC,EAAA7G,EAEzBgH,QAAQC,MAAM,cAAaL,GAC3BnE,EAAU,kBAAoBmE,EAAElE,QAAS,SAAS,cAAAmE,EAAA5G,EAAA,KAAA0G,EAAA,kBAMpDd,GACFA,EAAgBhB,iBAAiB,QAAOnD,EAAAX,IAAA/D,EAAE,SAAAkK,IAAA,IAAAC,EAAA,OAAApG,IAAAC,EAAA,SAAAoG,GAAA,cAAAA,EAAAvI,EAAAuI,EAAA/H,GAAA,cAAA+H,EAAAvI,EAAA,EAAAuI,EAAA/H,EAAA,EAEhCgI,KAAmB,OACzB5E,EAAU,gBAAkBsD,EAAe,WAAWqB,EAAA/H,EAAA,eAAA+H,EAAAvI,EAAA,EAAAsI,EAAAC,EAAApH,EAEtDgH,QAAQC,MAAM,cAAaE,GAC3B1E,EAAU,uBAAwB,SAAS,cAAA2E,EAAAnH,EAAA,KAAAiH,EAAA,kBAK7CtB,GACFA,EAAWf,iBAAiB,QAAS,WACnCyC,IACF,GAyCF,IAAMC,EAAgBxF,EAAG,kBACrBwF,GACFA,EAAc1C,iBAAiB,QAAOnD,EAAAX,IAAA/D,EAAE,SAAAwK,IAAA,IAAAC,EAAA,OAAA1G,IAAAC,EAAA,SAAA0G,GAAA,cAAAA,EAAA7I,EAAA6I,EAAArI,GAAA,UAEhB,OAAlB0G,GAA4C,QAAlBA,EAAuB,CAAA2B,EAAArI,EAAA,QACU,OAA7DoD,EAAU,yCAA0C,SAASiF,EAAAzH,EAAA,iBAAAyH,EAAArI,EAAA,EAKvC2G,EAAkB,8CAA6C,OAAxE,GAAA0B,EAAA1H,EACC,CAAF0H,EAAArI,EAAA,eAAAqI,EAAAzH,EAAA,iBAAAyH,EAAA7I,EAAA,EAAA6I,EAAArI,EAAA,EAGNsI,KAAkB,OACxBlF,EAAU,8BAA+B,WACzC6E,KAAsBI,EAAArI,EAAA,eAAAqI,EAAA7I,EAAA,EAAA4I,EAAAC,EAAA1H,EAEtBgH,QAAQC,MAAM,gBAAeQ,GAC7BhF,EAAU,4BAA8BgF,EAAE/E,QAAS,SAAS,cAAAgF,EAAAzH,EAAA,KAAAuH,EAAA,kBAM9D1B,GAAqE,MAAjDA,EAAiB8B,QAAQC,sBAC/C/B,EAAiB8B,QAAQC,oBAAsB,IAC/C/B,EAAiBjB,iBAAiB,QAAS,SAACxH,GAC1CA,EAAEyH,iBACFzH,EAAEyK,kBAC0C,MAAxChC,EAAiB8B,QAAQG,aAC7BjC,EAAiB8B,QAAQG,WAAa,IACtCzK,OAAO0K,KAAK,6BAA8B,UAC1CjF,WAAW,WAAQ+C,EAAiB8B,QAAQG,WAAa,GAAK,EAAG,KACnE,IAIF,IAAME,EAAYlG,EAAG,cACfmG,EAAYnG,EAAG,cACfoG,EAAcpG,EAAG,gBACjBqG,EAAcrG,EAAG,gBACjBsG,EAAetG,EAAG,iBAClBuG,EAAmBvG,EAAG,qBACtBwG,EAAkBxG,EAAG,oBA2B3B,SACeyG,IAAc,OAAAC,EAAA7G,MAAC,KAADD,UAAA,CAiS7B,SAAA8G,IAFC,OAEDA,EAAA/G,EAAAX,IAAA/D,EAjSA,SAAA0L,IAAA,IAAAC,EAAA,OAAA5H,IAAAC,EAAA,SAAA4H,GAAA,cAAAA,EAAA/J,EAAA+J,EAAAvJ,GAAA,cAAAuJ,EAAA/J,EAAA,EAAA+J,EAAAvJ,EAAA,EAEUwJ,MAAMC,IAAG,eAAAC,EAAArH,EAAAX,IAAA/D,EAAC,SAAAgM,EAAOC,GAAO,IAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAzF,EAAA0F,EAAAC,EAAAC,EAAAzL,EAAA0L,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,OAAA/J,IAAAC,EAAA,SAAA+J,GAAA,cAAAA,EAAA1L,GAAA,OAET,OADb6J,EAAQD,EAAQ+B,SAASC,WAAWC,oBAAoB,sBACxDC,KAAK,QAAQJ,EAAA1L,EAAA,EACb4J,EAAQmC,OAAM,WAChBlC,EAAMmC,aAAc,CAAFN,EAAA1L,EAAA,QAC4B,OAAhD2H,QAAQC,MAAM,kCAAkC8D,EAAA9K,EAAA,UAMzB,OADnBkJ,EAAYD,EAAMoC,SAAS,aACvBH,KAAK,UAAUJ,EAAA1L,EAAA,EACnB4J,EAAQmC,OAAM,OAEe,MAA7BhC,EAAOD,EAAUoC,QAAU,IACxB/M,OAAS,GAAC,CAAAuM,EAAA1L,EAAA,eAAA0L,EAAA9K,EAAA,UAIfoJ,EAAY,EAAGC,EAAkB,EAAGC,EAAY,EAC9CC,EAAc,CAAC,EACfC,EAAe,CAAC,EAChBC,EAAa,CAAC,EAChBC,EAAgB,EAAGC,EAAgB,EAGjCC,EAAe,GACfC,EAAgB,GAChBC,EAAa,IAEbzF,EAAQ,IAAIH,MACZI,SAAS,EAAG,EAAG,EAAG,IAClByF,EAAmB,IAAI7F,KAAKG,IACjBkH,QAAQxB,EAAiByB,UAAY,IAChDxB,EAAgB,IAAI9F,KAAKG,IACjBkH,QAAQvB,EAAcwB,UAAY,IAAIvB,EAAAnJ,IAAA/D,EAAA,SAAAkN,IAAA,IAAAwB,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,OAAAvL,IAAAC,EAAA,SAAAuL,GAAA,cAAAA,EAAAlN,GAAA,OAIC,GAD7CqM,EAAMtC,EAAK3K,GACXkN,EAAUD,EAAI,GAAKhI,OAAOgI,EAAI,IAAIc,OAAS,GACnC,CAAFD,EAAAlN,EAAA,eAAAkN,EAAAtM,EAAA,YAEKyL,EAAI,IAAKhI,OAAOgI,EAAI,IAAIc,OACnCZ,EAASF,EAAI,GAAKhI,OAAOgI,EAAI,IAAIc,OAAS,SAC1CX,EAAiBH,EAAI,GACrBI,EAAaJ,EAAI,GACjBK,EAAiBL,EAAI,GACrBM,EAAcN,EAAI,GAAKhI,OAAOgI,EAAI,IAAIc,OAAS,GAIjDP,EAAW,KACTC,EAAQO,EAAUZ,GAClBM,EAAQM,EAAUX,GAClBM,EAAQK,EAAUV,IAGlBM,EAAiB,CAACH,EAAOC,EAAOC,GAAOM,OAAO,SAAAxM,GAAC,OAAU,OAANA,CAAU,IAChD1B,OAAS,IAC1ByN,EAAWI,EAAeM,OAAO,SAACC,EAAK1M,GAAC,OAAKA,EAAI0M,EAAM1M,EAAI0M,CAAG,IAG5DX,IACIK,EAAW,GAAHO,OAAMZ,EAASa,cAAa,KAAAD,OAAInJ,OAAOuI,EAASc,WAAa,GAAGC,SAAS,EAAG,MAC1FvD,EAAa6C,IAAa7C,EAAa6C,IAAa,GAAK,GAItD9C,EAAYoC,KACfpC,EAAYoC,GAAU,CAAEqB,MAAO,EAAGC,OAAQ,EAAGC,UAAW,IAE1D3D,EAAYoC,GAAQqB,QAGhBjB,GACYA,EAAYoB,MAAM,SAASV,OAAOW,SAC1CxJ,QAAQ,SAAAyJ,GACZ,IAAMC,EAAQD,EAAKE,cAenB,GAZID,EAAME,SAAS,YACjBpE,IACAG,EAAYoC,GAAQsB,UACXK,EAAME,SAAS,kBACxBnE,IACAE,EAAYoC,GAAQsB,UACXK,EAAME,SAAS,YACxBlE,IACAC,EAAYoC,GAAQuB,aAIlBI,EAAME,SAAS,QAAUF,EAAME,SAAS,UAAW,CACrD,IAAMC,EAAiBJ,EAAKK,MAAM,uDAClC,GAAID,EAAgB,CAClB,IAAME,EAAUnB,EAAUiB,EAAe,IACzC,GAAIE,EAAS,CACX,IAAMtB,EAAW,GAAHO,OAAMe,EAAQd,cAAa,KAAAD,OAAInJ,OAAOkK,EAAQb,WAAa,GAAGC,SAAS,EAAG,MACxFtD,EAAW4C,IAAa5C,EAAW4C,IAAa,GAAK,CACvD,CACF,CACF,CAGA,IAAMuB,EAAgBP,EAAKK,MAAM,0CAC3BG,EAAgBR,EAAKK,MAAM,0BAC3BI,EAAWF,EAAgBA,EAAc,GAAGrB,OAAS,UACrDwB,EAAWF,EAAgBA,EAAc,GAAGtB,OAAS,GAGrDyB,EAAgBX,EAAKK,MAAM,wEACjC,GAAIM,IAAkBV,EAAME,SAAS,UAAW,CAC9C,IAAMvJ,EAAWuI,EAAUwB,EAAc,IACzC,GAAI/J,EAAU,CACZ,IAAMgK,EAAYzJ,KAAKC,MAAMR,EAAWI,GAAS,OAC7CJ,EAAWI,EACbuF,EAAasE,KAAK,CAChBxC,QAAAA,EACAyC,KAAML,EACNC,SAAAA,EACAK,OAAQ,GAAFxB,OAAKpI,KAAK6J,IAAIJ,GAAU,eAEvBhK,GAAY8F,GACrBF,EAAcqE,KAAK,CACjBxC,QAAAA,EACAyC,KAAML,EACNC,SAAAA,EACAK,OAAsB,IAAdH,EAAkB,QAAU,GAAHrB,OAAMqB,EAAS,WAGtD,CACF,CAGA,IAAKX,EAAME,SAAS,UAAW,CAE7B,IAAMc,EAAiBjB,EAAKK,MAAM,uDAC5Ba,EAAelB,EAAKK,MAAM,qDAE5Bc,EAAiB,KAOrB,GANID,EACFC,EAAiBhC,EAAU+B,EAAa,IAC/BD,IACTE,EAAiBhC,EAAU8B,EAAe,KAGxCE,GAAkBA,EAAiBxE,EAAe,CACpD,IAAMyE,EAAYjK,KAAKC,MAAMJ,EAAQmK,GAAkB,OACvD1E,EAAWoE,KAAK,CACdxC,QAAAA,EACAyC,KAAML,EACNC,SAAAA,EACAK,OAAQ,GAAFxB,OAAK6B,EAAS,UAExB,CACF,CAGA,GAAInB,EAAME,SAAS,UAAW,CAC5B,IAAMc,EAAiBjB,EAAKK,MAAM,uDAC5BD,EAAiBJ,EAAKK,MAAM,uDAClC,GAAIY,GAAkBb,EAAgB,CACpC,IAAMiB,EAAYlC,EAAU8B,EAAe,IACrCpB,EAAYV,EAAUiB,EAAe,IAC3C,GAAIiB,GAAaxB,EAAW,CAC1B,IAAMyB,EAAOnK,KAAKC,MAAMyI,EAAYwB,GAAa,OAC7CC,GAAQ,GAAKA,EAAO,MACtBjF,GAAiBiF,EACjBhF,IAEJ,CACF,CACF,CACF,GACD,cAAA2C,EAAAtM,EAAA,KAAAiK,EAAA,GAzIMzL,EAAI,EAAC,YAAEA,EAAI2K,EAAK5K,QAAM,CAAAuM,EAAA1L,EAAA,eAAA0L,EAAA7K,EAAA2O,EAAA3E,KAAA,cAAAa,EAAA/K,EAAA,CAAA+K,EAAA1L,EAAA,eAAA0L,EAAA9K,EAAA,YAAExB,IAAGsM,EAAA1L,EAAA,eA6I9B8K,EAAcd,EAAYC,EAChCvH,EAAG,oBAAoBc,YAAcsH,EACrCpI,EAAG,oBAAoBc,YAAc+G,EAAgB,EAAInF,KAAKqK,MAAMnF,EAAgBC,GAAiB,KAG/FQ,EAAcf,EAAYC,EAAkBC,GAChC,IAChBxH,EAAG,YAAYsE,MAAM0I,MAAS1F,EAAYe,EAAc,IAAO,IAC/DrI,EAAG,kBAAkBsE,MAAM0I,MAASzF,EAAkBc,EAAc,IAAO,IAC3ErI,EAAG,YAAYsE,MAAM0I,MAASxF,EAAYa,EAAc,IAAO,KAEjErI,EAAG,cAAcc,YAAcwG,EAC/BtH,EAAG,oBAAoBc,YAAcyG,EACrCvH,EAAG,cAAcc,YAAc0G,EAIzBc,EAAuB,SAAC2E,EAAOC,EAASC,EAAQC,GACpD,IAAMC,EAAQrN,EAAG,IAAD8K,OAAKoC,IACfI,EAAYtN,EAAG,IAAD8K,OAAKqC,IACnBI,EAAUvN,EAAG,IAAD8K,OAAKsC,IAIvB,GAFIG,IAASA,EAAQzM,YAAcmM,EAAMxQ,QAEpC4Q,GAAUC,EAAf,CAEA,GAAqB,IAAjBL,EAAMxQ,OAGR,OAFA4Q,EAAMpM,UAAUC,OAAO,kBACvBoM,EAAU1L,UAAY,IAIxByL,EAAMpM,UAAU4B,IAAI,aAEpByK,EAAU1L,UAAYqL,EAAMO,MAAM,EAAG,IAAIC,IAAI,SAAAC,GAC3C,IAAMC,EAAeD,EAAKzB,SAAW,iCAAHnB,OAAoCvJ,EAAWmM,EAAKzB,UAAS,WAAY,GAC3G,MAAO,8EAAPnB,OACmCvJ,EAAWmM,EAAK9D,SAAQ,MAAAkB,OAAKvJ,EAAWmM,EAAKrB,MAAK,MAAAvB,OAAKvJ,EAAWmM,EAAK9D,SAAQ,MAAAkB,OAAKvJ,EAAWmM,EAAKrB,OAAKvB,OAAG6C,EAAY,qDAAA7C,OAC7HvJ,EAAWmM,EAAKpB,QAAO,8BAEvD,GAAGsB,KAAK,GAhBwB,CAiBlC,EAGA9F,EAAa+F,KAAK,SAAC3P,EAAGnB,GAAC,OAAK+Q,SAAS/Q,EAAEuP,QAAUwB,SAAS5P,EAAEoO,OAAO,GACnEvE,EAAc8F,KAAK,SAAC3P,EAAGnB,GAAC,OAAK+Q,SAAS5P,EAAEoO,QAAUwB,SAAS/Q,EAAEuP,OAAO,GACpEtE,EAAW6F,KAAK,SAAC3P,EAAGnB,GAAC,OAAK+Q,SAAS/Q,EAAEuP,QAAUwB,SAAS5P,EAAEoO,OAAO,GAEjEhE,EAAqBR,EAAc,eAAgB,cAAe,eAClEQ,EAAqBP,EAAe,gBAAiB,eAAgB,gBACrEO,EAAqBN,EAAY,aAAc,YAAa,cAGtDO,EAAevI,EAAG,oBAEhBwI,EAAe7M,OAAOoS,KAAKrG,GAAcmG,OAAOG,UAAUR,MAAM,EAAG,GAAGQ,UACtEvF,EAAW/F,KAAKuL,IAAGpO,MAAR6C,KAAIwL,EAAQ1F,EAAaiF,IAAI,SAAAxS,GAAC,OAAIyM,EAAazM,IAAM,CAAC,IAAC6P,OAAA,CAAE,KACpEpC,EAAShG,KAAKuL,IAAGpO,MAAR6C,KAAIwL,EAAQ1F,EAAaiF,IAAI,SAAAxS,GAAC,OAAI0M,EAAW1M,IAAM,CAAC,IAAC6P,OAAA,CAAE,KAChEnC,EAASjG,KAAKuL,IAAIxF,EAAUC,GAE5BE,EAAa,CAAC,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,OACtFL,EAAa3G,UAAY4G,EAAaiF,IAAI,SAAAU,GACxC,IAAkCC,EAAAC,EAAhBF,EAAM9C,MAAM,KAAI,GAArBpQ,GAAFmT,EAAA,GAAGA,EAAA,IACRE,EAAa1F,EAAWkF,SAAS7S,GAAK,GACtCsT,EAAQ7G,EAAayG,IAAU,EAC/BK,EAAM7G,EAAWwG,IAAU,EAE3BM,EAAY9F,EAAS,EAAK6F,EAAM7F,EAAS,GAAM,EACrD,MAAO,qIAAPmC,OAFmBnC,EAAS,EAAK4F,EAAQ5F,EAAS,GAAM,EAIG,4BAAAmC,OACnDyD,EAAQ,EAAI,iCAAHzD,OAAoCyD,EAAK,WAAY,GAAE,uFAAAzD,OAEzB2D,EAAS,4BAAA3D,OAChD0D,EAAM,EAAI,iCAAH1D,OAAoC0D,EAAG,WAAY,GAAE,+FAAA1D,OAGnCwD,EAAU,6BAE7C,GAAGV,KAAK,MAIJ/E,EAAc7I,EAAG,mBAEf8I,EAAgBnN,OAAO+S,QAAQjH,GAClCkD,OAAO,SAAAgE,GAAA,IAAEC,EAAFP,EAAAM,EAAA,GAAM,UAAMC,GAAiB,WAATA,GAAqC,KAAhBA,EAAKnE,MAAa,GAClEoD,KAAK,SAAC3P,EAAGnB,GAAC,OAAMA,EAAE,GAAGoO,OAASpO,EAAE,GAAGqO,WAAclN,EAAE,GAAGiN,OAASjN,EAAE,GAAGkN,UAAU,GAE3E3C,EAAW/F,KAAKuL,IAAGpO,MAAR6C,KAAIwL,EAAQpF,EAAc2E,IAAI,SAAAoB,GAAA,IAAG5O,EAAHoO,EAAAQ,EAAA,GAAI,UAAM5O,EAAEkL,OAASlL,EAAEmL,SAAS,IAACN,OAAA,CAAE,KAElFjC,EAAYjH,UAAYkH,EAAc2E,IAAI,SAAAqB,GAAmB,IAAAC,EAAAV,EAAAS,EAAA,GAAjBF,EAAIG,EAAA,GAAEC,EAAKD,EAAA,GAC/CE,EAAcxG,EAAW,EAAKuG,EAAM7D,OAAS1C,EAAW,IAAO,EAC/DyG,EAAiBzG,EAAW,EAAKuG,EAAM5D,UAAY3C,EAAW,IAAO,EAC3E,MAAO,4EAAPqC,OACqCvJ,EAAWqN,GAAK,MAAA9D,OAAKvJ,EAAWqN,GAAK,4HAAA9D,OAEnBmE,EAAW,OAAAnE,OAAMkE,EAAM7D,OAAS,EAAI,yBAAHL,OAA4BkE,EAAM7D,OAAM,WAAY,GAAE,gFAAAL,OACpFoE,EAAc,OAAApE,OAAMkE,EAAM5D,UAAY,EAAI,yBAAHN,OAA4BkE,EAAM5D,UAAS,WAAY,GAAE,mDAG5J,GAAGwC,KAAK,KACT,cAAA5E,EAAA9K,EAAA,KAAA+I,EAAA,IACF,gBAAAkI,GAAA,OAAAnI,EAAAnH,MAAA,KAAAD,UAAA,EAzRc,IAyRb,OAAAiH,EAAAvJ,EAAA,eAAAuJ,EAAA/J,EAAA,EAAA8J,EAAAC,EAAA5I,EAEFgH,QAAQC,MAAM,4BAA2B0B,GAAK,cAAAC,EAAA3I,EAAA,KAAAyI,EAAA,iBAEjDD,EAAA7G,MAAA,KAAAD,UAAA,CAGD,SAAS8K,EAAU0E,GACjB,IAAKA,EAAS,OAAO,KAIrB,GAAuB,iBAAZA,GAAwBA,EAAU,GAAKA,EAAU,IAAQ,CAElE,IAAMC,EAAa,IAAIjN,KAAK,KAAM,GAAI,IAChCkN,EAAS,IAAIlN,KAAKiN,EAAW/M,UAAsB,GAAV8M,EAAe,GAAK,GAAK,KACxE,IAAK/M,MAAMiN,EAAOhN,YAAcgN,EAAOvE,cAAgB,KACrD,OAAOuE,CAEX,CAGA,IAAMC,EAAU5N,OAAOyN,GAGnBjR,EAAI,IAAIiE,KAAKmN,GACjB,IAAKlN,MAAMlE,EAAEmE,YAAcnE,EAAE4M,cAAgB,KAAM,OAAO5M,EAG1D,IAAMyN,EAAQ2D,EAAQ3D,MAAM,6CAC5B,GAAIA,EAAO,CACT,IACM4D,EAAM1B,SAASlC,EAAM,IACrBuC,EAFS,CAACsB,IAAI,EAAEC,IAAI,EAAEC,IAAI,EAAEC,IAAI,EAAEC,IAAI,EAAEC,IAAI,EAAEC,IAAI,EAAEC,IAAI,EAAEC,IAAI,EAAEC,IAAI,EAAEC,IAAI,GAAGC,IAAI,IAElExE,EAAM,GAAGH,eAC1B4E,EAAOvC,SAASlC,EAAM,IAE1B,GADIyE,EAAO,MAAKA,GAAQ,UACVxV,IAAVsT,EACF,OAAO,IAAI/L,KAAKiO,EAAMlC,EAAOqB,EAEjC,CACA,OAAO,IACT,CA9VIlJ,GACFA,EAAaxD,iBAAiB,QAAS,WACjCoD,IAAWA,EAAU5B,MAAMC,QAAU,QACrC6B,IAAaA,EAAY9B,MAAMC,QAAU,QACzC4B,IAAWA,EAAU7B,MAAMC,QAAU,IACrC8B,IAAaA,EAAY/B,MAAMC,QAAU,QAC7CkC,GACF,GAGEF,GACFA,EAAiBzD,iBAAiB,QAAS,WACrCoD,IAAWA,EAAU5B,MAAMC,QAAU,IACrC6B,IAAaA,EAAY9B,MAAMC,QAAU,QACzC4B,IAAWA,EAAU7B,MAAMC,QAAU,QACrC8B,IAAaA,EAAY/B,MAAMC,QAAU,OAC/C,GAGEiC,GACFA,EAAgB1D,iBAAiB,QAAS,WACxC2D,GACF,GA2UF,IAAM6J,EAActQ,EAAG,gBACjBuQ,EAAkBvQ,EAAG,oBACrBwQ,EAAYxQ,EAAG,cACfyQ,EAAgBzQ,EAAG,kBACnB0Q,EAAa1Q,EAAG,eAChB2Q,EAAaxQ,EAAI,eACnByQ,EAAoB,SAGlBC,EAAc7Q,EAAG,gBAEvB,SAAS8Q,IACFJ,GAAeJ,GAAgBC,IAEV,WAAtBK,GACFL,EAAgBjM,MAAMC,QAAU,OAC5BsM,IAAaA,EAAYvM,MAAMC,QAAU,QAC7CmM,EAAW5P,YAAc,sDACM,YAAtB8P,IACTL,EAAgBjM,MAAMC,QAAU,OAC5BsM,IAAaA,EAAYvM,MAAMC,QAAU,QAC7C+L,EAAYS,YAAc,uBAC1BT,EAAY1P,KAAO,OACnB8P,EAAW5P,YAAc,IAE7B,CAGA6P,EAAW7O,QAAQ,SAAAkP,GACjBA,EAAIlO,iBAAiB,QAAOnD,EAAAX,IAAA/D,EAAE,SAAAgW,IAAA,OAAAjS,IAAAC,EAAA,SAAAiS,GAAA,cAAAA,EAAA5T,GAAA,OAS5B,GARAqT,EAAW7O,QAAQ,SAAA3E,GAAC,OAAIA,EAAE8D,UAAUC,OAAO,SAAS,GACpD8P,EAAI/P,UAAU4B,IAAI,UAClB+N,EAAoBI,EAAIG,aAAa,eACjCb,IACFA,EAAY9R,MAAQ,IAEtBsS,IAG0B,WAAtBF,EAA8B,CAAAM,EAAA5T,EAAA,eAAA4T,EAAA5T,EAAA,EAC1B8T,KAAe,OAAAF,EAAA5T,EAAA,eAGjBmT,IACFA,EAAcxP,UAAUC,OAAO,WAC/BuP,EAAc7O,UAAY,IAC3B,cAAAsP,EAAAhT,EAAA,KAAA+S,EAAA,IAGP,GAGIT,GACFA,EAAU1N,iBAAiB,QAAOnD,EAAAX,IAAA/D,EAAE,SAAAoW,IAAA,OAAArS,IAAAC,EAAA,SAAAqS,GAAA,cAAAA,EAAAhU,GAAA,cAAAgU,EAAAhU,EAAA,EAC5B8T,KAAe,cAAAE,EAAApT,EAAA,KAAAmT,EAAA,KAKrBf,GACFA,EAAYxN,iBAAiB,WAAU,eAAAyO,EAAA5R,EAAAX,IAAA/D,EAAE,SAAAuW,EAAOlW,GAAC,OAAA0D,IAAAC,EAAA,SAAAwS,GAAA,cAAAA,EAAAnU,GAAA,UACjC,UAAVhC,EAAEoW,IAAe,CAAAD,EAAAnU,EAAA,QACA,OAAnBqU,KAAmBF,EAAAnU,EAAA,EACb8T,KAAe,cAAAK,EAAAvT,EAAA,KAAAsT,EAAA,IAExB,gBAAAI,GAAA,OAAAL,EAAA1R,MAAA,KAAAD,UAAA,EALsC,IASzC,IAAMiS,EAAuB7R,EAAG,yBAC5B8R,EAAc,GACdC,EAAsB,KAE1B,SACeC,KAAe,OAAAC,GAAApS,MAAC,KAADD,UAAA,UAAAqS,KA6B7B,OA7B6BA,GAAAtS,EAAAX,IAAA/D,EAA9B,SAAAiX,IAAA,IAAAC,EAAA,OAAAnT,IAAAC,EAAA,SAAAmT,GAAA,cAAAA,EAAAtV,EAAAsV,EAAA9U,GAAA,YACMwU,EAAYrV,OAAS,GAAC,CAAA2V,EAAA9U,EAAA,eAAA8U,EAAAlU,EAAA,iBAAAkU,EAAAtV,EAAA,EAAAsV,EAAA9U,EAAA,EAElBwJ,MAAMC,IAAG,eAAAsL,EAAA1S,EAAAX,IAAA/D,EAAC,SAAAqX,EAAOpL,GAAO,IAAAC,EAAAC,EAAAoC,EAAA9M,EAAAkS,EAAA2D,EAAA,OAAAvT,IAAAC,EAAA,SAAAuT,GAAA,cAAAA,EAAAlV,GAAA,OAET,OADb6J,EAAQD,EAAQ+B,SAASC,WAAWC,oBAAoB,sBACxDC,KAAK,QAAQoJ,EAAAlV,EAAA,EACb4J,EAAQmC,OAAM,WAChBlC,EAAMmC,aAAc,CAAFkJ,EAAAlV,EAAA,eAAAkV,EAAAtU,EAAA,UAIG,OADnBkJ,EAAYD,EAAMoC,SAAS,aACvBH,KAAK,UAAUoJ,EAAAlV,EAAA,EACnB4J,EAAQmC,OAAM,OAIpB,IAFMG,EAASpC,EAAUoC,QAAU,GACnCsI,EAAc,GACLpV,EAAI,EAAGA,EAAI8M,EAAO/M,OAAQC,IAC3BkS,EAAOpF,EAAO9M,GAAG,GAAKiF,OAAO6H,EAAO9M,GAAG,IAAI+N,OAAS,GACpD8H,EAAW/I,EAAO9M,GAAG,GAAKiF,OAAO6H,EAAO9M,GAAG,IAAI+N,OAAS,GAC1DmE,GACFkD,EAAY1F,KAAK,CAAEwC,KAAAA,EAAM2D,SAAAA,EAAUE,OAAQ/V,EAAI,IAInDuI,QAAQyN,IAAI,SAAUZ,EAAYrV,OAAQ,iCAAiC,cAAA+V,EAAAtU,EAAA,KAAAoU,EAAA,IAC5E,gBAAAK,GAAA,OAAAN,EAAAxS,MAAA,KAAAD,UAAA,EAtBc,IAsBb,OAAAwS,EAAA9U,EAAA,eAAA8U,EAAAtV,EAAA,EAAAqV,EAAAC,EAAAnU,EAEFgH,QAAQC,MAAM,+BAA8BiN,GAAK,cAAAC,EAAAlU,EAAA,KAAAgU,EAAA,iBAEpDD,GAAApS,MAAA,KAAAD,UAAA,CAED,SAASgT,GAAiBC,GACxB,GAAKhB,GAAyBgB,GAA+B,YAAtBjC,EAAvC,CAIA,IAAMkC,EAAID,EAAMpH,cAGVsH,EAAajB,EAAYnH,OAAO,SAAAlN,GAAC,OAAIA,EAAEmR,KAAKnD,cAAcC,SAASoH,EAAE,GACrEE,EAAoBD,EAAWpI,OAAO,SAAAlN,GAAC,OAAIA,EAAEmR,KAAKnD,cAAcwH,WAAWH,EAAE,GAC7EI,EAAkBH,EAAWpI,OAAO,SAAAlN,GAAC,OAAKA,EAAEmR,KAAKnD,cAAcwH,WAAWH,EAAE,GAC5EK,EAAgB,GAAArI,OAAAoD,EAAI8E,GAAiB9E,EAAKgF,IAAiB1F,MAAM,EAAG,IAE7C,IAAzB2F,EAAc1W,QAIlBoV,EAAqBjQ,UAAYuR,EAAc1F,IAAI,SAAAhQ,GACjD,IAAM2V,EAAe3V,EAAE8U,SAAW,MAAHzH,OAASvJ,EAAW9D,EAAE8U,WAAc,GACnE,MAAO,4CAAPzH,OAAmDrN,EAAEgV,OAAM,iBAAA3H,OAAgBvJ,EAAW9D,EAAEmR,MAAK,2CAAA9D,OAC9DvJ,EAAW9D,EAAEmR,MAAK,gDAAA9D,OAClBrN,EAAEgV,QAAM3H,OAAGsI,EAAY,wBAExD,GAAGxF,KAAK,IACRiE,EAAqB5Q,UAAU4B,IAAI,WAGnCgP,EAAqBvR,iBAAiB,sBAAsBwB,QAAQ,SAAA4L,GAClEA,EAAK5K,iBAAiB,QAAOnD,EAAAX,IAAA/D,EAAE,SAAAoY,IAAA,IAAAZ,EAAA7D,EAAA,OAAA5P,IAAAC,EAAA,SAAAqU,GAAA,cAAAA,EAAAhW,GAAA,OAIV,OAHbmV,EAAS3E,SAASJ,EAAKyD,aAAa,YAAa,IACjDvC,EAAOlB,EAAKyD,aAAa,aAC3Bb,IAAaA,EAAY9R,MAAQoQ,GACrC+C,KAAmB2B,EAAAhW,EAAA,EACbiW,GAAiBd,GAAO,cAAAa,EAAApV,EAAA,KAAAmV,EAAA,IAElC,IArBE1B,IAVF,MAFEA,IAkCJ,CAEA,SAASA,KACHE,IACFA,EAAqB5Q,UAAUC,OAAO,WACtC2Q,EAAqBjQ,UAAY,GAErC,CAkCiB,SAEFwP,KAAa,OAAAoC,GAAA3T,MAAC,KAADD,UAAA,UAAA4T,KAgK3B,OAhK2BA,GAAA7T,EAAAX,IAAA/D,EAA5B,SAAAwY,IAAA,IAAAC,EAAA,OAAA1U,IAAAC,EAAA,SAAA0U,GAAA,cAAAA,EAAA7W,EAAA6W,EAAArW,GAAA,UACOmT,EAAe,CAAFkD,EAAArW,EAAA,eAAAqW,EAAAzV,EAAA,UAIsC,OAFxDuS,EAAc7O,UAAY,6CAC1B6O,EAAcxP,UAAU4B,IAAI,WAC5BoC,QAAQyN,IAAI,wBAAyB9B,GAAmB+C,EAAA7W,EAAA,EAAA6W,EAAArW,EAAA,EAGhDwJ,MAAMC,IAAG,eAAA6M,EAAAjU,EAAAX,IAAA/D,EAAC,SAAA4Y,EAAO3M,GAAO,IAAAC,EAAAC,EAAA0M,EAAAtK,EAAAuK,EAAAC,EAAAC,EAAAvX,EAAAwX,EAAAC,EAAAC,EAAA,OAAApV,IAAAC,EAAA,SAAAoV,GAAA,cAAAA,EAAA/W,GAAA,OAET,OADb6J,EAAQD,EAAQ+B,SAASC,WAAWC,oBAAoB,sBACxDC,KAAK,QAAQiL,EAAA/W,EAAA,EACb4J,EAAQmC,OAAM,OAC6B,GAAjDpE,QAAQyN,IAAI,gBAAiBvL,EAAMmC,eAC/BnC,EAAMmC,aAAc,CAAF+K,EAAA/W,EAAA,QACsD,OAA1EmT,EAAc7O,UAAY,gDAAgDyS,EAAAnW,EAAA,UAOnD,OADnBkJ,EAAYD,EAAMoC,SAAS,OAADuB,OADhB,OAEN1B,KAAK,UAAUiL,EAAA/W,EAAA,EACnB4J,EAAQmC,OAAM,OAEdyK,EAAY1M,EAAUoC,QAAU,GACtCvE,QAAQyN,IAAI,iDAAkDoB,EAAUrX,QAElE+M,EAASpJ,MAAMkU,QAAQR,GAAaA,EAAY,GAChDC,EAAU,GACZC,EAAc,EAACC,EAAAjV,IAAA/D,EAAA,SAAAgZ,IAAA,IAAAtK,EAAA4K,EAAAC,EAAAvK,EAAAwK,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EA2CRC,EAAcC,EAAAC,EAAAC,EAAA3C,EAAAI,EAAA,OAAA7T,IAAAC,EAAC,SAADoW,GAAA,cAAAA,EAAA/X,GAAA,OAvC+B,GAuC7C2X,EAAc,SAACK,GACtB,IAAKA,GAA8B,IAAnBA,EAAQ7Y,OAAc,MAAO,GAC7C,IAAI8Y,EAAO,KAOX,GANAD,EAAQxT,QAAQ,SAAA0T,GACd,GAAKA,EAAL,CACA,IAAMrX,EAAI,IAAIiE,KAAKoT,GACfnT,MAAMlE,EAAEmE,cACPiT,GAAQpX,EAAIoX,KAAMA,EAAOpX,EAHb,CAInB,IACKoX,EAAM,MAAO,GAClB,IAAME,EAAOF,EAAKxK,cACZ2K,EAAK/T,OAAO4T,EAAKvK,WAAa,GAAGC,SAAS,EAAE,KAC5C0K,EAAKhU,OAAO4T,EAAK7L,WAAWuB,SAAS,EAAE,KAC7C,MAAO,GAAPH,OAAU2K,EAAI,KAAA3K,OAAI4K,EAAE,KAAA5K,OAAI6K,EAC1B,IAtDMhM,EAAMH,EAAO9M,IAAM,IACLkZ,MAAM,SAAAnY,GAAC,OAAU,OAANA,GAAoB,KAANA,CAAQ,GACxC,CAAF4X,EAAA/X,EAAA,eAAA+X,EAAAnX,EAAA,YACX8V,IACMO,EAAc5K,EAAI,GAAKhI,OAAOgI,EAAI,IAAIc,OAAS,GAC/C+J,EAAe7K,EAAI,GAAKhI,OAAOgI,EAAI,IAAIc,OAAS,GAChDR,EAAcN,EAAI,GAAKhI,OAAOgI,EAAI,IAAIc,OAAS,GAGjDgK,GAAiB,EACjBC,EAAiB,UACjBC,GAAU,EAAOC,GAAc,EAAOC,GAAU,EAChDC,EAAY,GACZC,EAAgB,GAChBC,EAAY,GAEZ/K,IACYA,EAAYoB,MAAM,SAASV,OAAOW,SAC1CxJ,QAAQ,SAAAyJ,GACZ,IAAMsK,EAASC,GAAcvK,GAC7B,GAAKsK,EAAL,CACA,IAAME,GAAMF,EAAOG,QAAU,IAAIvK,cACtB,UAAPsK,GACFpB,GAAU,EACNkB,EAAOjJ,WAAWkI,EAAU1I,KAAKyJ,EAAOjJ,YAC5B,gBAAPmJ,GACTnB,GAAc,EACViB,EAAOI,SAASlB,EAAc3I,KAAKyJ,EAAOI,UAC9B,SAAPF,IACTlB,GAAU,EACNgB,EAAOzK,WAAW4J,EAAU5I,KAAKyJ,EAAOzK,WAV3B,CAYrB,GACAqJ,EAAiBE,GAAWC,EACxBA,EAAaF,EAAiB,WACzBC,EAASD,EAAiB,OAC1BG,IAASH,EAAiB,SAoBjCQ,EAAkB,GAClBC,EAAgB,GACG,aAAnBT,GACFS,EAAgBF,EAAeF,GAC/BG,EAAkBC,EAAgB,UAAY,IAClB,SAAnBT,GACTS,EAAgBF,EAAeH,GAC/BI,EAAkBC,EAAgB,YAAc,IACpB,SAAnBT,IACTS,EAAgBF,EAAeD,GAC/BE,EAAkBC,EAAgB,YAAc,IAG5CC,EAAoBD,EAAgBe,GAAqBf,GAAiB,GAE1E1C,EAAS/V,EAAI,EAEO,YAAtBkU,GACIiC,GAASvC,EAAcA,EAAY9R,MAAQ,IAAIiN,cAAchB,OACnExF,QAAQyN,IAAI,eAAgBD,EAAQ,aAAc8B,EAAa,WAAY1B,GACvEA,GAAS0B,EAAY9I,cAAcC,SAASmH,KAC9C5N,QAAQyN,IAAI,eAAgB6B,GAC5BR,EAAQ3H,KAAK,CAAEqG,OAAAA,EAAQ8B,YAAAA,EAAaC,aAAAA,EAAcE,eAAAA,EAAgBD,eAAAA,EAAgBS,gBAAAA,EAAiBE,kBAAAA,MAEtE,WAAtBxE,IACT3L,QAAQyN,IAAI,eAAgBD,EAAQ,aAAc8B,EAAa,YAAaE,GACxEA,GACFV,EAAQ3H,KAAK,CAAEqG,OAAAA,EAAQ8B,YAAAA,EAAaC,aAAAA,EAAcE,eAAAA,EAAgBD,eAAAA,EAAgBS,gBAAAA,EAAiBE,kBAAAA,KAEtG,cAAAC,EAAAnX,EAAA,KAAA+V,EAAA,GAtFMvX,EAAI,EAAC,YAAEA,EAAI8M,EAAO/M,QAAM,CAAA4X,EAAA/W,EAAA,eAAA+W,EAAAlW,EAAA2O,EAAAmH,KAAA,cAAAI,EAAApW,EAAA,CAAAoW,EAAA/W,EAAA,eAAA+W,EAAAnW,EAAA,YAAExB,IAAG2X,EAAA/W,EAAA,eAyFhC4W,EAAYF,EACZG,EAAkC,YAAtBvD,EAAkC,UAAY,eAC1DwD,GAAY9D,EAAcA,EAAY9R,MAAQ,IAAIiM,OACxDxF,QAAQyN,IAAI,yBAA0ByB,EAAW,gBAAiBD,EAAW,WAAYH,EAAQtX,OAAQ,SAAU2X,GAC5F,IAAnBL,EAAQtX,OACVgU,EAAc7O,UAAY,kDAE1B6O,EAAc7O,UAAYmS,EAAQtG,IAAI,SAAArQ,GACpC,IAAM+Y,EAAmC,aAArB/Y,EAAEsX,eAClB,yDACqB,SAArBtX,EAAEsX,eACF,+CACqB,SAArBtX,EAAEsX,eACF,8CACA,GAEE0B,EAAYhZ,EAAE8X,iBAAmB9X,EAAEgY,kBAAiB,MAAAtK,OAChD1N,EAAE8X,gBAAe,KAAApK,OAAIvJ,EAAWnE,EAAEgY,oBACxC,GAEJ,MAAO,6CAAPtK,OAAoD1N,EAAEqV,OAAM,2CAAA3H,OACnCvJ,EAAWnE,EAAEmX,aAAe,cAAYzJ,OAAGqL,EAAW,gDAAArL,OACrD1N,EAAEqV,OAAM,OAAA3H,OAAMvJ,EAAWnE,EAAEoX,cAAgB,gBAAc1J,OAAGsL,EAAQ,6BAEhG,GAAGxI,KAAK,IAGR6C,EAAcnQ,iBAAiB,uBAAuBwB,QAAQ,SAAA4L,GAC5DA,EAAK5K,iBAAiB,QAAOnD,EAAAX,IAAA/D,EAAE,SAAAob,IAAA,IAAA5D,EAAA,OAAAzT,IAAAC,EAAA,SAAAqX,GAAA,cAAAA,EAAAhZ,GAAA,OAC6B,OAApDmV,EAAS3E,SAASJ,EAAKyD,aAAa,YAAa,IAAGmF,EAAAhZ,EAAA,EACpDiW,GAAiBd,GAAO,OAC9BhC,EAAcxP,UAAUC,OAAO,WAAW,cAAAoV,EAAApY,EAAA,KAAAmY,EAAA,IAE9C,IACD,cAAAhC,EAAAnW,EAAA,KAAA2V,EAAA,IACF,gBAAA0C,GAAA,OAAA3C,EAAA/T,MAAA,KAAAD,UAAA,EAnJc,IAmJb,OAAA+T,EAAArW,EAAA,eAAAqW,EAAA7W,EAAA,EAAA4W,EAAAC,EAAA1V,EAEFgH,QAAQC,MAAM,gBAAewO,GAC7BjD,EAAc7O,UAAY,6CAA6C,cAAA+R,EAAAzV,EAAA,KAAAuV,EAAA,iBAE1ED,GAAA3T,MAAA,KAAAD,UAAA,UAEc2T,GAAgBiD,GAAA,OAAAC,GAAA5W,MAAC,KAADD,UAAA,CAc/B,SAAA6W,KAFC,OAEDA,GAAA9W,EAAAX,IAAA/D,EAdA,SAAAyb,EAAgCjE,GAAM,OAAAzT,IAAAC,EAAA,SAAA0X,GAAA,cAAAA,EAAArZ,GAAA,cAAAqZ,EAAArZ,EAAA,EAC9BwJ,MAAMC,IAAG,eAAA6P,EAAAjX,EAAAX,IAAA/D,EAAC,SAAA4b,EAAO3P,GAAO,IAAAC,EAAA,OAAAnI,IAAAC,EAAA,SAAA6X,GAAA,cAAAA,EAAAxZ,GAAA,OAET,OADb6J,EAAQD,EAAQ+B,SAASC,WAAWC,oBAAoB,sBACxDC,KAAK,QAAQ0N,EAAAxZ,EAAA,EACb4J,EAAQmC,OAAM,WAChBlC,EAAMmC,aAAc,CAAFwN,EAAAxZ,EAAA,eAAAwZ,EAAA5Y,EAAA,UAGD,OADDiJ,EAAMoC,SAAS,IAADuB,OAAK2H,IAC3BsE,SAASD,EAAAxZ,EAAA,EACf4J,EAAQmC,OAAM,cAAAyN,EAAA5Y,EAAA,KAAA2Y,EAAA,IACrB,gBAAAG,GAAA,OAAAJ,EAAA/W,MAAA,KAAAD,UAAA,EATc,IASb,cAAA+W,EAAArZ,EAAA,EACIgI,KAAmB,cAAAqR,EAAAzY,EAAA,KAAAwY,EAAA,IAC1BD,GAAA5W,MAAA,KAAAD,UAAA,UAGcqX,GAAeC,GAAA,OAAAC,GAAAtX,MAAC,KAADD,UAAA,CA2C9B,SAAAuX,KALC,OAKDA,GAAAxX,EAAAX,IAAA/D,EA3CA,SAAAmc,EAA+B7C,GAAW,OAAAvV,IAAAC,EAAA,SAAAoY,GAAA,cAAAA,EAAA/Z,GAAA,UACnCiX,EAAa,CAAF8C,EAAA/Z,EAAA,eAAA+Z,EAAAnZ,EAAA,EAAS,MAAI,cAAAmZ,EAAAnZ,EAAA,EAEtB4I,MAAMC,IAAG,eAAAuQ,EAAA3X,EAAAX,IAAA/D,EAAC,SAAAsc,EAAOrQ,GAAO,IAAAC,EAAAqQ,EAAAhO,EAAAiO,EAAA/a,EAAAiN,EAAA+N,EAAAzN,EAAA,OAAAjL,IAAAC,EAAA,SAAA0Y,GAAA,cAAAA,EAAAra,GAAA,OAEV,OADb6J,EAAQD,EAAQ+B,SAASC,WAAWC,oBAAoB,sBACxDC,KAAK,QAAQuO,EAAAra,EAAA,EACb4J,EAAQmC,OAAM,WAChBlC,EAAMmC,aAAc,CAAFqO,EAAAra,EAAA,eAAAqa,EAAAzZ,EAAA,EAAS,MAAI,OAGV,OADnBsZ,EAAYrQ,EAAMyQ,gBACdxO,KAAK,UAAUuO,EAAAra,EAAA,EACnB4J,EAAQmC,OAAM,OAKpB,IAHMG,EAASgO,EAAUhO,QAAU,GAC/BiO,EAAc,KAET/a,EAAI,EAAGA,EAAI8M,EAAO/M,OAAQC,IAC3BiN,EAAMH,EAAO9M,GACbgb,EAAa/N,EAAI,GAAKhI,OAAOgI,EAAI,IAAIc,OAAOgB,cAAgB,GAC5DxB,EAAcN,EAAI,GAAKhI,OAAOgI,EAAI,IAAIc,OAAS,GAEjDiN,IAAenD,EAAY9I,eAAiBxB,GAEhCA,EAAYoB,MAAM,SAASV,OAAOW,SAC1CxJ,QAAQ,SAAAyJ,GACZ,IAAMC,EAAQD,EAAKE,cACnB,GAAKD,EAAME,SAAS,QAAUF,EAAME,SAAS,UAAY,CAEvD,IAAMC,EAAiBJ,EAAKK,MAAM,uDAC9BD,IACF8L,EAAc9L,EAAe,GAEjC,CACF,GAEH,OAAAgM,EAAAzZ,EAAA,EACMuZ,GAAW,EAAAF,EAAA,IACnB,gBAAAM,GAAA,OAAAP,EAAAzX,MAAA,KAAAD,UAAA,EAlCe,KAkCd,EAAAwX,EAAA,IACHD,GAAAtX,MAAA,KAAAD,UAAA,CAMD,SAASsW,GAAqB3G,GAC5B,IAAKA,EAAS,MAAO,GAGrB,IAAMuI,EAAWnW,OAAO4N,GAAS3D,MAAM,6BACvC,GAAIkM,EAAU,CAEZ,IAAMzH,EAAOvC,SAASgK,EAAS,GAAI,IAC7B3J,EAAQL,SAASgK,EAAS,GAAI,IAAM,EACpCtI,EAAM1B,SAASgK,EAAS,GAAI,IAElC,MAAO,GAAPhN,OAAU0E,EAAG,KAAA1E,OADE,CAAC,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,OAC1DqD,GAAM,KAAArD,OAAIuF,EACpC,CAGA,IAAMlS,EAAI,IAAIiE,KAAKmN,GACnB,GAAIlN,MAAMlE,EAAEmE,WAAY,MAAO,GAC/B,IACMkN,EAAMrR,EAAEuL,UACRyE,EAFS,CAAC,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,OAE7DhQ,EAAE6M,YACjBqF,EAAOlS,EAAE4M,cACf,MAAO,GAAPD,OAAU0E,EAAG,KAAA1E,OAAIqD,EAAK,KAAArD,OAAIuF,EAC5B,CApRIC,IACFA,EAAYxN,iBAAiB,QAAS,SAACxH,GACrC,GAA0B,YAAtBsV,EAAJ,CACAmH,aAAahG,GACb,IAAMiG,EAAM1c,EAAE2c,OAAOzZ,MAAMiM,OACvBuN,EAAIvb,OAAS,EACfkV,KAIFI,EAAsB/Q,WAAW,WAC/B4R,GAAiBoF,EACnB,EAAG,IAVwC,CAW7C,GAEA1H,EAAYxN,iBAAiB,QAAOnD,EAAAX,IAAA/D,EAAE,SAAAid,IAAA,OAAAlZ,IAAAC,EAAA,SAAAkZ,GAAA,cAAAA,EAAA7a,GAAA,UACV,YAAtBsT,EAA+B,CAAAuH,EAAA7a,EAAA,eAAA6a,EAAA7a,EAAA,EAC3B0U,KAAiB,OACnB1B,EAAY9R,MAAMiM,OAAOhO,QAAU,GACrCmW,GAAiBtC,EAAY9R,MAAMiM,QACpC,cAAA0N,EAAAja,EAAA,KAAAga,EAAA,KAIL5H,EAAYxN,iBAAiB,OAAQ,WAEnC9B,WAAW2Q,GAAkB,IAC/B,IAIFb,IAwPA,IAAMsH,GAAqBlC,GAG3B,SAASmC,KACP,OAAOlY,EAAI,4CAA4CsN,IAAI,SAAA6K,GAAE,OAAIA,EAAG9Z,KAAK,EAC3E,CAGA,SAAS+Z,KACP,IAAMD,EAAKtY,EAAG,wDACd,OAAOsY,GAAMA,EAAGE,OAClB,CAEA,SAASC,GAAYzM,GAEnB,MAAiB,cAAbA,EACKhM,EAAG,kBAEL0D,EAAqBA,EAAmBxD,cAAc,yBAAD4K,OAA0BkB,EAAQ,OAAQ,IACxG,CAEA,SAAS0M,GAAmB3W,GAC1B,IAAKA,EAAM,MAAO,GAClB,IAAMuL,EAAYvL,EAAK7B,cAAc,8BACrC,OAAOoN,EAAYlN,MAAMC,KAAKiN,EAAUhN,iBAAiB,UAAY,EACvE,CAEA,SAASqY,GAAc5W,EAAMiW,GACbU,GAAmB3W,GAC3BD,QAAQ,SAAArE,GACZA,EAAEwD,UAAUK,OAAO,SAAU7D,EAAE0T,aAAa,gBAAgB6G,EAC9D,EACF,CAEA,SAASY,GAAc7W,GACrB,IACMoJ,EADQuN,GAAmB3W,GACZ8W,KAAK,SAAApb,GAAC,OAAEA,EAAEwD,UAAU6X,SAAS,SAAS,GAC3D,OAAO3N,EAASA,EAAOgG,aAAa,cAAgB,OACtD,CAgBA,SAAS4H,KACP,GAAKtV,GAAeC,EAApB,CACA,IAAMsV,EAAUT,KACVU,EAAYjZ,EAAG,kBAEfkZ,EADqBb,KACoBc,KAAK,SAAA1b,GAAC,MAAU,eAANA,CAAkB,GAIzEgG,EAAWa,MAAMC,QADf2U,EACyB,GAEA,OAI7B,IAAME,EAAW,IAAIC,IAAIC,MACNnZ,EAAI,yBACZ2B,QAAQ,SAAAC,GACjB,IAAM6M,EAAO7M,EAAKoP,aAAa,aAC/BpP,EAAKuC,MAAMC,QAAU6U,EAASG,IAAI3K,GAAQ,GAAK,MACjD,GAGIqK,IACFA,EAAU3U,MAAMC,QAAUyU,EAAU,GAAK,OAvBG,CAyBhD,CAGA,SAASQ,KACP,GAAKjW,EAAL,CACA,IAAMkW,EAAapB,KAAwB1N,OAAO,SAAAlN,GAAC,MAAU,eAANA,CAAkB,GAC/C,IAAtBgc,EAAWhd,OACb8G,EAAYwN,YAAc,+BACK,IAAtB0I,EAAWhd,OACpB8G,EAAYwN,YAAc,2BAA6B0I,EAAW,GAElElW,EAAYwN,YAAc,gCAPJ,CAS1B,CAUA,SAASuI,KACP,OAAOnZ,EAAI,wCAAwCsN,IAAI,SAAA6K,GAAE,OAAIA,EAAG9Z,KAAK,EACvE,CAGA,SAASkb,GAAuBC,GAC9B,IAAMrM,EAAYtN,EAAG2Z,GACrB,GAAKrM,EAAL,CAGA,IAAML,EAAQ7M,MAAMC,KAAKiN,EAAUsM,UACnC,GAAqB,IAAjB3M,EAAMxQ,OAAV,CAGA,IAAM+b,EAAU,GACVqB,EAAY,GAClB5M,EAAMnL,QAAQ,SAAA4L,GACZ,IAAM4K,EAAK5K,EAAKxN,cAAc,yBAA2BwN,EAAKxN,cAAc,0BACxEoY,GAAMA,EAAGE,QACXA,EAAQpM,KAAKsB,GAEbmM,EAAUzN,KAAKsB,EAEnB,GAGA,GAAA5C,OAAI0N,EAAYqB,GAAW/X,QAAQ,SAAA4L,GAAI,OAAIJ,EAAUwM,YAAYpM,EAAK,EAfxC,CAJR,CAoBxB,CAAC,SAEcqM,KAAe,OAAAC,GAAAna,MAAC,KAADD,UAAA,UAAAoa,KAuD7B,OAvD6BA,GAAAra,EAAAX,IAAA/D,EAA9B,SAAAgf,IAAA,IAAAC,EAAA,OAAAlb,IAAAC,EAAA,SAAAkb,GAAA,cAAAA,EAAA7c,GAAA,WACMiD,EAAmB,CAAF4Z,EAAA7c,EAAA,eAAA6c,EAAAjc,EAAA,UAEO,GAD5BqC,GAAoB,EACd2Z,EAAMla,EAAG,cACL,CAAFma,EAAA7c,EAAA,eAAA6c,EAAAjc,EAAA,aAEwB,MAA5Bgc,EAAIrU,QAAQuU,YAAmB,CAAAD,EAAA7c,EAAA,eAAA6c,EAAAjc,EAAA,UAIlB,OADjBgc,EAAIrU,QAAQuU,YAAc,IAC1BF,EAAItY,UAAU,GAAGuY,EAAA7c,EAAA,EAEXwJ,MAAMC,IAAG,eAAAsT,EAAA1a,EAAAX,IAAA/D,EAAC,SAAAqf,EAAOpT,GAAO,IAAAC,EAAAqQ,EAAAhO,EAAA+Q,EAAAC,EAAAC,EAAA,OAAAzb,IAAAC,EAAA,SAAAyb,GAAA,cAAAA,EAAApd,GAAA,OAET,OADb6J,EAAQD,EAAQ+B,SAASC,WAAWC,oBAAoB,iBACxDC,KAAK,QAAQsR,EAAApd,EAAA,EACb4J,EAAQmC,OAAM,WAChBlC,EAAMmC,aAAc,CAAFoR,EAAApd,EAAA,QAC0B,OAA9C2H,QAAQC,MAAM,gCAAgCwV,EAAAxc,EAAA,UAMvB,OADnBsZ,EAAYrQ,EAAMyQ,gBACdxO,KAAK,UAAUsR,EAAApd,EAAA,EACnB4J,EAAQmC,OAAM,OAEdG,EAASgO,EAAUhO,QAAU,GAC7B+Q,EAAW/Q,EAAOgE,MAAM,GAC3BC,IAAI,SAAA9D,GAAG,OAAIA,EAAI,EAAE,GACjBgB,OAAO,SAAArN,GAAC,OAAIA,GAAKqE,OAAOrE,GAAGmN,OAAOhO,OAAS,CAAC,GAC5CgR,IAAI,SAAAnQ,GAAC,OAAIqE,OAAOrE,GAAGmN,MAAM,GAEtB+P,EAAQpa,MAAMC,KAAK,IAAIgZ,IAAIkB,IACjCtV,QAAQyN,IAAI,qCAAsC8H,GAElDA,EAAM1Y,QAAQ,SAAAxE,GACZ,IAAM2B,EAAI/C,SAASwF,cAAc,OACjCzC,EAAE2C,UAAY,wCAAHkJ,OAA2CxN,EAAC,OAAAwN,OAAMxN,EAAC,YAC9D4c,EAAIJ,YAAY7a,EAClB,GAEIiE,IACFA,EAAatB,UAAY,IACnB6Y,EAAUve,SAASwF,cAAc,WAC/BlD,MAAQ,GAChBic,EAAQ3Z,YAAc,SACtBoC,EAAa4W,YAAYW,GACzBD,EAAM1Y,QAAQ,SAAAxE,GACZ,IAAMqd,EAAMze,SAASwF,cAAc,UACnCiZ,EAAInc,MAAQlB,EACZqd,EAAI7Z,YAAcxD,EAClB4F,EAAa4W,YAAYa,EAC3B,IACD,cAAAD,EAAAxc,EAAA,KAAAoc,EAAA,IACF,gBAAAM,GAAA,OAAAP,EAAAxa,MAAA,KAAAD,UAAA,EA1Cc,IA0Cb,cAAAua,EAAAjc,EAAA,KAAA+b,EAAA,IACHD,GAAAna,MAAA,KAAAD,UAAA,CAED,SAASib,KACP,OAAOza,MAAMC,KAAKnE,SAASoE,iBAAiB,4CAA4CmN,IAAI,SAAA/Q,GAAC,OAAEA,EAAE8B,KAAK,EACxG,CAGA,SAASsc,KACP,IAAMC,EAAoBF,KACR1a,EAAI,yBAEZ2B,QAAQ,SAAAkZ,GAChB,IAAMC,EAAeD,EAASxc,MAC9Bwc,EAASpZ,UAAY,GAGrB,IAAMsZ,EAAWhf,SAASwF,cAAc,UACxCwZ,EAAS1c,MAAQ,GACjB0c,EAASpa,YAAc,oBACvBka,EAASlB,YAAYoB,GAGrBH,EAAkBjZ,QAAQ,SAAA8M,GACxB,IAAM+L,EAAMze,SAASwF,cAAc,UACnCiZ,EAAInc,MAAQoQ,EACZ+L,EAAI7Z,YAAc8N,EAClBoM,EAASlB,YAAYa,EACvB,GAGiC,IAA7BI,EAAkBte,OACpBue,EAASxc,MAAQuc,EAAkB,GAC1BA,EAAkBrP,SAASuP,KAEpCD,EAASxc,MAAQyc,EAErB,EACF,CAsBA,SAASnF,GAAcqF,GAErB,IAAKA,EAAK,OAAO,KAGjB,IAAMC,EAAa,wEAAwEC,KAAKF,GAChG,IAAKC,EAAY,OAAO,KAExB,IAAM9L,EAAS,CACbV,KAAMwM,EAAW,GAAG3Q,OACpBuL,OAAQoF,EAAW,GACnBnP,SAAUmP,EAAW,GAAG3Q,OACxB6Q,QAAS,GACTC,SAAU,GACV3O,UAAW,GACXqJ,QAAS,GACT7K,UAAW,GACXjJ,SAAU,IAINqZ,EAAe,6BAA6BH,KAAKF,GACnDK,IAAclM,EAAOgM,QAAUE,EAAa,GAAG/Q,QAEnD,IAAMgR,EAAc,gCAAgCJ,KAAKF,GACrDM,IAAanM,EAAOiM,SAAWE,EAAY,GAAGhR,QAElD,IAAM+B,EAAiB,oCAAoC6O,KAAKF,GAC5D3O,IAAgB8C,EAAO1C,UAAYJ,EAAe,GAAG/B,QAEzD,IAAMgC,EAAe,oCAAoC4O,KAAKF,GAC1D1O,IAAc6C,EAAO2G,QAAUxJ,EAAa,GAAGhC,QAEnD,IAAMkB,EAAiB,+BAA+B0P,KAAKF,GACvDxP,IAAgB2D,EAAOlE,UAAYO,EAAe,GAAGlB,QAEzD,IAAMyB,EAAgB,8BAA8BmP,KAAKF,GAGzD,OAFIjP,IAAeoD,EAAOnN,SAAW+J,EAAc,GAAGzB,QAE/C6E,CACT,CAEA,SAASoM,GAAiBzd,GACxB,IAAM0d,EAAQ,GACR3F,EAAS/X,EAAE+X,QAAU,QAW3B,OATA2F,EAAMvP,KAAK,GAADtB,OAAI7M,EAAE2Q,KAAI,MAAA9D,OAAKkL,IACzB2F,EAAMvP,KAAK,eAADtB,OAAgB7M,EAAE2d,YACxB3d,EAAEqd,SAASK,EAAMvP,KAAK,YAADtB,OAAa7M,EAAEqd,UACpCrd,EAAEsd,UAAUI,EAAMvP,KAAK,eAADtB,OAAgB7M,EAAEsd,WAExCtd,EAAE2O,WAAW+O,EAAMvP,KAAK,mBAADtB,OAAoB7M,EAAE2O,YAC7C3O,EAAEgY,SAAS0F,EAAMvP,KAAK,mBAADtB,OAAoB7M,EAAEgY,UAC3ChY,EAAEmN,WAAWuQ,EAAMvP,KAAK,cAADtB,OAAe7M,EAAEmN,YACxCnN,EAAEkE,UAAUwZ,EAAMvP,KAAK,aAADtB,OAAc7M,EAAEkE,WACnCwZ,EAAM/N,KAAK,OACpB,CAAC,SAEctI,KAAiB,OAAAuW,GAAAhc,MAAC,KAADD,UAAA,UAAAic,KAuT/B,OAvT+BA,GAAAlc,EAAAX,IAAA/D,EAAhC,SAAA6gB,IAAA,OAAA9c,IAAAC,EAAA,SAAA8c,GAAA,cAAAA,EAAAze,GAAA,cAAAye,EAAAze,EAAA,EACQyc,KAAiB,cAAAgC,EAAAze,EAAA,EACjBwJ,MAAMC,IAAG,eAAAiV,EAAArc,EAAAX,IAAA/D,EAAC,SAAAghB,EAAO/U,GAAO,IAAAgV,EAAAC,EAAAhV,EAAAiV,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAApD,EAAAqD,EAAAC,EAAAC,EAAAC,EAoEnBC,EAAWC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA9gB,EAAA+gB,EAAAC,EAAAzE,EAAA9b,EAAAwgB,EAAAC,EAAAC,EAAAC,EAAAC,EAAApC,EAAAqC,EAAAC,EAAA,OAAAjf,IAAAC,EAAC,SAADif,GAAA,cAAAA,EAAA5gB,GAAA,OAjEW,OAiEtB4f,EAAW,SAACjf,GACnB,GAAS,MAALA,GAAmB,KAANA,EAAU,MAAO,GAGlC,GAAiB,iBAANA,EAAgB,CAEzB,IAAMoR,EAAa,IAAIjN,KAAK,KAAM,GAAI,IAChCjE,EAAI,IAAIiE,KAAKiN,EAAW/M,UAAgB,MAAJrE,GACpCwX,EAAOtX,EAAE4M,cACT2K,EAAK/T,OAAOxD,EAAE6M,WAAa,GAAGC,SAAS,EAAE,KACzC0K,EAAKhU,OAAOxD,EAAEuL,WAAWuB,SAAS,EAAE,KAC1C,MAAO,GAAPH,OAAU2K,EAAI,KAAA3K,OAAI4K,EAAE,KAAA5K,OAAI6K,EAC1B,CAGA,GAAI1X,aAAamE,KAAM,CACrB,IAAMqT,EAAOxX,EAAE8M,cACT2K,EAAK/T,OAAO1D,EAAE+M,WAAa,GAAGC,SAAS,EAAE,KACzC0K,EAAKhU,OAAO1D,EAAEyL,WAAWuB,SAAS,EAAE,KAC1C,MAAO,GAAPH,OAAU2K,EAAI,KAAA3K,OAAI4K,EAAE,KAAA5K,OAAI6K,EAC1B,CAGA,IAAM1V,EAAI0B,OAAO1D,GAAGwM,OACd0T,EAAYle,EAAE2L,MAAM,0EAC1B,GAAIuS,EAAW,CACb,IACM3O,EAAM1B,SAASqQ,EAAU,GAAI,IAC7BC,EAFS,CAAC3O,IAAI,EAAEC,IAAI,EAAEC,IAAI,EAAEC,IAAI,EAAEC,IAAI,EAAEC,IAAI,EAAEC,IAAI,EAAEC,IAAI,EAAEC,IAAI,EAAEC,IAAI,EAAEC,IAAI,GAAGC,IAAI,IAEpE+N,EAAU,GAAG1S,eAC1B4E,EAAOvC,SAASqQ,EAAU,GAAI,IAC9BxI,EAAKhU,OAAO6N,GAAKvE,SAAS,EAAE,KAC5ByK,EAAK/T,OAAOyc,EAAM,GAAGnT,SAAS,EAAE,KACtC,MAAO,GAAPH,OAAUuF,EAAI,KAAAvF,OAAI4K,EAAE,KAAA5K,OAAI6K,EAC1B,CAGA,IAAMxX,EAAI,IAAIiE,KAAKnE,GACnB,IAAKoE,MAAMlE,EAAEmE,WAAY,CACvB,IAAMmT,EAAOtX,EAAE4M,cACT2K,EAAK/T,OAAOxD,EAAE6M,WAAa,GAAGC,SAAS,EAAE,KACzC0K,EAAKhU,OAAOxD,EAAEuL,WAAWuB,SAAS,EAAE,KAC1C,MAAO,GAAPH,OAAU2K,EAAI,KAAA3K,OAAI4K,EAAE,KAAA5K,OAAI6K,EAC1B,CAGA,OAAO1V,EAAExD,QAAU,GAAKwD,EAAEuN,MAAM,EAAE,IAAM,EAC1C,GAhHM0O,EAAgBhV,EAAQ+B,SAASoV,oBACzBjV,KAAK,YAAY8U,EAAA5gB,EAAA,EACzB4J,EAAQmC,OAAM,OAID,OAHb8S,EAAQD,EAAcoC,SAAW,GAEjCnX,EAAQD,EAAQ+B,SAASC,WAAWC,oBAAoB,sBACxDC,KAAK,QAAQ8U,EAAA5gB,EAAA,EACb4J,EAAQmC,OAAM,WAChBlC,EAAMmC,aAAc,CAAF4U,EAAA5gB,EAAA,eAAA4gB,EAAAhgB,EAAA,UAkBA,OAfhBke,EAAejV,EAAMoC,SAAS,IAADuB,OAAKqR,IAClCE,EAAYlV,EAAMoC,SAAS,IAADuB,OAAKqR,IAC/BG,EAAiBnV,EAAMoC,SAAS,IAADuB,OAAKqR,IACpCI,EAAcpV,EAAMoC,SAAS,IAADuB,OAAKqR,IACjCK,EAAarV,EAAMoC,SAAS,IAADuB,OAAKqR,EAAK,MAAArR,OAAKqR,IAC1CM,EAAStV,EAAMoC,SAAS,IAADuB,OAAKqR,IAC5BO,EAASvV,EAAMoC,SAAS,IAADuB,OAAKqR,IAC5BQ,EAASxV,EAAMoC,SAAS,IAADuB,OAAKqR,IAClCC,EAAahT,KAAK,UAClBiT,EAAUjT,KAAK,UACfkT,EAAelT,KAAK,UACpBmT,EAAYnT,KAAK,UACjBoT,EAAWpT,KAAK,UAChBqT,EAAOrT,KAAK,UACZsT,EAAOtT,KAAK,UACZuT,EAAOvT,KAAK,UAAU8U,EAAA5gB,EAAA,EAChB4J,EAAQmC,OAAM,OAoHpB,IAjHMuT,EAAcR,EAAa5S,QAAU4S,EAAa5S,OAAO,IAAM4S,EAAa5S,OAAO,GAAG,GACxF7H,OAAOya,EAAa5S,OAAO,GAAG,IAC9B,GACAvG,IAAkBA,EAAiBzE,MAAQoe,GAEzCC,EAAWR,EAAU7S,QAAU6S,EAAU7S,OAAO,IAAM6S,EAAU7S,OAAO,GAAG,GAC5E7H,OAAO0a,EAAU7S,OAAO,GAAG,IAC3B,GAEEiQ,EAAaoD,EAAQxR,MAAM,KAAKoC,IAAI,SAAAxN,GAAC,OAAIA,EAAEwK,MAAM,GAAEE,OAAOW,SAEhEnL,EAAI,oCAAoC2B,QAAQ,SAAAwW,GAC9C,IAAM1M,EAAQ6N,EAAWN,KAAK,SAAAoF,GAAG,OAAIA,EAAI9S,gBAAkB6M,EAAG9Z,MAAMiN,aAAa,GACjF6M,EAAGE,QAAU5M,CACf,GAEMkR,EAAaP,EAAY/S,QAAU+S,EAAY/S,OAAO,IAAM+S,EAAY/S,OAAO,GAAG,GACpF7H,OAAO4a,EAAY/S,OAAO,GAAG,IAC7B,GAEAtG,IACFA,EAAa1E,MAAQse,GAIjBC,EAAgBT,EAAe9S,QAAU8S,EAAe9S,OAAO,IAAM8S,EAAe9S,OAAO,GAAG,GAChG7H,OAAO2a,EAAe9S,OAAO,GAAG,IAChC,GACEwT,EAAgBD,EAAa1R,MAAM,SAASoC,IAAI,SAAAxN,GAAC,OAAIA,EAAEwK,OAAOgB,aAAa,GAAEd,OAAOW,SAC1FrG,QAAQyN,IAAI,2BAA4BsK,GACxC9gB,SAASoE,iBAAiB,mCAAmCwB,QAAQ,SAAAwW,GACnEA,EAAGE,QAAUwE,EAActR,SAAS4M,EAAG9Z,MAAMiN,cAC/C,GAEMwR,EAAYT,EAAWhT,QAAUgT,EAAWhT,OAAO,GAAMgT,EAAWhT,OAAO,GAAK,CAAC,KAAM,KAAM,MAkDnGvE,QAAQyN,IAAI,0BAA2BuK,GACnC9Z,IAAqBA,EAAoB3E,MAAQ0e,EAAYD,EAAS,KACtE7Z,IAAiBA,EAAgB5E,MAAQ0e,EAAYD,EAAS,KAC9D5Z,IAAqBA,EAAoB7E,MAAQ0e,EAAYD,EAAS,KAC1EhY,QAAQyN,IAAI,gBAAiBvP,aAAmB,EAAnBA,EAAqB3E,MAAO4E,aAAe,EAAfA,EAAiB5E,MAAO6E,aAAmB,EAAnBA,EAAqB7E,OAGhG2e,EAAWT,EAAOlT,QAAUkT,EAAOlT,OAAO,IAAMkT,EAAOlT,OAAO,GAAG,GACnE7H,OAAO+a,EAAOlT,OAAO,GAAG,IACxB,GACAlG,IAAkBA,EAAiB9E,MAAQ2e,GAGzCC,EAAWT,EAAOnT,QAAUmT,EAAOnT,OAAO,IAAMmT,EAAOnT,OAAO,GAAG,GACnE7H,OAAOgb,EAAOnT,OAAO,GAAG,IACxB,GACAjG,IAAaA,EAAY/E,MAAQ4e,GAE/BC,EAAWZ,EAAOjT,QAAUiT,EAAOjT,OAAO,IAAMiT,EAAOjT,OAAO,GAAG,GACnE7H,OAAO8a,EAAOjT,OAAO,GAAG,IACxB,GAGE8T,EAAQD,EACXhS,MAAM,SACNoC,IAAI,SAAAxN,GAAC,OAAIA,EAAEwK,MAAM,GACjBE,OAAOW,SACJiS,EAAc,GACdC,EAAe,GACZ9gB,EAAI,EAAGA,EAAI4gB,EAAM7gB,OAAQC,KAC1B+gB,EAAO3H,GAAcwH,EAAM5gB,KAE/B6gB,EAAYnR,KAAKqR,GAEjBD,EAAapR,KAAKkR,EAAM5gB,IAKtBghB,EAAiB,CAAE,QAAS,EAAG,cAAe,EAAG,KAAQ,GAC/DH,EAAY1P,KAAK,SAAC3P,EAAGnB,GAGnB,OAFkB2gB,GAAgBxf,EAAE8X,QAAU,IAAIvK,gBAAkB,IAClDiS,GAAgB3gB,EAAEiZ,QAAU,IAAIvK,gBAAkB,EAEtE,GAKAxG,QAAQyN,IAAI,gBAAiB6K,GAG7BzC,KAGA3a,EAAI,gCAAgC2B,QAAQ,SAAAwW,GAAQA,EAAGE,SAAU,CAAO,GACxErY,EAAI,yCAAyC2B,QAAQ,SAAAC,GAC/B2W,GAAmB3W,GAC3BD,QAAQ,SAAArE,GAAC,OAAIA,EAAEwD,UAAUC,OAAO,SAAS,GACrD,IAAM0c,EAAY7b,EAAK7B,cAAc,yBAC/B2d,EAAa9b,EAAK7B,cAAc,0BAChCse,EAAazc,EAAK7B,cAAc,0BAChC4d,EAAiB/b,EAAK7B,cAAc,+BACtC0d,IAAWA,EAAUpf,MAAQ,IAC7Bqf,IAAYA,EAAWrf,MAAQ,IAC/BggB,IAAYA,EAAWhgB,MAAQ,IAC/Bsf,IAAgBA,EAAetf,MAAQ,GAC7C,GAEgB+Z,MAGRU,EAAYR,GAAY,gBAEtBtb,EAAIogB,EAAY,IAAM,KACxB5Z,IAAeA,EAAcnF,MAAQrB,GAAKA,EAAEyR,KAAOzR,EAAEyR,KAAO,IAC5DzR,IACIwgB,GAASxgB,EAAE6Y,QAAU,IAAIvK,cAI/BkN,GAAcM,EAHkB,gBAAV0E,EAA0B,cAClC,SAAVA,EAAmB,OACnB,SAEEC,EAAY3E,EAAU/Y,cAAc,yBACpC2d,EAAa5E,EAAU/Y,cAAc,0BACrC4d,EAAiB7E,EAAU/Y,cAAc,+BAC3C0d,IAAWA,EAAUpf,MAAQrB,EAAEme,SAAW,IAC1CuC,IAAYA,EAAWrf,OAASrB,EAAEgF,UAAY,IAAIqL,MAAM,EAAE,KAE1DsQ,GAAkB3gB,EAAE8O,WACtB6R,EAAetf,MAAQrB,EAAE8O,SAASxB,UAMxBtK,EAAI,gCACZ2B,QAAQ,SAAAwW,GACd,IAAM1J,EAAO0J,EAAG9Z,MAEVrB,EAAIogB,EAAY1E,KAAK,SAAA4F,GACzB,IAAMC,GAAUD,EAAG7P,MAAQ,IAAInD,cACzBkT,EAAS/P,EAAKnD,cACpB,OAAIiT,IAAWC,GAEA,2BAAXA,GAAkD,mBAAXD,CAE7C,GACApG,EAAGE,UAAYrb,EACf,IAAM4E,EAAO0W,GAAY7J,GACzB,GAAI7M,GAAQ5E,EAAG,CACb,IAAMwgB,GAASxgB,EAAE6Y,QAAU,IAAIvK,cAI/BkN,GAAc5W,EAHkB,gBAAV4b,EAA0B,cAClC,SAAVA,EAAmB,OACnB,SAEJ,IAAMC,EAAY7b,EAAK7B,cAAc,yBAC/B2d,EAAa9b,EAAK7B,cAAc,0BAChCse,EAAazc,EAAK7B,cAAc,0BAChC4d,EAAiB/b,EAAK7B,cAAc,+BACtC0d,IAAWA,EAAUpf,MAAQrB,EAAEme,SAAW,IAC1CuC,IAAYA,EAAWrf,OAASrB,EAAEgF,UAAY,IAAIqL,MAAM,EAAE,KAC1DgR,IAAYA,EAAWhgB,MAAQrB,EAAEoe,UAAY,IAE7CuC,GAAkB3gB,EAAE8O,WACtB6R,EAAetf,MAAQrB,EAAE8O,SAASxB,OAEtC,CACF,GAIEjH,IACEua,EAAc,KACdR,EAAY9gB,OAAS,IACvBshB,EAAcR,EAAY,IAExBQ,GACIpC,EAAQ,GACVoC,EAAYnR,WAAW+O,EAAMvP,KAAK,mBAADtB,OAAoBiT,EAAYnR,YACjEmR,EAAY9H,SAAS0F,EAAMvP,KAAK,mBAADtB,OAAoBiT,EAAY9H,UAC/D8H,EAAY3S,WAAWuQ,EAAMvP,KAAK,cAADtB,OAAeiT,EAAY3S,YAChE5H,EAAY1C,YAAc6a,EAAM/N,KAAK,QAErCpK,EAAY1C,YAAc,KAKxBkd,EAAYhe,EAAG,kBACJ4c,GAEXqB,EAAmB,KACvBV,EAAYzb,QAAQ,SAAA3E,GACdA,EAAEyR,MAAQzR,EAAEyR,KAAKnD,cAAcC,SAAS,QACxCvO,EAAE6Y,QAAqC,SAA3B7Y,EAAE6Y,OAAOvK,eAA4BtO,EAAEiO,YACrD6S,EAAmB9gB,EAAEiO,UAEzB,GACI6S,EACFD,EAAUld,YAAcmd,EAGxBhH,GAAgB2F,GAAYld,KAAK,SAAAkf,GAC/BZ,EAAUld,YAAc8d,GAAQ,GAClC,IAEOZ,IACTA,EAAUld,YAAc,KAG1BiY,KACA8F,KACArF,KAGAE,GAAuB,cACvBA,GAAuB,mBACvBA,GAAuB,mBAGvB1V,EAAgBmY,EAGhBta,IAGAid,KAGIC,IACFA,GAAoB9d,UAAUC,OAAO,WACtC,cAAAgd,EAAAhgB,EAAA,KAAA+d,EAAA,IACF,gBAAA+C,GAAA,OAAAhD,EAAAnc,MAAA,KAAAD,UAAA,EApTc,IAoTb,cAAAmc,EAAA7d,EAAA,KAAA4d,EAAA,IACHD,GAAAhc,MAAA,KAAAD,UAAA,UAEcoF,KAAe,OAAAia,GAAApf,MAAC,KAADD,UAAA,CA6P9B,SAAAqf,KAFC,OAEDA,GAAAtf,EAAAX,IAAA/D,EA7PA,SAAAikB,IAAA,IAAArC,EAAAjB,EAAA5C,EAAA,OAAAha,IAAAC,EAAA,SAAAkgB,GAAA,cAAAA,EAAA7hB,GAAA,OAI6F,OAHrFuf,EAAUxE,KAAwBzK,KAAK,MACvCgO,EAAYf,KAAuBjN,KAAK,MACxCoL,EAAUT,KAChBtT,QAAQyN,IAAI,uBAAwBmK,EAAS,aAAcjB,EAAW,WAAY5C,GAASmG,EAAA7hB,EAAA,EACrFwJ,MAAMC,IAAG,eAAAqY,EAAAzf,EAAAX,IAAA/D,EAAC,SAAAokB,EAAOnY,GAAO,IAAAgV,EAAAC,EAAAhV,EAAAqV,EAAAJ,EAAAC,EAAAC,EAAAC,EAAAE,EAAAC,EAAAC,EAAAM,EAAAqC,EAAAhC,EAAAE,EAAA+B,EAAAC,EAAAC,EAAAC,EAAAzG,EAAArK,EAAAoH,EAAA4H,EAAAC,EAAAC,EAAA6B,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAvC,EAAAwC,EAAAC,EAAAC,EAAAC,EAAAxL,EAAAyL,EAAA,OAAAthB,IAAAC,EAAA,SAAAshB,GAAA,cAAAA,EAAAjjB,GAAA,OAGG,OADzB4e,EAAgBhV,EAAQ+B,SAASoV,oBACzBjV,KAAK,YAAYmX,EAAAjjB,EAAA,EACzB4J,EAAQmC,OAAM,OAID,OAHb8S,EAAQD,EAAcoC,SAAW,GAEjCnX,EAAQD,EAAQ+B,SAASC,WAAWC,oBAAoB,sBACxDC,KAAK,QAAQmX,EAAAjjB,EAAA,EACb4J,EAAQmC,OAAM,WAChBlC,EAAMmC,aAAc,CAAFiX,EAAAjjB,EAAA,eAAAijB,EAAAriB,EAAA,UAeA,OAZhBse,EAAarV,EAAMoC,SAAS,IAADuB,OAAKqR,EAAK,MAAArR,OAAKqR,KACrC/S,KAAK,UAGVgT,EAAejV,EAAMoC,SAAS,IAADuB,OAAKqR,IAClCE,EAAYlV,EAAMoC,SAAS,IAADuB,OAAKqR,IAC/BG,EAAiBnV,EAAMoC,SAAS,IAADuB,OAAKqR,IACpCI,EAAcpV,EAAMoC,SAAS,IAADuB,OAAKqR,IAEjCM,EAAStV,EAAMoC,SAAS,IAADuB,OAAKqR,IAC5BO,EAASvV,EAAMoC,SAAS,IAADuB,OAAKqR,IAC5BQ,EAASxV,EAAMoC,SAAS,IAADuB,OAAKqR,IAClCM,EAAOrT,KAAK,UAAUmX,EAAAjjB,EAAA,EAChB4J,EAAQmC,OAAM,OAuNnB,OArNK4T,EAAYT,EAAWhT,QAAUgT,EAAWhT,OAAO,GAAMgT,EAAWhT,OAAO,GAAK,CAAC,KAAK,KAAK,MAG7FrG,IAAqB8Z,EAAS,GAAK7E,GAAmBjV,EAAoB3E,QAC1E4E,IAAiB6Z,EAAS,GAAK7E,GAAmBhV,EAAgB5E,QAClE6E,IAAqB4Z,EAAS,GAAK7E,GAAmB/U,EAAoB7E,QAE9Ege,EAAWhT,OAAS,CAACyT,GAErBZ,EAAU7S,OAAS,CAAC,CAACqT,IAEjB3Z,IACFqZ,EAAY/S,OAAS,CAAC,CAACtG,EAAa1E,OAAS,MAG3CyE,IACFmZ,EAAa5S,OAAS,CAAC,CAACvG,EAAiBzE,OAAS,MAIpD8d,EAAe9S,OAAS,CAAC,CAACoS,IAC1B3W,QAAQyN,IAAI,gCAAiCkJ,GAGzCtY,IACFoZ,EAAOlT,OAAS,CAAC,CAAClG,EAAiB9E,OAAS,MAE1C+E,IACFoZ,EAAOnT,OAAS,CAAC,CAACjG,EAAY/E,OAAS,MAGnC8gB,EAAY7C,EAAOjT,QAAUiT,EAAOjT,OAAO,IAAMiT,EAAOjT,OAAO,GAAG,GACpE7H,OAAO8a,EAAOjT,OAAO,GAAG,IACxB,GAEE8T,EAAQgC,EACXjU,MAAM,SACNoC,IAAI,SAAAxN,GAAC,OAAIA,EAAEwK,MAAM,GACjBE,OAAOW,SAEJkS,EAAeF,EAAM3S,OAAO,SAAAtM,GAAC,OAAKyX,GAAczX,EAAE,GAClDkhB,EAAe,GAGfC,EAAgB,CAAC,EACvBlC,EAAMxb,QAAQ,SAAAzD,GACZ,IAAMwX,EAASC,GAAczX,GACzBwX,IACF2J,EAAc3J,EAAOjH,KAAKnD,eAAiBoK,EAE/C,GAGM4J,EAAoB,WACxB,IAAMthB,EAAI,IAAIiE,KAEd,MAAO,GAAP0I,OAAUnJ,OAAOxD,EAAEuL,WAAWuB,SAAS,EAAE,KAAI,KAAAH,OAD9B,CAAC,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,OAC1B3M,EAAE6M,YAAW,KAAAF,OAAInJ,OAAOxD,EAAE4M,eAAeyC,OAAO,GAC1G,EAOMkS,EAAe,SAAC9Q,EAAM4R,EAAWZ,GACrC,IAAMrd,EAAQkd,IACRgB,EAAYb,GAAgBA,EAAa5J,QAAU,IAAIvK,cAAgB,GACvEiV,GAAkBF,GAAa,IAAI/U,cAGrCmB,EAAagT,GAAgBA,EAAahT,UAAagT,EAAahT,UAAY,GAChFqJ,EAAW2J,GAAgBA,EAAa3J,QAAW2J,EAAa3J,QAAU,GAC1E7K,EAAawU,GAAgBA,EAAaxU,UAAawU,EAAaxU,UAAY,GAG9EuV,EAAa/T,GAAaqJ,GAAW7K,EA4B3C,MAxBuB,UAAnBsV,GAEF9T,EAAYA,GAAarK,EAEzB0T,EAAU,GACV7K,EAAY,IACgB,gBAAnBsV,GAEJC,GAAcF,IAAcC,IAC/BzK,EAAU1T,GAGZqK,EAAY,GACZxB,EAAY,IACgB,SAAnBsV,IAEJC,GAAevV,GAAaqV,IAAcC,IAC7CtV,EAAY7I,GAGdqK,EAAY,GACZqJ,EAAU,IAGL,CAAErJ,UAAAA,EAAWqJ,QAAAA,EAAS7K,UAAAA,EAC/B,EAEI4N,GACIC,EAAYR,GAAY,cACxB7J,EAAOjL,EAAgBA,EAAcnF,MAAMiM,OAAS,MAElDuL,EAAS4C,GAAcK,IAAc,QACrC2E,EAAY3E,EAAYA,EAAU/Y,cAAc,yBAA2B,KAC3E2d,EAAa5E,EAAYA,EAAU/Y,cAAc,0BAA4B,KAC7E4d,EAAiB7E,EAAYA,EAAU/Y,cAAc,+BAAiC,KAEtFyf,EAAe7B,GAAkBA,EAAetf,MAAQsf,EAAetf,MAAQod,EAG/EgE,EAAeJ,EAAc5Q,EAAKnD,eAClCoU,EAAQH,EAAa9Q,EAAMoH,EAAQ4J,GAEnCE,EAAU,CACdlR,KAAAA,EACAoH,OAAAA,EACA4F,UAAW+D,EACXrE,QAASsC,EAAYA,EAAUpf,MAAMiM,OAAS,GAC9C8Q,SAAU,GACV3O,UAAWiT,EAAMjT,UACjBqJ,QAAS4J,EAAM5J,QACf7K,UAAWyU,EAAMzU,UACjBjJ,SAAU0b,EAAaA,EAAWrf,MAAQ,IAEtCuhB,EAAYrE,GAAiBoE,GACnCP,EAAanT,KAAK,CAAEb,KAAMwU,EAAW/J,OAAAA,OAGjCgK,EAAU1G,KACV2G,EAAa,CAAC,mBAAmB,oBAAoB,gBAAgB,yBAAyB,gBACpGD,EAAQle,QAAQ,SAAA8M,GACd,GAAKqR,EAAWvU,SAASkD,GAAzB,CACA,IAAM7M,EAAO0W,GAAY7J,GACzB,GAAK7M,EAAL,CACA,IAAMiU,EAAS4C,GAAc7W,GACvB6b,EAAY7b,EAAK7B,cAAc,yBAC/B2d,EAAa9b,EAAK7B,cAAc,0BAChCse,EAAazc,EAAK7B,cAAc,0BAChC4d,EAAiB/b,EAAK7B,cAAc,+BAEpCyf,EAAe7B,GAAkBA,EAAetf,MAAQsf,EAAetf,MAAQod,EAGjFgE,EAAeJ,EAAc5Q,EAAKnD,eACjCmU,GAAuC,2BAAvBhR,EAAKnD,gBACxBmU,EAAeJ,EAAc,mBAE/B,IAAMK,EAAQH,EAAa9Q,EAAMoH,EAAQ4J,GAEnCE,EAAU,CACdlR,KAAAA,EACAoH,OAAAA,EACA4F,UAAW+D,EACXrE,QAASsC,EAAYA,EAAUpf,MAAMiM,OAAS,GAC9C8Q,SAAUiD,EAAaA,EAAWhgB,MAAMiM,OAAS,GACjDmC,UAAWiT,EAAMjT,UACjBqJ,QAAS4J,EAAM5J,QACf7K,UAAWyU,EAAMzU,UACjBjJ,SAAU0b,EAAaA,EAAWrf,MAAQ,IAE5C+gB,EAAanT,KAAK,CAAEb,KAAMmQ,GAAiBoE,GAAU9J,OAAAA,GA3BpC,CAFqB,CA8BxC,IAII0H,EAAiB,CAAE,QAAS,EAAG,cAAe,EAAG,KAAQ,GAC/D6B,EAAa1R,KAAK,SAAC3P,EAAGnB,GAGpB,OAFkB2gB,GAAgBxf,EAAE8X,QAAU,IAAIvK,gBAAkB,IAClDiS,GAAgB3gB,EAAEiZ,QAAU,IAAIvK,gBAAkB,EAEtE,GACMyU,EAAcX,EAAa9R,IAAI,SAAAtQ,GAAC,OAAIA,EAAEoO,IAAI,GAE1C4U,EAAW3C,EAAa1S,OAAOoV,GAAavV,OAAOW,SAASsC,KAAK,MACvE3I,QAAQyN,IAAI,8BAA+BwN,EAAa,YAAaC,GAErE1D,EAAOjT,OAAS,CAAC,CAAC2W,IAIdD,EAAYzjB,OAAS,IACnB2jB,GAAgB,EAChBC,GAAU,EACVxL,GAAU,EAEdqL,EAAYpe,QAAQ,SAAAyJ,GAClB,IAAMC,EAAQD,EAAKE,cACfD,EAAME,SAAS,iBAAkB0U,GAAgB,EAC5C5U,EAAME,SAAS,WAAY2U,GAAU,EACrC7U,EAAME,SAAS,YAAWmJ,GAAU,EAC/C,GAMEyL,EADEF,EACU,UACHC,EACG,UACHxL,EACG,UAEA,UAEd4H,EAAOmE,OAAOC,KAAKC,MAAQR,GAC5BC,EAAAjjB,EAAA,EAEK4J,EAAQmC,OAAM,OACpBpE,QAAQyN,IAAI,sCAAuCyJ,GAAO,cAAAoE,EAAAriB,EAAA,KAAAmhB,EAAA,IAC3D,gBAAA0B,GAAA,OAAA3B,EAAAvf,MAAA,KAAAD,UAAA,EArPc,IAqPb,cAAAuf,EAAAjhB,EAAA,KAAAghB,EAAA,IACHD,GAAApf,MAAA,KAAAD,UAAA,CAGD,SAAS2F,KAEHtC,IAAkBA,EAAiBzE,MAAQ,IAG/C2B,EAAI,oCAAoC2B,QAAQ,SAAAwW,GAC9CA,EAAGE,SAAU,CACf,GAGItV,IAAcA,EAAa1E,MAAQ,IAGvCtC,SAASoE,iBAAiB,mCAAmCwB,QAAQ,SAAAwW,GACnEA,EAAGE,SAAU,CACf,GAGIrV,IAAqBA,EAAoB3E,MAAQ,IACjD4E,IAAiBA,EAAgB5E,MAAQ,IACzC6E,IAAqBA,EAAoB7E,MAAQ,IAGjD8E,IAAkBA,EAAiB9E,MAAQ,IAC3C+E,IAAaA,EAAY/E,MAAQ,IAGrC2B,EAAI,gCAAgC2B,QAAQ,SAAAwW,GAC1CA,EAAGE,SAAU,CACf,GAGArY,EAAI,yCAAyC2B,QAAQ,SAAAC,GAErCA,EAAKzB,iBAAiB,oCAC9BwB,QAAQ,SAAArE,GAAC,OAAIA,EAAEwD,UAAUC,OAAO,SAAS,GAG/C,IAAM0c,EAAY7b,EAAK7B,cAAc,yBACjC0d,IAAWA,EAAUpf,MAAQ,IAGjC,IAAMqf,EAAa9b,EAAK7B,cAAc,0BAClC2d,IAAYA,EAAWrf,MAAQ,IAGnC,IAAMggB,EAAazc,EAAK7B,cAAc,0BAClCse,IAAYA,EAAWhgB,MAAQ,IAGnC,IAAMsf,EAAiB/b,EAAK7B,cAAc,+BACtC4d,IAAgBA,EAAetf,MAAQ,GAC7C,GAGImF,IAAeA,EAAcnF,MAAQ,IAGrCgF,IAAaA,EAAY1C,YAAc,IAG3C,IAAMkd,EAAYhe,EAAG,gBACjBge,IAAWA,EAAUld,YAAc,KAGnC2P,IACFA,EAAcxP,UAAUC,OAAO,WAC/BuP,EAAc7O,UAAY,IAIxBmd,IACFA,GAAoB9d,UAAUC,OAAO,WAIvC8C,EAAgB,MAGhB8a,KAGAD,KAGA9F,KACAS,KAGAxY,WAAW,WACT,IAAMggB,EAAc9kB,SAASgE,cAAc,qGAC3C,GAAI8gB,EAAa,CACf,IAAMpD,EAAYoD,EAAY9gB,cAAc,yBACxC0d,GAAwC,mBAApBA,EAAUqD,OAChCrD,EAAUqD,OAEd,CACF,EAAG,IACL,CAEA,SACerb,KAAgB,OAAAsb,GAAArhB,MAAC,KAADD,UAAA,CAuB/B,SAAAshB,KAFC,OAEDA,GAAAvhB,EAAAX,IAAA/D,EAvBA,SAAAkmB,IAAA,OAAAniB,IAAAC,EAAA,SAAAmiB,GAAA,cAAAA,EAAA9jB,GAAA,UACwB,OAAlB0G,GAA4C,QAAlBA,EAAuB,CAAAod,EAAA9jB,EAAA,cAC7C,IAAIV,MAAM,oBAAmB,cAAAwkB,EAAA9jB,EAAA,EAG/BwJ,MAAMC,IAAG,eAAAsa,EAAA1hB,EAAAX,IAAA/D,EAAC,SAAAqmB,EAAOpa,GAAO,IAAAC,EAAA,OAAAnI,IAAAC,EAAA,SAAAsiB,GAAA,cAAAA,EAAAjkB,GAAA,OAET,OADb6J,EAAQD,EAAQ+B,SAASC,WAAWC,oBAAoB,sBACxDC,KAAK,QAAQmY,EAAAjkB,EAAA,EACb4J,EAAQmC,OAAM,WAEhBlC,EAAMmC,aAAc,CAAFiY,EAAAjkB,EAAA,cACd,IAAIV,MAAM,qCAAoC,OAKP,OAD9BuK,EAAMoC,SAAS,GAADuB,OAAI9G,EAAa,KAAA8G,OAAI9G,IAC3Cwd,OAAO1a,MAAM2a,qBAAqBC,IAAIH,EAAAjkB,EAAA,EAEzC4J,EAAQmC,OAAM,OACpBpE,QAAQyN,IAAI,cAAe1O,GAAe,cAAAud,EAAArjB,EAAA,KAAAojB,EAAA,IAC3C,gBAAAK,GAAA,OAAAN,EAAAxhB,MAAA,KAAAD,UAAA,EAfc,IAeb,cAAAwhB,EAAAljB,EAAA,KAAAijB,EAAA,IACHD,GAAArhB,MAAA,KAAAD,UAAA,UAGcmF,KAAU,OAAA6c,GAAA/hB,MAAC,KAADD,UAAA,CAmLzB,SAAAgiB,KAFC,OAEDA,GAAAjiB,EAAAX,IAAA/D,EAnLA,SAAA4mB,IAAA,OAAA7iB,IAAAC,EAAA,SAAA6iB,GAAA,cAAAA,EAAAxkB,GAAA,cAAAwkB,EAAAxkB,EAAA,EACQwJ,MAAMC,IAAG,eAAAgb,EAAApiB,EAAAX,IAAA/D,EAAC,SAAA+mB,EAAO9a,GAAO,IAAAC,EAAA8a,EAAAC,EAAA1Y,EAAA9M,EAAAkgB,EAAAC,EAAA7D,EAAA8D,EAAAlB,EAAAzR,EAAAC,EAAAC,EAAA9H,EAAAgd,EAAAtG,EAAArK,EAAAoH,EAAA4H,EAAAC,EAAAC,EAAA6B,EAAA/S,EAAAqJ,EAAA7K,EAAA+W,EAAArC,EAAAE,EAAAC,EAAAmC,EAAAhC,EAAAC,EAAAxL,EAAAyL,EAAA,OAAAthB,IAAAC,EAAA,SAAAojB,GAAA,cAAAA,EAAA/kB,GAAA,OAET,OADb6J,EAAQD,EAAQ+B,SAASC,WAAWC,oBAAoB,sBACxDC,KAAK,QAAQiZ,EAAA/kB,EAAA,EACb4J,EAAQmC,OAAM,WAChBlC,EAAMmC,aAAc,CAAF+Y,EAAA/kB,EAAA,QAC+B,OAAnD2H,QAAQC,MAAM,qCAAqCmd,EAAAnkB,EAAA,UAMjC,OADd+jB,EAAO9a,EAAMoC,SAAS,aACvBH,KAAK,UAAUiZ,EAAA/kB,EAAA,EACd4J,EAAQmC,OAAM,OAEhB6Y,EAAU,EACR1Y,EAASyY,EAAKzY,QAAU,GACrB9M,EAAI,EAAC,YAAEA,EAAI8M,EAAO/M,QAAM,CAAA4lB,EAAA/kB,EAAA,YAC3BkM,EAAO9M,GAAG,IAAsC,KAAhCiF,OAAO6H,EAAO9M,GAAG,IAAI+N,OAAa,CAAA4X,EAAA/kB,EAAA,QACpD4kB,EAAUxlB,EAAI,EAAG2lB,EAAA/kB,EAAA,eAGA,OAAjB4kB,EAAUxlB,EAAI,EAAG2lB,EAAAnkB,EAAA,YALcxB,IAAG2lB,EAAA/kB,EAAA,eAoJrC,OAzIKsf,EAAa3Z,EAAmBA,EAAiBzE,MAAMiM,OAAS,GAChEoS,EAAUxE,KAAwBzK,KAAK,MACvCoL,EAAUT,KACVuE,EAAY5Z,EAAeA,EAAa1E,MAAQ,GAChDod,EAAYf,KAAuBjN,KAAK,MAG9CzG,EAAMoC,SAAS,IAADuB,OAAKoX,IAAW1Y,OAAS,CAAC,CAACoT,IAEzCzV,EAAMoC,SAAS,IAADuB,OAAKoX,IAAW1Y,OAAS,CAAC,CAACqT,IAEzC1V,EAAMoC,SAAS,IAADuB,OAAKoX,IAAW1Y,OAAS,CAAC,CAACoS,IAEzCzU,EAAMoC,SAAS,IAADuB,OAAKoX,IAAW1Y,OAAS,CAAC,CAACsT,IAGnC3S,EAAQiO,GAAmBjV,EAAsBA,EAAoB3E,MAAQ,IAC7E4L,EAAQgO,GAAmBhV,EAAkBA,EAAgB5E,MAAQ,IACrE6L,EAAQ+N,GAAmB/U,EAAsBA,EAAoB7E,MAAQ,IACnF2I,EAAMoC,SAAS,IAADuB,OAAKoX,EAAO,MAAApX,OAAKoX,IAAW1Y,OAAS,CAAC,CAACW,EAAOC,EAAOC,IAGnElD,EAAMoC,SAAS,IAADuB,OAAKoX,IAAW1Y,OAAS,CAAC,CAAClG,EAAmBA,EAAiB9E,MAAQ,KACrF2I,EAAMoC,SAAS,IAADuB,OAAKoX,IAAW1Y,OAAS,CAAC,CAACjG,EAAcA,EAAY/E,MAAQ,KAQrE+D,EALoB,WACxB,IAAMpE,EAAI,IAAIiE,KAEd,MAAO,GAAP0I,OAAUnJ,OAAOxD,EAAEuL,WAAWuB,SAAS,EAAE,KAAI,KAAAH,OAD9B,CAAC,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,OAC1B3M,EAAE6M,YAAW,KAAAF,OAAInJ,OAAOxD,EAAE4M,eAAeyC,OAAO,GAC1G,CACciS,GAGRF,EAAe,GACjBvG,GACIC,EAAYR,GAAY,cACxB7J,EAAOjL,EAAgBA,EAAcnF,MAAMiM,OAAS,MAElDuL,EAAS4C,GAAcK,IAAc,QACrC2E,EAAY3E,EAAYA,EAAU/Y,cAAc,yBAA2B,KAC3E2d,EAAa5E,EAAYA,EAAU/Y,cAAc,0BAA4B,KAC7E4d,EAAiB7E,EAAYA,EAAU/Y,cAAc,+BAAiC,KACtFyf,EAAe7B,GAAkBA,EAAetf,MAAQsf,EAAetf,MAAQod,EAGjFhP,EAAY,GAAIqJ,EAAU,GAAI7K,EAAY,GAE1B,WADd+W,EAAcnM,EAAOvK,eAEzBmB,EAAYrK,EACa,gBAAhB4f,EACTlM,EAAU1T,EACe,SAAhB4f,IACT/W,EAAY7I,GAGRud,EAAU,CACdlR,KAAAA,EACAoH,OAAAA,EACA4F,UAAW+D,EACXrE,QAASsC,EAAYA,EAAUpf,MAAMiM,OAAS,GAC9C8Q,SAAU,GACV3O,UAAAA,EACAqJ,QAAAA,EACA7K,UAAAA,EACAjJ,SAAU0b,EAAaA,EAAWrf,MAAQ,IAE5C+gB,EAAanT,KAAKsP,GAAiBoE,OAG/BE,EAAU1G,KACV2G,EAAa,CAAC,mBAAmB,oBAAoB,gBAAgB,yBAAyB,gBACpGD,EAAQle,QAAQ,SAAA8M,GACd,GAAKqR,EAAWvU,SAASkD,GAAzB,CACA,IAAM7M,EAAO0W,GAAY7J,GACzB,GAAK7M,EAAL,CACA,IAAMiU,EAAS4C,GAAc7W,IAAS,QAChC6b,EAAY7b,EAAK7B,cAAc,yBAC/B2d,EAAa9b,EAAK7B,cAAc,0BAChCse,EAAazc,EAAK7B,cAAc,0BAChC4d,EAAiB/b,EAAK7B,cAAc,+BACpCyf,EAAe7B,GAAkBA,EAAetf,MAAQsf,EAAetf,MAAQod,EAGjFhP,EAAY,GAAIqJ,EAAU,GAAI7K,EAAY,GACxC+W,EAAcnM,EAAOvK,cACP,UAAhB0W,EACFvV,EAAYrK,EACa,gBAAhB4f,EACTlM,EAAU1T,EACe,SAAhB4f,IACT/W,EAAY7I,GAGd,IAAMud,EAAU,CACdlR,KAAAA,EACAoH,OAAAA,EACA4F,UAAW+D,EACXrE,QAASsC,EAAYA,EAAUpf,MAAMiM,OAAS,GAC9C8Q,SAAUiD,EAAaA,EAAWhgB,MAAMiM,OAAS,GACjDmC,UAAAA,EACAqJ,QAAAA,EACA7K,UAAAA,EACAjJ,SAAU0b,EAAaA,EAAWrf,MAAQ,IAE5C+gB,EAAanT,KAAKsP,GAAiBoE,GA9BlB,CAFqB,CAiCxC,KAGIsC,EAAYjb,EAAMoC,SAAS,IAADuB,OAAKoX,KAC3B1Y,OAAS,CAAC,CAAC+V,EAAa3R,KAAK,QAInC2R,EAAa9iB,OAAS,IACpB2jB,GAAgB,EAChBC,GAAU,EACVxL,GAAU,EAEd0K,EAAazd,QAAQ,SAAAyJ,GACnB,IAAMC,EAAQD,EAAKE,cACfD,EAAME,SAAS,iBAAkB0U,GAAgB,EAC5C5U,EAAME,SAAS,WAAY2U,GAAU,EACrC7U,EAAME,SAAS,YAAWmJ,GAAU,EAC/C,GAIEyL,EADEF,EACU,UACHC,EACG,UACHxL,EACG,UAEA,UAEduN,EAAUxB,OAAOC,KAAKC,MAAQR,GAC/B+B,EAAA/kB,EAAA,EAEK4J,EAAQmC,OAAM,OAIC,OADDlC,EAAMoC,SAAS,IAADuB,OAAKoX,IAC3BnL,SAASsL,EAAA/kB,EAAA,EACf4J,EAAQmC,OAAM,OAGpBrF,EAAgBke,EAAQ,eAAAG,EAAAnkB,EAAA,KAAA8jB,EAAA,IACzB,gBAAAM,GAAA,OAAAP,EAAAliB,MAAA,KAAAD,UAAA,EA/Kc,IA+Kb,cAAAkiB,EAAA5jB,EAAA,KAAA2jB,EAAA,IACHD,GAAA/hB,MAAA,KAAAD,UAAA,CAGD,SAASif,KACY,CACjB,CAAE0D,MAAO,kBAAmBhe,QAAS,0BACrC,CAAEge,MAAO,cAAehe,QAAS,sBACjC,CAAEge,MAAO,kBAAmBhe,QAAS,2BAE5BzC,QAAQ,SAAA0gB,GAAwB,IAArBD,EAAKC,EAALD,MAAOhe,EAAOie,EAAPje,QACrBke,EAAUziB,EAAGuiB,GACbG,EAAY1iB,EAAGuE,GACrB,GAAIke,GAAWC,EAAW,CACxB,IAAMC,EAAYzM,GAAqBuM,EAAQjkB,OAC/CkkB,EAAU5hB,YAAc6hB,EAAY,KAAH7X,OAAQ6X,GAAc,EACzD,CACF,EACF,CAtkCAxiB,EAAI,oCAAoC2B,QAAQ,SAAAwW,GAC9CA,EAAGxV,iBAAiB,SAAU,WAC5BiW,KACAS,IACF,EACF,GA8HAtd,SAASoE,iBAAiB,cAAcwB,QAAQ,SAAAwL,GAC9CA,EAAUxK,iBAAiB,SAAU,SAACxH,GACd,aAAlBA,EAAE2c,OAAOrX,MACXka,IAEJ,EACF,GAq9BA,IAAM8H,GAAkB5iB,EAAG,wBACrB+e,GAAsB/e,EAAG,wBACzB6iB,GAAmB7iB,EAAG,qBACtB8iB,GAAoB9iB,EAAG,sBACvB+iB,GAAuB/iB,EAAG,yBAGhC,SAAS8e,KACP,IAAMlV,EAAU3G,EAAmBA,EAAiBzE,MAAMiM,OAAS,GAC/DmY,KACFA,GAAgBI,UAAYpZ,EAEhC,CAwBA,SACeqZ,KAAkB,OAAAC,GAAArjB,MAAC,KAADD,UAAA,CAkEjC,SAAAsjB,KAFC,OAEDA,GAAAvjB,EAAAX,IAAA/D,EAlEA,SAAAkoB,IAAA,IAAAvZ,EAAAwZ,EAAAC,EAAAC,EAAAC,EAAA,OAAAvkB,IAAAC,EAAA,SAAAukB,GAAA,cAAAA,EAAA1mB,EAAA0mB,EAAAlmB,GAAA,OACuE,GAA/DsM,EAAU3G,EAAmBA,EAAiBzE,MAAMiM,OAAS,GACrD,CAAF+Y,EAAAlmB,EAAA,QACoC,OAA9CoD,EAAU,0BAA2B,SAAS8iB,EAAAtlB,EAAA,UAU/C,OALG6gB,IACFA,GAAoB9d,UAAU4B,IAAI,WAEhCggB,KACFA,GAAiBjhB,UAAY,yDAC9B4hB,EAAA1mB,EAAA,EAAA0mB,EAAAlmB,EAAA,EAGwBmmB,MAAM,GAAD3Y,OACvBrK,EAAwB,gCAAAqK,OAA+B4Y,mBAAmB9Z,GAAQ,yBACtF,OAFa,IAARwZ,EAAQI,EAAAvlB,GAIA0lB,GAAI,CAAFH,EAAAlmB,EAAA,cACR,IAAIV,MAAM,mBAADkO,OAAoBsY,EAASpN,SAAS,cAAAwN,EAAAlmB,EAAA,EAGpC8lB,EAASQ,OAAM,OAQlC,GARMP,EAAIG,EAAAvlB,EACJqlB,EAAYD,EAAKC,WAAa,GAGhCR,KACFA,GAAkBhiB,YAAcwiB,EAAU7mB,QAInB,IAArB6mB,EAAU7mB,OAAY,CAAA+mB,EAAAlmB,EAAA,QACwF,OAAhHulB,GAAiBjhB,UAAY,mFAAmF4hB,EAAAtlB,EAAA,UAIlH2kB,GAAiBjhB,UAAY0hB,EAAU7V,IAAI,SAAAxN,GAAC,kDAAA6K,OACT7K,EAAE4jB,SAAW,QAAU,YAAW,eAAA/Y,OAAc7K,EAAE6jB,GAAE,mEAAAhZ,OAE/EvJ,EAAWtB,EAAE8jB,SAAW,cAAa,kBAAAjZ,OACrC7K,EAAE4jB,SAAW,yCAA2C,GAAE,sFAAA/Y,OAGpDvJ,EAAWtB,EAAEI,MAAQ,WAAU,OAAAyK,OAAMkZ,GAAgB/jB,EAAE2e,MAAK,kEAAA9T,OAEpCvJ,EAAWtB,EAAEod,SAAW,wBAAuB,sBAAAvS,OAC/E7K,EAAE4jB,SAAW,4IAAH/Y,OAEkE7K,EAAE6jB,GAAE,0GAI9E,GAAE,8BAEPlW,KAAK,IAAI4V,EAAAlmB,EAAA,eAAAkmB,EAAA1mB,EAAA,EAAAymB,EAAAC,EAAAvlB,EAGZgH,QAAQC,MAAM,iCAAgCqe,GAC1CV,KACFA,GAAiBjhB,UAAY,4DAAHkJ,OAA+DvJ,EAAWgiB,EAAI5iB,SAAQ,gFACjH,cAAA6iB,EAAAtlB,EAAA,KAAAilB,EAAA,kBAEJtjB,MAAA,KAAAD,UAAA,CAGD,SAASokB,GAAgBzU,GACvB,IAAKA,EAAS,MAAO,eACrB,IACE,IAAMpR,EAAI,IAAIiE,KAAKmN,GACnB,OAAIlN,MAAMlE,EAAEmE,WAAmBiN,EACxBpR,EAAE8lB,mBAAmB,QAAS,CAAEzU,IAAK,UAAWrB,MAAO,QAASkC,KAAM,WAC/E,CAAE,MAAO/U,GACP,OAAOiU,CACT,CACF,CAlGItM,IACFA,EAAiBH,iBAAiB,QAASgc,IAC3C7b,EAAiBH,iBAAiB,SAAUgc,KAI1C8D,IACFA,GAAgB9f,iBAAiB,QAAOnD,EAAAX,IAAA/D,EAAE,SAAAipB,IAAA,OAAAllB,IAAAC,EAAA,SAAAklB,GAAA,cAAAA,EAAA7mB,GAAA,cAAA6mB,EAAA7mB,EAAA,EAClC2lB,KAAoB,cAAAkB,EAAAjmB,EAAA,KAAAgmB,EAAA,KAK1BnB,IACFA,GAAqBjgB,iBAAiB,QAAS,WACzCic,IACFA,GAAoB9d,UAAUC,OAAO,UAEzC,GAmFF3F,OAAO6oB,oBAAmB,eAAAC,EAAA1kB,EAAAX,IAAA/D,EAAG,SAAAqpB,EAAeC,GAAS,IAAAnB,EAAAoB,EAAA,OAAAxlB,IAAAC,EAAA,SAAAwlB,GAAA,cAAAA,EAAA3nB,EAAA2nB,EAAAnnB,GAAA,UAC7B,OAAlB0G,GAA4C,QAAlBA,EAAuB,CAAAygB,EAAAnnB,EAAA,QACF,OAAjDoD,EAAU,6BAA8B,SAAS+jB,EAAAvmB,EAAA,iBAAAumB,EAAA3nB,EAAA,EAAA2nB,EAAAnnB,EAAA,EAM1BmmB,MAAM,GAAD3Y,OAAIrK,EAAwB,8BAAAqK,OAA6ByZ,GAAa,CAChGG,OAAQ,OACRC,QAAS,CAAE,eAAgB,oBAC3BC,KAAMC,KAAKC,UAAU,CAAEC,SAAU/gB,MACjC,OAJY,IAARof,EAAQqB,EAAAxmB,GAMA0lB,GAAI,CAAFc,EAAAnnB,EAAA,cACR,IAAIV,MAAM,mBAADkO,OAAoBsY,EAASpN,SAAS,cAAAyO,EAAAnnB,EAAA,EAIjDwJ,MAAMC,IAAG,eAAAie,EAAArlB,EAAAX,IAAA/D,EAAC,SAAAgqB,EAAO/d,GAAO,IAAAC,EAAA+d,EAAA5F,EAAA6F,EAAA,OAAAnmB,IAAAC,EAAA,SAAAmmB,GAAA,cAAAA,EAAA9nB,GAAA,OAET,OADb6J,EAAQD,EAAQ+B,SAASC,WAAWC,oBAAoB,sBACxDC,KAAK,QAAQgc,EAAA9nB,EAAA,EACb4J,EAAQmC,OAAM,WAEhBlC,EAAMmC,aAAc,CAAF8b,EAAA9nB,EAAA,cACd,IAAIV,MAAM,mBAAkB,OAIhB,OADdsoB,EAAO/d,EAAMoC,SAAS,IAADuB,OAAK9G,KAC3BoF,KAAK,UAAUgc,EAAA9nB,EAAA,EACd4J,EAAQmC,OAAM,OAO0C,OAJxDiW,EAAY4F,EAAK1b,QAAU0b,EAAK1b,OAAO,IAAM0b,EAAK1b,OAAO,GAAG,GAC9D7H,OAAOujB,EAAK1b,OAAO,GAAG,IACtB,GACE2b,EAAS,mBAAHra,OAAsByZ,EAAS,KAC3CW,EAAK1b,OAAS,CAAC,CAAC8V,EAAW,GAAHxU,OAAMwU,EAAQ,KAAAxU,OAAIqa,GAAWA,IAASC,EAAA9nB,EAAA,EACxD4J,EAAQmC,OAAM,cAAA+b,EAAAlnB,EAAA,KAAA+mB,EAAA,IACrB,gBAAAI,GAAA,OAAAL,EAAAnlB,MAAA,KAAAD,UAAA,EApBc,IAoBb,OAIF,OAFAc,EAAU,gCAAiC,WAE3C+jB,EAAAnnB,EAAA,EACM2lB,KAAoB,OAAAwB,EAAAnnB,EAAA,eAAAmnB,EAAA3nB,EAAA,EAAA0nB,EAAAC,EAAAxmB,EAG1BgH,QAAQC,MAAM,4BAA2Bsf,GACzC9jB,EAAU,6BAA+B8jB,EAAI7jB,QAAS,SAAS,cAAA8jB,EAAAvmB,EAAA,KAAAomB,EAAA,iBAElE,gBAAAgB,GAAA,OAAAjB,EAAAxkB,MAAA,KAAAD,UAAA,EAlDyB,GAqDJ,oBAAX2lB,QAAoD,mBAAnBA,OAAOC,SAE/CD,OAAOC,QAAQ,SAACC,GACVA,EAAKC,OAASH,OAAOI,SAAS7e,QAh0CtC3G,EAAI,gGAAgG2B,QAAQ,SAAA8jB,GAC1GA,EAAK9iB,iBAAiB,QAAS,WAC7B,IAAMwK,EAAYsY,EAAKC,QAAQ,8BAC1BvY,GACYlN,MAAMC,KAAKiN,EAAUhN,iBAAiB,UAC9CwB,QAAQ,SAAArE,GACfA,EAAEwD,UAAUK,OAAO,SAAU7D,IAAMmoB,EACrC,EACF,EACF,GAunCmB,CAAC,kBAAmB,cAAe,mBAC3C9jB,QAAQ,SAAAgkB,GACjB,IAAMC,EAAK/lB,EAAG8lB,GACVC,GACFA,EAAGjjB,iBAAiB,SAAU+b,GAElC,GAKA1e,EAAI,0BAA0B2B,QAAQ,SAAAygB,GACpCA,EAAMzf,iBAAiB,SAAU,WAC/BjB,GACF,EACF,GAhqEqB1B,EAAI,2BACZ2B,QAAQ,SAAAikB,GACnBA,EAAGjjB,iBAAiB,SAAU,kBAAM3B,GAAkB,EAAK,GAC3D4kB,EAAGjjB,iBAAiB,QAAS,kBAAM3B,GAAkB,EAAK,EAC5D,GAEAhB,EAAI,SAAS2B,QAAQ,SAAA8jB,GACnBA,EAAK9iB,iBAAiB,QAAS,kBAAM3B,GAAkB,EAAK,EAC9D,GA+0EIhB,EAAI,gCAAgC2B,QAAQ,SAAAwW,GAC1CA,EAAGxV,iBAAiB,SAAU,kBAAMiW,IAAqB,EAC3D,GAEA5Y,EAAI,oCAAoC2B,QAAQ,SAAAwW,GAC9CA,EAAGxV,iBAAiB,SAAU,kBAAMiW,IAAqB,EAC3D,GACAzT,KAAoB5F,KAAK,WAEvByB,GAAkB,GAElBiQ,IACF,GAEJ,EAEH,CAv4ED,E,4BCJiC,IAAI4U,IAAI,a","sources":["webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/webpack/runtime/global","webpack://office-addin-taskpane-js/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane-js/webpack/runtime/publicPath","webpack://office-addin-taskpane-js/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = (typeof document !== 'undefined' && document.baseURI) || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","// Task Manager task pane logic, wired to Excel via Office.js\n// Based on the scaffold in Task Manager Excel/addin/taskpane.js\n\n/* global document, Excel, Office */\n\n(function(){\n  const qs = (s)=>document.querySelector(s);\n  const qsa = (s)=>Array.from(document.querySelectorAll(s));\n  let teamMembersLoaded = false;\n  let hasUnsavedChanges = false;\n\n  // Email Summarizer API configuration\n  // Update this URL when deploying to internal server\n  const EMAIL_SUMMARIZER_API_URL = 'http://localhost:5002';\n\n  // Toast notification helper\n  function showToast(message, type = 'success') {\n    const toast = qs('#toast');\n    if (!toast) return;\n    toast.textContent = message;\n    toast.className = 'toast ' + type + ' show';\n    setTimeout(() => {\n      toast.classList.remove('show');\n    }, 3000);\n  }\n\n  // Unsaved changes indicator\n  function setUnsavedChanges(unsaved) {\n    hasUnsavedChanges = unsaved;\n    const indicator = qs('#unsavedIndicator');\n    if (indicator) {\n      indicator.classList.toggle('visible', unsaved);\n    }\n  }\n\n  // Track form changes\n  function wireChangeTracking() {\n    const formElements = qsa('input, select, textarea');\n    formElements.forEach(el => {\n      el.addEventListener('change', () => setUnsavedChanges(true));\n      el.addEventListener('input', () => setUnsavedChanges(true));\n    });\n    // Also track chip clicks\n    qsa('.chip').forEach(chip => {\n      chip.addEventListener('click', () => setUnsavedChanges(true));\n    });\n  }\n\n  // Warn before leaving with unsaved changes\n  window.addEventListener('beforeunload', (e) => {\n    if (hasUnsavedChanges) {\n      e.preventDefault();\n      e.returnValue = '';\n      return '';\n    }\n  });\n\n  // Escape HTML helper\n  function escapeHtml(text) {\n    const div = document.createElement('div');\n    div.textContent = String(text || '');\n    return div.innerHTML;\n  }\n\n  // Due date warning helper\n  function getDueDateWarningClass(deadlineStr) {\n    if (!deadlineStr) return '';\n    const deadline = new Date(deadlineStr);\n    if (isNaN(deadline.getTime())) return '';\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n    deadline.setHours(0, 0, 0, 0);\n    const diffDays = Math.ceil((deadline - today) / (1000 * 60 * 60 * 24));\n    if (diffDays < 0) return 'overdue';\n    if (diffDays <= 3) return 'warning';\n    return '';\n  }\n\n  function formatDeadlineBadge(deadlineStr) {\n    const warningClass = getDueDateWarningClass(deadlineStr);\n    if (!warningClass) return '';\n    if (warningClass === 'overdue') {\n      return '<span class=\"deadline-badge overdue\"> Overdue</span>';\n    }\n    const deadline = new Date(deadlineStr);\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n    deadline.setHours(0, 0, 0, 0);\n    const diffDays = Math.ceil((deadline - today) / (1000 * 60 * 60 * 24));\n    if (diffDays === 0) return '<span class=\"deadline-badge warning\"> Due today</span>';\n    if (diffDays === 1) return '<span class=\"deadline-badge warning\"> Due tomorrow</span>';\n    return `<span class=\"deadline-badge warning\"> ${diffDays} days left</span>`;\n  }\n\n  // Apply deadline warnings to task cards\n  function applyDeadlineWarnings() {\n    qsa('.task-card').forEach(card => {\n      const deadlineInput = card.querySelector('[data-role=\"deadline\"]');\n      if (!deadlineInput) return;\n      const deadline = deadlineInput.value;\n      const warningClass = getDueDateWarningClass(deadline);\n      card.classList.remove('deadline-warning', 'deadline-overdue');\n      if (warningClass === 'overdue') {\n        card.classList.add('deadline-overdue');\n      } else if (warningClass === 'warning') {\n        card.classList.add('deadline-warning');\n      }\n    });\n  }\n\n  const companyNameInput = qs('#companyName');\n  // taskDescriptionEl is now a container with checkboxes, not a select\n  const brokerLeadEl = qs('#brokerLead');\n  const initialRequestInput = qs('#initialRequest');\n  const introEmailInput = qs('#introEmail');\n  const remindersStartInput = qs('#remindersStart');\n  const emailFrequencyEl = qs('#emailFrequency');\n  const extraNoteEl = qs('#extraNote');\n  const auditTextEl = qs('#auditText');\n  const tasksRowEl = qs('#tasksRow');\n  const taskCardsContainer = qs('#taskCards');\n  const taskNameInput = qs('#taskName'); // only for __other__ card\n\n  // Wire Save, New Task, Load Selected, and KYC Portal buttons\n  const saveBtn = qs('#saveBtn');\n  const newTaskBtn = qs('#newTaskBtn');\n  const loadSelectedBtn = qs('#loadSelectedBtn');\n  const openKycPortalBtn = qs('#openKycPortal');\n\n  // Track current row for display\n  let currentRowNum = null;\n\n  if (saveBtn) {\n    saveBtn.addEventListener('click', async () => {\n      try {\n        if (currentRowNum === null || currentRowNum === 'new') {\n          await addNewTask();\n          showToast(' New task added successfully!', 'success');\n        } else {\n          await saveToActiveRow();\n          showToast(' Changes saved to row ' + currentRowNum, 'success');\n        }\n        setUnsavedChanges(false);\n      } catch (e) {\n        console.error('Save error:', e);\n        showToast(' Save failed: ' + e.message, 'error');\n      }\n    });\n  }\n\n  // Load Selected Row button (in By Row tab)\n  if (loadSelectedBtn) {\n    loadSelectedBtn.addEventListener('click', async () => {\n      try {\n        await loadFromActiveRow();\n        showToast(' Loaded row ' + currentRowNum, 'success');\n      } catch (e) {\n        console.error('Load error:', e);\n        showToast(' Failed to load row', 'error');\n      }\n    });\n  }\n\n  if (newTaskBtn) {\n    newTaskBtn.addEventListener('click', () => {\n      clearFormForNewTask();\n    });\n  }\n\n  // Custom confirm dialog (since window.confirm is not supported in Office Add-ins)\n  function showConfirmDialog(message) {\n    return new Promise((resolve) => {\n      const dialog = qs('#confirmDialog');\n      const msgEl = qs('#confirmMessage');\n      const cancelBtn = qs('#confirmCancel');\n      const okBtn = qs('#confirmOk');\n      \n      if (!dialog || !msgEl || !cancelBtn || !okBtn) {\n        resolve(false);\n        return;\n      }\n      \n      msgEl.textContent = message;\n      dialog.style.display = 'flex';\n      \n      const cleanup = () => {\n        dialog.style.display = 'none';\n        cancelBtn.removeEventListener('click', onCancel);\n        okBtn.removeEventListener('click', onOk);\n      };\n      \n      const onCancel = () => {\n        cleanup();\n        resolve(false);\n      };\n      \n      const onOk = () => {\n        cleanup();\n        resolve(true);\n      };\n      \n      cancelBtn.addEventListener('click', onCancel);\n      okBtn.addEventListener('click', onOk);\n    });\n  }\n\n  // Delete Task button\n  const deleteTaskBtn = qs('#deleteTaskBtn');\n  if (deleteTaskBtn) {\n    deleteTaskBtn.addEventListener('click', async () => {\n      // Don't allow delete if this is a new unsaved task\n      if (currentRowNum === null || currentRowNum === 'new') {\n        showToast('No task to delete - this is a new task', 'error');\n        return;\n      }\n      \n      // Confirm before deleting\n      const confirmed = await showConfirmDialog('Are you sure you want to delete this Task?');\n      if (!confirmed) return;\n      \n      try {\n        await deleteCurrentRow();\n        showToast(' Task deleted successfully', 'success');\n        clearFormForNewTask();\n      } catch (e) {\n        console.error('Delete error:', e);\n        showToast(' Failed to delete task: ' + e.message, 'error');\n      }\n    });\n  }\n\n  // Guard on the DOM element so we don't wire multiple listeners or open twice\n  if (openKycPortalBtn && openKycPortalBtn.dataset.kycListenerAttached !== '1') {\n    openKycPortalBtn.dataset.kycListenerAttached = '1';\n    openKycPortalBtn.addEventListener('click', (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n      if (openKycPortalBtn.dataset.kycOpening === '1') return;\n      openKycPortalBtn.dataset.kycOpening = '1';\n      window.open('http://192.168.1.141:8080/', '_blank');\n      setTimeout(() => { openKycPortalBtn.dataset.kycOpening = '0'; }, 1000);\n    });\n  }\n\n  // Statistics Navigation\n  const tasksView = qs('#tasksView');\n  const statsView = qs('#statsView');\n  const tasksHeader = qs('#tasksHeader');\n  const statsHeader = qs('#statsHeader');\n  const openStatsBtn = qs('#openStatsBtn');\n  const returnToTasksBtn = qs('#returnToTasksBtn');\n  const refreshStatsBtn = qs('#refreshStatsBtn');\n\n  if (openStatsBtn) {\n    openStatsBtn.addEventListener('click', () => {\n      if (tasksView) tasksView.style.display = 'none';\n      if (tasksHeader) tasksHeader.style.display = 'none';\n      if (statsView) statsView.style.display = '';\n      if (statsHeader) statsHeader.style.display = 'flex';\n      loadStatistics();\n    });\n  }\n\n  if (returnToTasksBtn) {\n    returnToTasksBtn.addEventListener('click', () => {\n      if (tasksView) tasksView.style.display = '';\n      if (tasksHeader) tasksHeader.style.display = 'flex';\n      if (statsView) statsView.style.display = 'none';\n      if (statsHeader) statsHeader.style.display = 'none';\n    });\n  }\n\n  if (refreshStatsBtn) {\n    refreshStatsBtn.addEventListener('click', () => {\n      loadStatistics();\n    });\n  }\n\n  // Statistics calculation\n  async function loadStatistics() {\n    try {\n      await Excel.run(async (context) => {\n        const sheet = context.workbook.worksheets.getItemOrNullObject('TASK MANAGER FORM');\n        sheet.load('name');\n        await context.sync();\n        if (sheet.isNullObject) {\n          console.error('Sheet not found for statistics');\n          return;\n        }\n\n        // Load all data\n        const dataRange = sheet.getRange('A1:K5000');\n        dataRange.load('values');\n        await context.sync();\n\n        const rows = dataRange.values || [];\n        if (rows.length < 2) return;\n\n        // Parse all tasks\n        const tasks = [];\n        let todoCount = 0, inProgressCount = 0, doneCount = 0;\n        const brokerStats = {};\n        const monthlyStats = {};\n        const kycMonthly = {};\n        let totalDuration = 0, durationCount = 0;\n        \n        // Attention items with details\n        const overdueItems = [];\n        const upcomingItems = [];\n        const staleItems = [];\n\n        const today = new Date();\n        today.setHours(0, 0, 0, 0);\n        const sevenDaysFromNow = new Date(today);\n        sevenDaysFromNow.setDate(sevenDaysFromNow.getDate() + 7);\n        const thirtyDaysAgo = new Date(today);\n        thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);\n\n        for (let i = 1; i < rows.length; i++) {\n          const row = rows[i];\n          const company = row[0] ? String(row[0]).trim() : '';\n          if (!company) continue;\n\n          const category = row[1] ? String(row[1]).trim() : '';\n          const broker = row[3] ? String(row[3]).trim() : '(none)';\n          const initialRequest = row[4]; // Column E - Initial Request Date\n          const introEmail = row[5]; // Column F - Intro Email Date\n          const remindersStart = row[6]; // Column G - Reminders Start Date\n          const taskSummary = row[7] ? String(row[7]).trim() : '';\n\n          // Parse dates from columns E, F, G for monthly stats\n          // Use the earliest available date as the task creation date\n          let taskDate = null;\n          const dateE = parseDate(initialRequest);\n          const dateF = parseDate(introEmail);\n          const dateG = parseDate(remindersStart);\n          \n          // Pick the earliest non-null date\n          const availableDates = [dateE, dateF, dateG].filter(d => d !== null);\n          if (availableDates.length > 0) {\n            taskDate = availableDates.reduce((min, d) => d < min ? d : min);\n          }\n          \n          if (taskDate) {\n            const monthKey = `${taskDate.getFullYear()}-${String(taskDate.getMonth() + 1).padStart(2, '0')}`;\n            monthlyStats[monthKey] = (monthlyStats[monthKey] || 0) + 1;\n          }\n\n          // Broker stats\n          if (!brokerStats[broker]) {\n            brokerStats[broker] = { total: 0, active: 0, completed: 0 };\n          }\n          brokerStats[broker].total++;\n\n          // Parse task summary for status\n          if (taskSummary) {\n            const lines = taskSummary.split(/\\r?\\n/).filter(Boolean);\n            lines.forEach(line => {\n              const lower = line.toLowerCase();\n              \n              // Count statuses\n              if (lower.includes(': to do')) {\n                todoCount++;\n                brokerStats[broker].active++;\n              } else if (lower.includes(': in progress')) {\n                inProgressCount++;\n                brokerStats[broker].active++;\n              } else if (lower.includes(': done')) {\n                doneCount++;\n                brokerStats[broker].completed++;\n              }\n\n              // Check for KYC completed\n              if (lower.includes('kyc') && lower.includes(': done')) {\n                const completedMatch = line.match(/completed:\\s*(\\d{1,2}[-\\s][A-Za-z]{3}[-\\s]\\d{2,4})/i);\n                if (completedMatch) {\n                  const kycDate = parseDate(completedMatch[1]);\n                  if (kycDate) {\n                    const monthKey = `${kycDate.getFullYear()}-${String(kycDate.getMonth() + 1).padStart(2, '0')}`;\n                    kycMonthly[monthKey] = (kycMonthly[monthKey] || 0) + 1;\n                  }\n                }\n              }\n\n              // Extract task name and assignee for attention items\n              const taskNameMatch = line.match(/^(.*?)\\s*:\\s*(to do|in progress|done)/i);\n              const assigneeMatch = line.match(/assigned to\\s+([^|]+)/i);\n              const taskName = taskNameMatch ? taskNameMatch[1].trim() : 'Unknown';\n              const assignee = assigneeMatch ? assigneeMatch[1].trim() : '';\n\n              // Check deadlines (support both formats)\n              const deadlineMatch = line.match(/deadline:\\s*(\\d{4}-\\d{2}-\\d{2}|\\d{1,2}[-\\s][A-Za-z]{3}[-\\s]\\d{2,4})/i);\n              if (deadlineMatch && !lower.includes(': done')) {\n                const deadline = parseDate(deadlineMatch[1]);\n                if (deadline) {\n                  const daysUntil = Math.ceil((deadline - today) / (1000 * 60 * 60 * 24));\n                  if (deadline < today) {\n                    overdueItems.push({\n                      company,\n                      task: taskName,\n                      assignee,\n                      detail: `${Math.abs(daysUntil)}d overdue`\n                    });\n                  } else if (deadline <= sevenDaysFromNow) {\n                    upcomingItems.push({\n                      company,\n                      task: taskName,\n                      assignee,\n                      detail: daysUntil === 0 ? 'Today' : `${daysUntil}d left`\n                    });\n                  }\n                }\n              }\n\n              // Check for stale tasks (no status update for 30+ days, not Done)\n              if (!lower.includes(': done')) {\n                // Look for the last action date (initiated, updated, or completed)\n                const initiatedMatch = line.match(/initiated:\\s*(\\d{1,2}[-\\s][A-Za-z]{3}[-\\s]\\d{2,4})/i);\n                const updatedMatch = line.match(/updated:\\s*(\\d{1,2}[-\\s][A-Za-z]{3}[-\\s]\\d{2,4})/i);\n                \n                let lastActionDate = null;\n                if (updatedMatch) {\n                  lastActionDate = parseDate(updatedMatch[1]);\n                } else if (initiatedMatch) {\n                  lastActionDate = parseDate(initiatedMatch[1]);\n                }\n                \n                if (lastActionDate && lastActionDate < thirtyDaysAgo) {\n                  const daysSince = Math.ceil((today - lastActionDate) / (1000 * 60 * 60 * 24));\n                  staleItems.push({\n                    company,\n                    task: taskName,\n                    assignee,\n                    detail: `${daysSince}d ago`\n                  });\n                }\n              }\n\n              // Calculate duration for completed tasks\n              if (lower.includes(': done')) {\n                const initiatedMatch = line.match(/initiated:\\s*(\\d{1,2}[-\\s][A-Za-z]{3}[-\\s]\\d{2,4})/i);\n                const completedMatch = line.match(/completed:\\s*(\\d{1,2}[-\\s][A-Za-z]{3}[-\\s]\\d{2,4})/i);\n                if (initiatedMatch && completedMatch) {\n                  const initiated = parseDate(initiatedMatch[1]);\n                  const completed = parseDate(completedMatch[1]);\n                  if (initiated && completed) {\n                    const days = Math.ceil((completed - initiated) / (1000 * 60 * 60 * 24));\n                    if (days >= 0 && days < 365) {\n                      totalDuration += days;\n                      durationCount++;\n                    }\n                  }\n                }\n              }\n            });\n          }\n        }\n\n        // Update UI\n        const activeTasks = todoCount + inProgressCount;\n        qs('#statActiveTasks').textContent = activeTasks;\n        qs('#statAvgDuration').textContent = durationCount > 0 ? Math.round(totalDuration / durationCount) : '-';\n\n        // Status bars\n        const totalStatus = todoCount + inProgressCount + doneCount;\n        if (totalStatus > 0) {\n          qs('#barToDo').style.width = (todoCount / totalStatus * 100) + '%';\n          qs('#barInProgress').style.width = (inProgressCount / totalStatus * 100) + '%';\n          qs('#barDone').style.width = (doneCount / totalStatus * 100) + '%';\n        }\n        qs('#countToDo').textContent = todoCount;\n        qs('#countInProgress').textContent = inProgressCount;\n        qs('#countDone').textContent = doneCount;\n\n        // Attention Required section - render counts and task lists\n        // Helper to render attention items and show/hide group\n        const renderAttentionGroup = (items, groupId, listId, countId) => {\n          const group = qs(`#${groupId}`);\n          const container = qs(`#${listId}`);\n          const countEl = qs(`#${countId}`);\n          \n          if (countEl) countEl.textContent = items.length;\n          \n          if (!group || !container) return;\n          \n          if (items.length === 0) {\n            group.classList.remove('has-items');\n            container.innerHTML = '';\n            return;\n          }\n          \n          group.classList.add('has-items');\n          // Format: \"Company: Task to Assignee\" with detail on right\n          container.innerHTML = items.slice(0, 10).map(item => {\n            const assigneePart = item.assignee ? ` <span class=\"to-assignee\">to ${escapeHtml(item.assignee)}</span>` : '';\n            return `<div class=\"attention-item\">\n              <span class=\"task-info\" title=\"${escapeHtml(item.company)}: ${escapeHtml(item.task)}\">${escapeHtml(item.company)}: ${escapeHtml(item.task)}${assigneePart}</span>\n              <span class=\"task-detail\">${escapeHtml(item.detail)}</span>\n            </div>`;\n          }).join('');\n        };\n        \n        // Sort and render each list\n        overdueItems.sort((a, b) => parseInt(b.detail) - parseInt(a.detail)); // Most overdue first\n        upcomingItems.sort((a, b) => parseInt(a.detail) - parseInt(b.detail)); // Soonest first\n        staleItems.sort((a, b) => parseInt(b.detail) - parseInt(a.detail)); // Oldest first\n        \n        renderAttentionGroup(overdueItems, 'overdueGroup', 'overdueList', 'statOverdue');\n        renderAttentionGroup(upcomingItems, 'upcomingGroup', 'upcomingList', 'statUpcoming');\n        renderAttentionGroup(staleItems, 'staleGroup', 'staleList', 'statStale');\n\n        // Monthly Activity Visual Chart\n        const monthlyChart = qs('#monthlyChart');\n        if (monthlyChart) {\n          const sortedMonths = Object.keys(monthlyStats).sort().reverse().slice(0, 6).reverse();\n          const maxTasks = Math.max(...sortedMonths.map(m => monthlyStats[m] || 0), 1);\n          const maxKyc = Math.max(...sortedMonths.map(m => kycMonthly[m] || 0), 1);\n          const maxVal = Math.max(maxTasks, maxKyc);\n          \n          const monthNames = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];\n          monthlyChart.innerHTML = sortedMonths.map(month => {\n            const [year, m] = month.split('-');\n            const shortMonth = monthNames[parseInt(m) - 1];\n            const tasks = monthlyStats[month] || 0;\n            const kyc = kycMonthly[month] || 0;\n            const taskHeight = maxVal > 0 ? (tasks / maxVal * 80) : 0;\n            const kycHeight = maxVal > 0 ? (kyc / maxVal * 80) : 0;\n            return `<div class=\"month-bar-group\">\n              <div class=\"month-bars\">\n                <div class=\"month-bar tasks\" style=\"height:${taskHeight}px\">\n                  ${tasks > 0 ? `<span class=\"month-bar-value\">${tasks}</span>` : ''}\n                </div>\n                <div class=\"month-bar kyc\" style=\"height:${kycHeight}px\">\n                  ${kyc > 0 ? `<span class=\"month-bar-value\">${kyc}</span>` : ''}\n                </div>\n              </div>\n              <div class=\"month-bar-label\">${shortMonth}</div>\n            </div>`;\n          }).join('');\n        }\n\n        // Broker Activity Visual Chart - Horizontal Bars like Status Distribution\n        const brokerChart = qs('#brokerChart');\n        if (brokerChart) {\n          const sortedBrokers = Object.entries(brokerStats)\n            .filter(([name]) => name && name !== '(none)' && name.trim() !== '')\n            .sort((a, b) => (b[1].active + b[1].completed) - (a[1].active + a[1].completed));\n          // Find max for scaling (active + completed combined)\n          const maxTasks = Math.max(...sortedBrokers.map(([,s]) => s.active + s.completed), 1);\n          \n          brokerChart.innerHTML = sortedBrokers.map(([name, stats]) => {\n            const activeWidth = maxTasks > 0 ? (stats.active / maxTasks * 100) : 0;\n            const completedWidth = maxTasks > 0 ? (stats.completed / maxTasks * 100) : 0;\n            return `<div class=\"broker-row\">\n              <span class=\"broker-name\" title=\"${escapeHtml(name)}\">${escapeHtml(name)}</span>\n              <div class=\"broker-bar-track\">\n                <div class=\"broker-bar-fill active\" style=\"width:${activeWidth}%\">${stats.active > 0 ? `<span class=\"bar-num\">${stats.active}</span>` : ''}</div>\n                <div class=\"broker-bar-fill completed\" style=\"width:${completedWidth}%\">${stats.completed > 0 ? `<span class=\"bar-num\">${stats.completed}</span>` : ''}</div>\n              </div>\n            </div>`;\n          }).join('');\n        }\n      });\n    } catch (e) {\n      console.error('Error loading statistics:', e);\n    }\n  }\n\n  // Helper to parse various date formats including Excel serial numbers\n  function parseDate(dateVal) {\n    if (!dateVal) return null;\n    \n    // Check if it's an Excel serial number (numeric value)\n    // Excel dates are days since Jan 1, 1900 (with a bug for 1900 leap year)\n    if (typeof dateVal === 'number' && dateVal > 1 && dateVal < 100000) {\n      // Excel serial date: days since Dec 30, 1899 (accounting for Excel's leap year bug)\n      const excelEpoch = new Date(1899, 11, 30); // Dec 30, 1899\n      const result = new Date(excelEpoch.getTime() + dateVal * 24 * 60 * 60 * 1000);\n      if (!isNaN(result.getTime()) && result.getFullYear() > 1970) {\n        return result;\n      }\n    }\n    \n    // Try as string\n    const dateStr = String(dateVal);\n    \n    // Try ISO format first\n    let d = new Date(dateStr);\n    if (!isNaN(d.getTime()) && d.getFullYear() > 1970) return d;\n    \n    // Try d-MMM-yyyy format (e.g., \"15-Nov-2025\")\n    const match = dateStr.match(/(\\d{1,2})[-\\s]([A-Za-z]{3})[-\\s](\\d{2,4})/);\n    if (match) {\n      const months = {jan:0,feb:1,mar:2,apr:3,may:4,jun:5,jul:6,aug:7,sep:8,oct:9,nov:10,dec:11};\n      const day = parseInt(match[1]);\n      const month = months[match[2].toLowerCase()];\n      let year = parseInt(match[3]);\n      if (year < 100) year += 2000;\n      if (month !== undefined) {\n        return new Date(year, month, day);\n      }\n    }\n    return null;\n  }\n\n  // Search functionality\n  const searchInput = qs('#searchInput');\n  const searchInputWrap = qs('#searchInputWrap');\n  const searchBtn = qs('#searchBtn');\n  const searchResults = qs('#searchResults');\n  const searchHint = qs('#searchHint');\n  const searchTabs = qsa('.search-tab');\n  let currentSearchMode = 'active'; // Default to active tasks\n\n  // Update search UI based on mode\n  const loadRowHint = qs('#loadRowHint');\n  \n  function updateSearchUI() {\n    if (!searchHint || !searchInput || !searchInputWrap) return;\n    \n    if (currentSearchMode === 'active') {\n      searchInputWrap.style.display = 'none'; // No input needed\n      if (loadRowHint) loadRowHint.style.display = 'none';\n      searchHint.textContent = ' Showing tasks with status: To Do or In Progress';\n    } else if (currentSearchMode === 'company') {\n      searchInputWrap.style.display = 'flex';\n      if (loadRowHint) loadRowHint.style.display = 'flex';\n      searchInput.placeholder = 'Type company name...';\n      searchInput.type = 'text';\n      searchHint.textContent = '';\n    }\n  }\n\n  // Search tab switching\n  searchTabs.forEach(tab => {\n    tab.addEventListener('click', async () => {\n      searchTabs.forEach(t => t.classList.remove('active'));\n      tab.classList.add('active');\n      currentSearchMode = tab.getAttribute('data-search');\n      if (searchInput) {\n        searchInput.value = '';\n      }\n      updateSearchUI();\n      \n      // Auto-load active tasks when that tab is selected\n      if (currentSearchMode === 'active') {\n        await performSearch();\n      } else {\n        // Clear results for other modes until user searches\n        if (searchResults) {\n          searchResults.classList.remove('visible');\n          searchResults.innerHTML = '';\n        }\n      }\n    });\n  });\n\n  // Search button click\n  if (searchBtn) {\n    searchBtn.addEventListener('click', async () => {\n      await performSearch();\n    });\n  }\n\n  // Enter key in search input\n  if (searchInput) {\n    searchInput.addEventListener('keypress', async (e) => {\n      if (e.key === 'Enter') {\n        hideAutocomplete();\n        await performSearch();\n      }\n    });\n  }\n\n  // Autocomplete for company search\n  const autocompleteDropdown = qs('#autocompleteDropdown');\n  let companyList = []; // Cache of all companies with row numbers\n  let autocompleteTimeout = null;\n\n  // Load all companies for autocomplete (includes ALL rows, not just unique companies)\n  async function loadCompanyList() {\n    if (companyList.length > 0) return; // Already loaded\n    try {\n      await Excel.run(async (context) => {\n        const sheet = context.workbook.worksheets.getItemOrNullObject('TASK MANAGER FORM');\n        sheet.load('name');\n        await context.sync();\n        if (sheet.isNullObject) return;\n\n        // Load columns A (company) and B (task category) to differentiate multiple rows\n        const dataRange = sheet.getRange('A2:B5000');\n        dataRange.load('values');\n        await context.sync();\n\n        const values = dataRange.values || [];\n        companyList = [];\n        for (let i = 0; i < values.length; i++) {\n          const name = values[i][0] ? String(values[i][0]).trim() : '';\n          const category = values[i][1] ? String(values[i][1]).trim() : '';\n          if (name) {\n            companyList.push({ name, category, rowNum: i + 2 });\n          }\n        }\n        // Keep ALL entries - don't remove duplicates so users can see all tasks for a company\n        console.log('Loaded', companyList.length, 'company rows for autocomplete');\n      });\n    } catch (e) {\n      console.error('Failed to load company list:', e);\n    }\n  }\n\n  function showAutocomplete(query) {\n    if (!autocompleteDropdown || !query || currentSearchMode !== 'company') {\n      hideAutocomplete();\n      return;\n    }\n    const q = query.toLowerCase();\n    \n    // Filter matches and sort: companies starting with query first, then contains\n    const allMatches = companyList.filter(c => c.name.toLowerCase().includes(q));\n    const startsWithMatches = allMatches.filter(c => c.name.toLowerCase().startsWith(q));\n    const containsMatches = allMatches.filter(c => !c.name.toLowerCase().startsWith(q));\n    const sortedMatches = [...startsWithMatches, ...containsMatches].slice(0, 15);\n    \n    if (sortedMatches.length === 0) {\n      hideAutocomplete();\n      return;\n    }\n    autocompleteDropdown.innerHTML = sortedMatches.map(c => {\n      const categoryHint = c.category ? `  ${escapeHtml(c.category)}` : '';\n      return `<div class=\"autocomplete-item\" data-row=\"${c.rowNum}\" data-name=\"${escapeHtml(c.name)}\">\n        <span class=\"company-name\">${escapeHtml(c.name)}</span>\n        <span class=\"row-hint\">Row ${c.rowNum}${categoryHint}</span>\n      </div>`;\n    }).join('');\n    autocompleteDropdown.classList.add('visible');\n\n    // Wire click handlers\n    autocompleteDropdown.querySelectorAll('.autocomplete-item').forEach(item => {\n      item.addEventListener('click', async () => {\n        const rowNum = parseInt(item.getAttribute('data-row'), 10);\n        const name = item.getAttribute('data-name');\n        if (searchInput) searchInput.value = name;\n        hideAutocomplete();\n        await selectAndLoadRow(rowNum);\n      });\n    });\n  }\n\n  function hideAutocomplete() {\n    if (autocompleteDropdown) {\n      autocompleteDropdown.classList.remove('visible');\n      autocompleteDropdown.innerHTML = '';\n    }\n  }\n\n  // Wire autocomplete on input\n  if (searchInput) {\n    searchInput.addEventListener('input', (e) => {\n      if (currentSearchMode !== 'company') return;\n      clearTimeout(autocompleteTimeout);\n      const val = e.target.value.trim();\n      if (val.length < 1) {\n        hideAutocomplete();\n        return;\n      }\n      // Debounce to avoid too many updates\n      autocompleteTimeout = setTimeout(() => {\n        showAutocomplete(val);\n      }, 150);\n    });\n\n    searchInput.addEventListener('focus', async () => {\n      if (currentSearchMode === 'company') {\n        await loadCompanyList();\n        if (searchInput.value.trim().length >= 1) {\n          showAutocomplete(searchInput.value.trim());\n        }\n      }\n    });\n\n    searchInput.addEventListener('blur', () => {\n      // Delay hide to allow click on dropdown\n      setTimeout(hideAutocomplete, 200);\n    });\n  }\n\n  // Initialize search UI on load\n  updateSearchUI();\n\n  async function performSearch() {\n    if (!searchResults) return;\n    \n    searchResults.innerHTML = '<div class=\"no-results\">Searching...</div>';\n    searchResults.classList.add('visible');\n    console.log('Search started, mode:', currentSearchMode);\n\n    try {\n      await Excel.run(async (context) => {\n        const sheet = context.workbook.worksheets.getItemOrNullObject('TASK MANAGER FORM');\n        sheet.load('name');\n        await context.sync();\n        console.log('Sheet found:', !sheet.isNullObject);\n        if (sheet.isNullObject) {\n          searchResults.innerHTML = '<div class=\"no-results\">Sheet not found</div>';\n          return;\n        }\n\n        // Read a fixed block of rows to avoid issues with usedRange returning too small an area.\n        const maxRows = 5000;\n        const dataRange = sheet.getRange(`A1:K${maxRows}`);\n        dataRange.load('values');\n        await context.sync();\n\n        const rawValues = dataRange.values || [];\n        console.log('Raw rows loaded (including header and blanks):', rawValues.length);\n\n        const values = Array.isArray(rawValues) ? rawValues : [];\n        const results = [];\n        let scannedRows = 0;\n\n        for (let i = 1; i < values.length; i++) { // Skip header row\n          const row = values[i] || [];\n          const isEmpty = row.every(c => c === null || c === '');\n          if (isEmpty) continue;\n          scannedRows++;\n          const companyName = row[0] ? String(row[0]).trim() : '';\n          const taskCategory = row[1] ? String(row[1]).trim() : '';\n          const taskSummary = row[7] ? String(row[7]).trim() : ''; // Column H\n\n          // Determine status and dates from Column H\n          let hasActiveTasks = false;\n          let dominantStatus = 'unknown';\n          let hasTodo = false, hasProgress = false, hasDone = false;\n          let todoDates = [];\n          let progressDates = [];\n          let doneDates = [];\n\n          if (taskSummary) {\n            const lines = taskSummary.split(/\\r?\\n/).filter(Boolean);\n            lines.forEach(line => {\n              const parsed = parseTaskLine(line);\n              if (!parsed) return;\n              const st = (parsed.status || '').toLowerCase();\n              if (st === 'to do') {\n                hasTodo = true;\n                if (parsed.initiated) todoDates.push(parsed.initiated);\n              } else if (st === 'in progress') {\n                hasProgress = true;\n                if (parsed.updated) progressDates.push(parsed.updated);\n              } else if (st === 'done') {\n                hasDone = true;\n                if (parsed.completed) doneDates.push(parsed.completed);\n              }\n            });\n            hasActiveTasks = hasTodo || hasProgress;\n            if (hasProgress) dominantStatus = 'progress';\n            else if (hasTodo) dominantStatus = 'todo';\n            else if (hasDone) dominantStatus = 'done';\n          }\n\n          // Choose a status-specific date to display\n          function mostRecentDate(dateArr) {\n            if (!dateArr || dateArr.length === 0) return '';\n            let best = null;\n            dateArr.forEach(dStr => {\n              if (!dStr) return;\n              const d = new Date(dStr);\n              if (isNaN(d.getTime())) return;\n              if (!best || d > best) best = d;\n            });\n            if (!best) return '';\n            const yyyy = best.getFullYear();\n            const mm = String(best.getMonth() + 1).padStart(2,'0');\n            const dd = String(best.getDate()).padStart(2,'0');\n            return `${yyyy}-${mm}-${dd}`; // normalized for display formatter\n          }\n\n          let statusDateLabel = '';\n          let statusDateRaw = '';\n          if (dominantStatus === 'progress') {\n            statusDateRaw = mostRecentDate(progressDates);\n            statusDateLabel = statusDateRaw ? 'Updated' : '';\n          } else if (dominantStatus === 'todo') {\n            statusDateRaw = mostRecentDate(todoDates);\n            statusDateLabel = statusDateRaw ? 'Initiated' : '';\n          } else if (dominantStatus === 'done') {\n            statusDateRaw = mostRecentDate(doneDates);\n            statusDateLabel = statusDateRaw ? 'Completed' : '';\n          }\n\n          const statusDateDisplay = statusDateRaw ? formatDateForDisplay(statusDateRaw) : '';\n\n          const rowNum = i + 1; // 1-based row number\n\n          if (currentSearchMode === 'company') {\n            const query = (searchInput ? searchInput.value : '').toLowerCase().trim();\n            console.log('Checking row', rowNum, '- Company:', companyName, '- Query:', query);\n            if (query && companyName.toLowerCase().includes(query)) {\n              console.log('Match found:', companyName);\n              results.push({ rowNum, companyName, taskCategory, dominantStatus, hasActiveTasks, statusDateLabel, statusDateDisplay });\n            }\n          } else if (currentSearchMode === 'active') {\n            console.log('Checking row', rowNum, '- Company:', companyName, '- Active:', hasActiveTasks);\n            if (hasActiveTasks) {\n              results.push({ rowNum, companyName, taskCategory, dominantStatus, hasActiveTasks, statusDateLabel, statusDateDisplay });\n            }\n          }\n        }\n\n        const totalRows = scannedRows;\n        const modeLabel = currentSearchMode === 'company' ? 'Company' : 'Active tasks';\n        const rawQuery = (searchInput ? searchInput.value : '').trim();\n        console.log('Search complete, mode:', modeLabel, 'rows scanned:', totalRows, 'matches:', results.length, 'query:', rawQuery);\n        if (results.length === 0) {\n          searchResults.innerHTML = '<div class=\"no-results\">No results found</div>';\n        } else {\n          searchResults.innerHTML = results.map(r => {\n            const statusBadge = r.dominantStatus === 'progress' \n              ? '<span class=\"status-badge progress\">In Progress</span>'\n              : r.dominantStatus === 'todo'\n              ? '<span class=\"status-badge todo\">To Do</span>'\n              : r.dominantStatus === 'done'\n              ? '<span class=\"status-badge done\">Done</span>'\n              : '';\n\n            const datePart = (r.statusDateLabel && r.statusDateDisplay)\n              ? `  ${r.statusDateLabel} ${escapeHtml(r.statusDateDisplay)}`\n              : '';\n\n            return `<div class=\"search-result-item\" data-row=\"${r.rowNum}\">\n              <div class=\"company\">${escapeHtml(r.companyName || '(No name)')}${statusBadge}</div>\n              <div class=\"meta\">Row ${r.rowNum}  ${escapeHtml(r.taskCategory || 'No category')}${datePart}</div>\n            </div>`;\n          }).join('');\n\n          // Wire click handlers\n          searchResults.querySelectorAll('.search-result-item').forEach(item => {\n            item.addEventListener('click', async () => {\n              const rowNum = parseInt(item.getAttribute('data-row'), 10);\n              await selectAndLoadRow(rowNum);\n              searchResults.classList.remove('visible');\n            });\n          });\n        }\n      });\n    } catch (e) {\n      console.error('Search error:', e);\n      searchResults.innerHTML = '<div class=\"no-results\">Search error</div>';\n    }\n  }\n\n  async function selectAndLoadRow(rowNum) {\n    await Excel.run(async (context) => {\n      const sheet = context.workbook.worksheets.getItemOrNullObject('TASK MANAGER FORM');\n      sheet.load('name');\n      await context.sync();\n      if (sheet.isNullObject) return;\n\n      const targetRange = sheet.getRange(`A${rowNum}`);\n      targetRange.select();\n      await context.sync();\n    });\n    await loadFromActiveRow();\n  }\n\n  // Find Last KYC Produced date for a company\n  async function findLastKycDate(companyName) {\n    if (!companyName) return null;\n    \n    return Excel.run(async (context) => {\n      const sheet = context.workbook.worksheets.getItemOrNullObject('TASK MANAGER FORM');\n      sheet.load('name');\n      await context.sync();\n      if (sheet.isNullObject) return null;\n\n      const usedRange = sheet.getUsedRange();\n      usedRange.load('values');\n      await context.sync();\n\n      const values = usedRange.values || [];\n      let lastKycDate = null;\n\n      for (let i = 1; i < values.length; i++) {\n        const row = values[i];\n        const rowCompany = row[0] ? String(row[0]).trim().toLowerCase() : '';\n        const taskSummary = row[7] ? String(row[7]).trim() : ''; // Column H\n\n        if (rowCompany === companyName.toLowerCase() && taskSummary) {\n          // Look for KYC task with Done status\n          const lines = taskSummary.split(/\\r?\\n/).filter(Boolean);\n          lines.forEach(line => {\n            const lower = line.toLowerCase();\n            if ((lower.includes('kyc') && lower.includes(': done'))) {\n              // Try to extract completed date\n              const completedMatch = line.match(/completed:\\s*(\\d{1,2}[-\\s][A-Za-z]{3}[-\\s]\\d{2,4})/i);\n              if (completedMatch) {\n                lastKycDate = completedMatch[1];\n              }\n            }\n          });\n        }\n      }\n      return lastKycDate;\n    });\n  }\n\n  // Format date as d-MMM-yyyy (e.g., 1-Jul-2025)\n  // Fix for timezone-related date shift bug\n  // When parsing yyyy-MM-dd strings, JavaScript interprets them as UTC midnight.\n  // This can cause day shifts when converting back to local time.\n  function formatDateForDisplay(dateStr) {\n    if (!dateStr) return '';\n    \n    // Handle yyyy-MM-dd format specially to avoid timezone issues\n    const ymdMatch = String(dateStr).match(/^(\\d{4})-(\\d{2})-(\\d{2})$/);\n    if (ymdMatch) {\n      // Parse components directly to avoid UTC interpretation\n      const year = parseInt(ymdMatch[1], 10);\n      const month = parseInt(ymdMatch[2], 10) - 1; // 0-indexed\n      const day = parseInt(ymdMatch[3], 10);\n      const months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];\n      return `${day}-${months[month]}-${year}`;\n    }\n    \n    // For other formats, use Date parsing\n    const d = new Date(dateStr);\n    if (isNaN(d.getTime())) return '';\n    const months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];\n    const day = d.getDate();\n    const month = months[d.getMonth()];\n    const year = d.getFullYear();\n    return `${day}-${month}-${year}`;\n  }\n  \n  // Alias for Excel output (same format)\n  const formatDateForExcel = formatDateForDisplay;\n\n  // Get selected task categories\n  function getSelectedCategories() {\n    return qsa('#taskCategories .category-toggle:checked').map(cb => cb.value);\n  }\n\n  // Check if \"Other Task\" is selected\n  function isOtherTaskSelected() {\n    const cb = qs('#taskCategories .category-toggle[value=\"Other Task\"]');\n    return cb && cb.checked;\n  }\n\n  function getTaskCard(taskName){\n    // __other__ card is now outside #taskCards\n    if (taskName === '__other__') {\n      return qs('#otherTaskCard');\n    }\n    return taskCardsContainer ? taskCardsContainer.querySelector(`.task-card[data-task=\"${taskName}\"]`) : null;\n  }\n\n  function getTaskStatusChips(card){\n    if (!card) return [];\n    const container = card.querySelector('[data-role=\"status-chips\"]');\n    return container ? Array.from(container.querySelectorAll('.chip')) : [];\n  }\n\n  function setCardStatus(card, val){\n    const chips = getTaskStatusChips(card);\n    chips.forEach(c=>{\n      c.classList.toggle('active', c.getAttribute('data-value')===val);\n    });\n  }\n\n  function getCardStatus(card){\n    const chips = getTaskStatusChips(card);\n    const active = chips.find(c=>c.classList.contains('active'));\n    return active ? active.getAttribute('data-value') : 'To Do';\n  }\n\n  function wireCardChips(){\n    // Wire chips in #taskCards and #otherTaskCard\n    qsa('#taskCards [data-role=\"status-chips\"] .chip, #otherTaskCard [data-role=\"status-chips\"] .chip').forEach(chip => {\n      chip.addEventListener('click', () => {\n        const container = chip.closest('[data-role=\"status-chips\"]');\n        if (!container) return;\n        const siblings = Array.from(container.querySelectorAll('.chip'));\n        siblings.forEach(c=>{\n          c.classList.toggle('active', c === chip);\n        });\n      });\n    });\n  }\n\n  function syncTasksVisibility(){\n    if (!tasksRowEl || !taskCardsContainer) return;\n    const isOther = isOtherTaskSelected();\n    const otherCard = qs('#otherTaskCard'); // Now outside #taskCards\n    const selectedCategories = getSelectedCategories();\n    const hasNonOtherCategory = selectedCategories.some(c => c !== 'Other Task');\n\n    // Show tasks section if any non-\"Other Task\" category is selected\n    if (hasNonOtherCategory) {\n      tasksRowEl.style.display = '';\n    } else {\n      tasksRowEl.style.display = 'none';\n    }\n\n    // Show/hide fixed task cards based on task toggles\n    const selected = new Set(getSelectedTaskToggles());\n    const fixedCards = qsa('#taskCards .task-card');\n    fixedCards.forEach(card => {\n      const name = card.getAttribute('data-task');\n      card.style.display = selected.has(name) ? '' : 'none';\n    });\n\n    // Show __other__ card if \"Other Task\" category is selected\n    if (otherCard) {\n      otherCard.style.display = isOther ? '' : 'none';\n    }\n  }\n\n  // Update Extra Note placeholder based on selected categories\n  function updateExtraNotePlaceholder() {\n    if (!extraNoteEl) return;\n    const categories = getSelectedCategories().filter(c => c !== 'Other Task');\n    if (categories.length === 0) {\n      extraNoteEl.placeholder = 'General note about this task';\n    } else if (categories.length === 1) {\n      extraNoteEl.placeholder = 'General note about this ' + categories[0];\n    } else {\n      extraNoteEl.placeholder = 'General note about these tasks';\n    }\n  }\n\n  // Wire category checkboxes to update visibility and placeholder\n  qsa('#taskCategories .category-toggle').forEach(cb => {\n    cb.addEventListener('change', () => {\n      syncTasksVisibility();\n      updateExtraNotePlaceholder();\n    });\n  });\n\n  function getSelectedTaskToggles(){\n    return qsa('#tasksChecklist .task-toggle:checked').map(cb => cb.value);\n  }\n\n  // Reorder checkboxes so checked ones appear at the top\n  function reorderCheckboxesToTop(containerSelector) {\n    const container = qs(containerSelector);\n    if (!container) return;\n    \n    // Get all items - could be direct children (div wrappers) or labels\n    const items = Array.from(container.children);\n    if (items.length === 0) return;\n    \n    // Sort: checked items first, then unchecked (maintain original order within each group)\n    const checked = [];\n    const unchecked = [];\n    items.forEach(item => {\n      const cb = item.querySelector('input[type=checkbox]') || item.querySelector('input[type=\"checkbox\"]');\n      if (cb && cb.checked) {\n        checked.push(item);\n      } else {\n        unchecked.push(item);\n      }\n    });\n    \n    // Re-append in sorted order: checked first, then unchecked\n    [...checked, ...unchecked].forEach(item => container.appendChild(item));\n  }\n\n  async function loadTeamMembers(){\n    if (teamMembersLoaded) return;\n    teamMembersLoaded = true; // guard immediately to avoid overlapping calls\n    const box = qs('#assignees');\n    if (!box) return;\n    // Additional DOM-level guard in case the script is evaluated more than once\n    if (box.dataset.initialized === '1') {\n      return;\n    }\n    box.dataset.initialized = '1';\n    box.innerHTML='';\n\n    await Excel.run(async (context) => {\n      const sheet = context.workbook.worksheets.getItemOrNullObject('Team members');\n      sheet.load('name');\n      await context.sync();\n      if (sheet.isNullObject) {\n        console.error('Team members sheet not found');\n        return;\n      }\n\n      // Read column A only for team member names\n      const usedRange = sheet.getUsedRange();\n      usedRange.load('values');\n      await context.sync();\n\n      const values = usedRange.values || [];\n      const namesRaw = values.slice(1) // skip header row\n        .map(row => row[0])\n        .filter(n => n && String(n).trim().length > 0)\n        .map(n => String(n).trim());\n\n      const names = Array.from(new Set(namesRaw)); // dedupe\n      console.log('Team members loaded from column A:', names); // Debug log\n\n      names.forEach(n => {\n        const w = document.createElement('div');\n        w.innerHTML = `<label><input type=\"checkbox\" value=\"${n}\"> ${n}</label>`;\n        box.appendChild(w);\n      });\n\n      if (brokerLeadEl) {\n        brokerLeadEl.innerHTML = '';\n        const noneOpt = document.createElement('option');\n        noneOpt.value = '';\n        noneOpt.textContent = '(none)';\n        brokerLeadEl.appendChild(noneOpt);\n        names.forEach(n => {\n          const opt = document.createElement('option');\n          opt.value = n;\n          opt.textContent = n;\n          brokerLeadEl.appendChild(opt);\n        });\n      }\n    });\n  }\n\n  function getSelectedAssignees(){\n    return Array.from(document.querySelectorAll('#assignees input[type=checkbox]:checked')).map(i=>i.value);\n  }\n\n  // Populate per-task assignee dropdowns with selected assignees\n  function updateTaskAssigneeDropdowns() {\n    const selectedAssignees = getSelectedAssignees();\n    const dropdowns = qsa('.task-assignee-select');\n    \n    dropdowns.forEach(dropdown => {\n      const currentValue = dropdown.value;\n      dropdown.innerHTML = '';\n      \n      // Add empty option\n      const emptyOpt = document.createElement('option');\n      emptyOpt.value = '';\n      emptyOpt.textContent = '(Select assignee)';\n      dropdown.appendChild(emptyOpt);\n      \n      // Add selected assignees as options\n      selectedAssignees.forEach(name => {\n        const opt = document.createElement('option');\n        opt.value = name;\n        opt.textContent = name;\n        dropdown.appendChild(opt);\n      });\n      \n      // Auto-select if only one assignee\n      if (selectedAssignees.length === 1) {\n        dropdown.value = selectedAssignees[0];\n      } else if (selectedAssignees.includes(currentValue)) {\n        // Restore previous selection if still valid\n        dropdown.value = currentValue;\n      }\n    });\n  }\n\n  // Wire assignee checkboxes to update per-task dropdowns\n  document.querySelectorAll('#assignees').forEach(container => {\n    container.addEventListener('change', (e) => {\n      if (e.target.type === 'checkbox') {\n        updateTaskAssigneeDropdowns();\n      }\n    });\n  });\n\n  async function getActiveRowIndex(){\n    return Excel.run(async (context) => {\n      // Use the currently selected range in the workbook\n      const range = context.workbook.getSelectedRange();\n      range.load('rowIndex');\n      await context.sync();\n      // rowIndex is 0-based; UI shows 1-based row numbers\n      return range.rowIndex + 1;\n    });\n  }\n\n  function parseTaskLine(raw){\n    // More flexible parsing that handles fields in any order\n    if (!raw) return null;\n    \n    // First, check basic structure: \"TaskName: Status || Assigned to ...\"\n    const basicMatch = /^(.*?)\\s*:\\s*(to do|in progress|done)\\s*\\|\\|\\s*assigned to\\s+([^|]+)/i.exec(raw);\n    if (!basicMatch) return null;\n    \n    const result = {\n      name: basicMatch[1].trim(),\n      status: basicMatch[2],\n      assignee: basicMatch[3].trim(),\n      comment: '',\n      giveUpId: '',\n      initiated: '',\n      updated: '',\n      completed: '',\n      deadline: ''\n    };\n    \n    // Extract optional fields in any order\n    const commentMatch = /\\|\\|\\s*comment:\\s*([^|]+)/i.exec(raw);\n    if (commentMatch) result.comment = commentMatch[1].trim();\n    \n    const giveUpMatch = /\\|\\|\\s*give-up id:\\s*([^|]+)/i.exec(raw);\n    if (giveUpMatch) result.giveUpId = giveUpMatch[1].trim();\n    \n    const initiatedMatch = /\\|\\|\\s*task initiated:\\s*([^|]+)/i.exec(raw);\n    if (initiatedMatch) result.initiated = initiatedMatch[1].trim();\n    \n    const updatedMatch = /\\|\\|\\s*status updated:\\s*([^|]+)/i.exec(raw);\n    if (updatedMatch) result.updated = updatedMatch[1].trim();\n    \n    const completedMatch = /\\|\\|\\s*completed:\\s*([^|]+)/i.exec(raw);\n    if (completedMatch) result.completed = completedMatch[1].trim();\n    \n    const deadlineMatch = /\\|\\|\\s*deadline:\\s*([^|]+)/i.exec(raw);\n    if (deadlineMatch) result.deadline = deadlineMatch[1].trim();\n    \n    return result;\n  }\n\n  function buildSummaryLine(v){\n    const parts = [];\n    const status = v.status || 'To Do';\n    // First segment must match parseTaskLine: \"<TaskName>: <Status>\"\n    parts.push(`${v.name}: ${status}`);\n    parts.push(`Assigned to ${v.assignees}`);\n    if (v.comment) parts.push(`Comment: ${v.comment}`);\n    if (v.giveUpId) parts.push(`Give-up ID: ${v.giveUpId}`);\n    // Only one date field will be set based on status (last action)\n    if (v.initiated) parts.push(`Task initiated: ${v.initiated}`);\n    if (v.updated) parts.push(`Status updated: ${v.updated}`);\n    if (v.completed) parts.push(`Completed: ${v.completed}`);\n    if (v.deadline) parts.push(`Deadline: ${v.deadline}`);\n    return parts.join(' || ');\n  }\n\n  async function loadFromActiveRow(){\n    await loadTeamMembers();\n    await Excel.run(async (context) => {\n      // Get active row within the same context to avoid sync issues\n      const selectedRange = context.workbook.getSelectedRange();\n      selectedRange.load('rowIndex');\n      await context.sync();\n      const uiRow = selectedRange.rowIndex + 1;\n\n      const sheet = context.workbook.worksheets.getItemOrNullObject('TASK MANAGER FORM');\n      sheet.load('name');\n      await context.sync();\n      if (sheet.isNullObject) return;\n\n      // Load row-level metadata and Column H, J, K in one go\n      const companyRange = sheet.getRange(`A${uiRow}`);\n      const descRange = sheet.getRange(`B${uiRow}`);\n      const assigneesRange = sheet.getRange(`C${uiRow}`);\n      const brokerRange = sheet.getRange(`D${uiRow}`);\n      const datesRange = sheet.getRange(`E${uiRow}:G${uiRow}`);\n      const hRange = sheet.getRange(`H${uiRow}`);\n      const jRange = sheet.getRange(`J${uiRow}`);\n      const kRange = sheet.getRange(`K${uiRow}`);\n      companyRange.load('values');\n      descRange.load('values');\n      assigneesRange.load('values');\n      brokerRange.load('values');\n      datesRange.load('values');\n      hRange.load('values');\n      jRange.load('values');\n      kRange.load('values');\n      await context.sync();\n\n      // Company name from column A\n      const companyVal = (companyRange.values && companyRange.values[0] && companyRange.values[0][0])\n        ? String(companyRange.values[0][0])\n        : '';\n      if (companyNameInput) companyNameInput.value = companyVal;\n\n      const descVal = (descRange.values && descRange.values[0] && descRange.values[0][0])\n        ? String(descRange.values[0][0])\n        : '';\n      // Parse comma-separated categories and check the corresponding checkboxes\n      const categories = descVal.split(',').map(s => s.trim()).filter(Boolean);\n      const allowedDescs = ['Onboarding', 'Amended Product/Rate', 'KYC update', 'Other Task'];\n      qsa('#taskCategories .category-toggle').forEach(cb => {\n        const match = categories.some(cat => cat.toLowerCase() === cb.value.toLowerCase());\n        cb.checked = match;\n      });\n\n      const brokerVal = (brokerRange.values && brokerRange.values[0] && brokerRange.values[0][0])\n        ? String(brokerRange.values[0][0])\n        : '';\n\n      if (brokerLeadEl) {\n        brokerLeadEl.value = brokerVal;\n      }\n\n      // Assignees from column C\n      const assigneesVal = (assigneesRange.values && assigneesRange.values[0] && assigneesRange.values[0][0])\n        ? String(assigneesRange.values[0][0])\n        : '';\n      const assigneesList = assigneesVal.split(/[,;]+/).map(s => s.trim().toLowerCase()).filter(Boolean);\n      console.log('Assignees from column C:', assigneesList);\n      document.querySelectorAll('#assignees input[type=checkbox]').forEach(cb => {\n        cb.checked = assigneesList.includes(cb.value.toLowerCase());\n      });\n\n      const datesRow = (datesRange.values && datesRange.values[0]) ? datesRange.values[0] : [null, null, null];\n\n      function toInputDate(v){\n        if (v == null || v === '') return '';\n        \n        // Excel serial number (days since 1900-01-01, with Excel's leap year bug)\n        if (typeof v === 'number') {\n          // Excel serial date: 1 = Jan 1, 1900\n          const excelEpoch = new Date(1899, 11, 30); // Dec 30, 1899 (Excel's day 0)\n          const d = new Date(excelEpoch.getTime() + v * 86400000);\n          const yyyy = d.getFullYear();\n          const mm = String(d.getMonth() + 1).padStart(2,'0');\n          const dd = String(d.getDate()).padStart(2,'0');\n          return `${yyyy}-${mm}-${dd}`;\n        }\n        \n        // Excel usually returns Date objects for date cells\n        if (v instanceof Date) {\n          const yyyy = v.getFullYear();\n          const mm = String(v.getMonth() + 1).padStart(2,'0');\n          const dd = String(v.getDate()).padStart(2,'0');\n          return `${yyyy}-${mm}-${dd}`;\n        }\n        \n        // Handle d-MMM-yyyy format (e.g., \"1-Jul-2025\")\n        const s = String(v).trim();\n        const dmmyMatch = s.match(/^(\\d{1,2})-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\\d{4})$/i);\n        if (dmmyMatch) {\n          const months = {jan:0,feb:1,mar:2,apr:3,may:4,jun:5,jul:6,aug:7,sep:8,oct:9,nov:10,dec:11};\n          const day = parseInt(dmmyMatch[1], 10);\n          const mon = months[dmmyMatch[2].toLowerCase()];\n          const year = parseInt(dmmyMatch[3], 10);\n          const dd = String(day).padStart(2,'0');\n          const mm = String(mon + 1).padStart(2,'0');\n          return `${year}-${mm}-${dd}`;\n        }\n        \n        // Try to parse strings / other values as dates\n        const d = new Date(v);\n        if (!isNaN(d.getTime())) {\n          const yyyy = d.getFullYear();\n          const mm = String(d.getMonth() + 1).padStart(2,'0');\n          const dd = String(d.getDate()).padStart(2,'0');\n          return `${yyyy}-${mm}-${dd}`;\n        }\n        \n        // Fallback: attempt to slice a yyyy-MM-dd looking prefix\n        return s.length >= 10 ? s.slice(0,10) : '';\n      }\n\n      console.log('Date values from Excel:', datesRow); // Debug log\n      if (initialRequestInput) initialRequestInput.value = toInputDate(datesRow[0]);\n      if (introEmailInput) introEmailInput.value = toInputDate(datesRow[1]);\n      if (remindersStartInput) remindersStartInput.value = toInputDate(datesRow[2]);\n      console.log('Parsed dates:', initialRequestInput?.value, introEmailInput?.value, remindersStartInput?.value); // Debug log\n\n      // Email Frequency from column J\n      const freqVal = (jRange.values && jRange.values[0] && jRange.values[0][0])\n        ? String(jRange.values[0][0])\n        : '';\n      if (emailFrequencyEl) emailFrequencyEl.value = freqVal;\n\n      // Extra Note from column K\n      const noteVal = (kRange.values && kRange.values[0] && kRange.values[0][0])\n        ? String(kRange.values[0][0])\n        : '';\n      if (extraNoteEl) extraNoteEl.value = noteVal;\n\n      const summary = (hRange.values && hRange.values[0] && hRange.values[0][0])\n        ? String(hRange.values[0][0])\n        : '';\n\n      // Parse all task lines in H\n      const lines = summary\n        .split(/\\r?\\n/)\n        .map(s => s.trim())\n        .filter(Boolean);\n      const parsedTasks = [];\n      const nonTaskLines = [];\n      for (let i = 0; i < lines.length; i++) {\n        const cand = parseTaskLine(lines[i]);\n        if (cand) {\n          parsedTasks.push(cand);\n        } else {\n          nonTaskLines.push(lines[i]);\n        }\n      }\n\n      // Sort tasks by status priority: To Do > In Progress > Done\n      const statusPriority = { 'to do': 1, 'in progress': 2, 'done': 3 };\n      parsedTasks.sort((a, b) => {\n        const aPriority = statusPriority[(a.status || '').toLowerCase()] || 4;\n        const bPriority = statusPriority[(b.status || '').toLowerCase()] || 4;\n        return aPriority - bPriority;\n      });\n\n      // Note: Assignees are already loaded from Column C (lines 1297-1305)\n      // Column C contains ALL assignees including \"passive\" ones not assigned to specific tasks\n      // We don't overwrite here - the checkboxes are already correctly set from Column C\n      console.log('Parsed tasks:', parsedTasks); // Debug log\n\n      // Update per-task assignee dropdowns with selected assignees\n      updateTaskAssigneeDropdowns();\n\n      // Reset all cards and task selections\n      qsa('#tasksChecklist .task-toggle').forEach(cb => { cb.checked = false; });\n      qsa('#taskCards .task-card, #otherTaskCard').forEach(card => {\n        const statusChips = getTaskStatusChips(card);\n        statusChips.forEach(c => c.classList.remove('active'));\n        const commentEl = card.querySelector('[data-role=\"comment\"]');\n        const deadlineEl = card.querySelector('[data-role=\"deadline\"]');\n        const giveUpIdEl = card.querySelector('[data-role=\"giveUpId\"]');\n        const taskAssigneeEl = card.querySelector('[data-role=\"task-assignee\"]');\n        if (commentEl) commentEl.value = '';\n        if (deadlineEl) deadlineEl.value = '';\n        if (giveUpIdEl) giveUpIdEl.value = '';\n        if (taskAssigneeEl) taskAssigneeEl.value = '';\n      });\n\n      const isOther = isOtherTaskSelected();\n      if (isOther) {\n        // Use __other__ card with first parsed task if present\n        const otherCard = getTaskCard('__other__');\n        if (otherCard) {\n          const t = parsedTasks[0] || null;\n          if (taskNameInput) taskNameInput.value = t && t.name ? t.name : '';\n          if (t) {\n            const sNorm = (t.status || '').toLowerCase();\n            const displayStatus = sNorm === 'in progress' ? 'In Progress'\n              : sNorm === 'done' ? 'Done'\n              : 'To Do';\n            setCardStatus(otherCard, displayStatus);\n            const commentEl = otherCard.querySelector('[data-role=\"comment\"]');\n            const deadlineEl = otherCard.querySelector('[data-role=\"deadline\"]');\n            const taskAssigneeEl = otherCard.querySelector('[data-role=\"task-assignee\"]');\n            if (commentEl) commentEl.value = t.comment || '';\n            if (deadlineEl) deadlineEl.value = (t.deadline || '').slice(0,10);\n            // Set per-task assignee from parsed task\n            if (taskAssigneeEl && t.assignee) {\n              taskAssigneeEl.value = t.assignee.trim();\n            }\n          }\n        }\n      } else {\n        // Fixed tasks: tick checkboxes and populate corresponding cards\n        const toggles = qsa('#tasksChecklist .task-toggle');\n        toggles.forEach(cb => {\n          const name = cb.value;\n          // Map legacy \"KYC (Internal)\" to \"KYC (produced by LCMC)\"\n          const t = parsedTasks.find(pt => {\n            const ptName = (pt.name || '').toLowerCase();\n            const cbName = name.toLowerCase();\n            if (ptName === cbName) return true;\n            // Legacy mapping\n            if (cbName === 'kyc (produced by lcmc)' && ptName === 'kyc (internal)') return true;\n            return false;\n          });\n          cb.checked = !!t;\n          const card = getTaskCard(name);\n          if (card && t) {\n            const sNorm = (t.status || '').toLowerCase();\n            const displayStatus = sNorm === 'in progress' ? 'In Progress'\n              : sNorm === 'done' ? 'Done'\n              : 'To Do';\n            setCardStatus(card, displayStatus);\n            const commentEl = card.querySelector('[data-role=\"comment\"]');\n            const deadlineEl = card.querySelector('[data-role=\"deadline\"]');\n            const giveUpIdEl = card.querySelector('[data-role=\"giveUpId\"]');\n            const taskAssigneeEl = card.querySelector('[data-role=\"task-assignee\"]');\n            if (commentEl) commentEl.value = t.comment || '';\n            if (deadlineEl) deadlineEl.value = (t.deadline || '').slice(0,10);\n            if (giveUpIdEl) giveUpIdEl.value = t.giveUpId || '';\n            // Set per-task assignee from parsed task\n            if (taskAssigneeEl && t.assignee) {\n              taskAssigneeEl.value = t.assignee.trim();\n            }\n          }\n        });\n      }\n\n      // Audit info from the most recently completed/updated task if available\n      if (auditTextEl) {\n        let chosenAudit = null;\n        if (parsedTasks.length > 0) {\n          chosenAudit = parsedTasks[0];\n        }\n        if (chosenAudit) {\n          const parts = [];\n          if (chosenAudit.initiated) parts.push(`Task initiated: ${chosenAudit.initiated}`);\n          if (chosenAudit.updated) parts.push(`Status updated: ${chosenAudit.updated}`);\n          if (chosenAudit.completed) parts.push(`Completed: ${chosenAudit.completed}`);\n          auditTextEl.textContent = parts.join(' | ');\n        } else {\n          auditTextEl.textContent = '';\n        }\n      }\n\n      // Update Last KYC Produced date\n      const lastKycEl = qs('#lastKycDate');\n      if (lastKycEl && companyVal) {\n        // Look for KYC Done status in current row's tasks\n        let kycCompletedDate = null;\n        parsedTasks.forEach(t => {\n          if (t.name && t.name.toLowerCase().includes('kyc') && \n              t.status && t.status.toLowerCase() === 'done' && t.completed) {\n            kycCompletedDate = t.completed;\n          }\n        });\n        if (kycCompletedDate) {\n          lastKycEl.textContent = kycCompletedDate;\n        } else {\n          // Search all rows for this company's last KYC\n          findLastKycDate(companyVal).then(date => {\n            lastKycEl.textContent = date || '';\n          });\n        }\n      } else if (lastKycEl) {\n        lastKycEl.textContent = '';\n      }\n\n      syncTasksVisibility();\n      updateDateDisplays();\n      updateExtraNotePlaceholder();\n      \n      // Reorder checked items to top\n      reorderCheckboxesToTop('#assignees');\n      reorderCheckboxesToTop('#tasksChecklist');\n      reorderCheckboxesToTop('#taskCategories');\n\n      // Track current row number for save logic\n      currentRowNum = uiRow;\n\n      // Apply deadline warnings to task cards\n      applyDeadlineWarnings();\n\n      // Update email summary button state\n      updateEmailSummaryButton();\n\n      // Close email summary section when switching rows\n      if (emailSummarySection) {\n        emailSummarySection.classList.remove('visible');\n      }\n    });\n  }\n\n  async function saveToActiveRow(){\n    const descVal = getSelectedCategories().join(', ');\n    const assignees = getSelectedAssignees().join(', ');\n    const isOther = isOtherTaskSelected();\n    console.log('Saving - Categories:', descVal, 'Assignees:', assignees, 'IsOther:', isOther);\n    await Excel.run(async (context) => {\n      // Get active row within the same context to avoid sync issues\n      const selectedRange = context.workbook.getSelectedRange();\n      selectedRange.load('rowIndex');\n      await context.sync();\n      const uiRow = selectedRange.rowIndex + 1;\n\n      const sheet = context.workbook.worksheets.getItemOrNullObject('TASK MANAGER FORM');\n      sheet.load('name');\n      await context.sync();\n      if (sheet.isNullObject) return;\n\n      // Persist row-level dates (E-G)\n      const datesRange = sheet.getRange(`E${uiRow}:G${uiRow}`);\n      datesRange.load('values');\n\n      // Persist company name (A), task category (B), assignees (C), broker lead (D)\n      const companyRange = sheet.getRange(`A${uiRow}`);\n      const descRange = sheet.getRange(`B${uiRow}`);\n      const assigneesRange = sheet.getRange(`C${uiRow}`);\n      const brokerRange = sheet.getRange(`D${uiRow}`);\n\n      const hRange = sheet.getRange(`H${uiRow}`);\n      const jRange = sheet.getRange(`J${uiRow}`);\n      const kRange = sheet.getRange(`K${uiRow}`);\n      hRange.load('values');\n      await context.sync();\n\n      const datesRow = (datesRange.values && datesRange.values[0]) ? datesRange.values[0] : [null,null,null];\n\n      // Format dates as d-MMM-yyyy for Excel display\n      if (initialRequestInput) datesRow[0] = formatDateForExcel(initialRequestInput.value);\n      if (introEmailInput) datesRow[1] = formatDateForExcel(introEmailInput.value);\n      if (remindersStartInput) datesRow[2] = formatDateForExcel(remindersStartInput.value);\n\n      datesRange.values = [datesRow];\n\n      descRange.values = [[descVal]];\n\n      if (brokerLeadEl) {\n        brokerRange.values = [[brokerLeadEl.value || '']];\n      }\n\n      if (companyNameInput) {\n        companyRange.values = [[companyNameInput.value || '']];\n      }\n\n      // Save assignees to Column C\n      assigneesRange.values = [[assignees]];\n      console.log('Saving assignees to column C:', assignees);\n\n      // Save Email Frequency (J) and Extra Note (K)\n      if (emailFrequencyEl) {\n        jRange.values = [[emailFrequencyEl.value || '']];\n      }\n      if (extraNoteEl) {\n        kRange.values = [[extraNoteEl.value || '']];\n      }\n\n      const existing = (hRange.values && hRange.values[0] && hRange.values[0][0])\n        ? String(hRange.values[0][0])\n        : '';\n\n      const lines = existing\n        .split(/\\r?\\n/)\n        .map(s => s.trim())\n        .filter(Boolean);\n\n      const nonTaskLines = lines.filter(l => !parseTaskLine(l));\n      const newTaskLines = [];\n\n      // Parse existing tasks to preserve dates\n      const existingTasks = {};\n      lines.forEach(l => {\n        const parsed = parseTaskLine(l);\n        if (parsed) {\n          existingTasks[parsed.name.toLowerCase()] = parsed;\n        }\n      });\n\n      // Helper to get today's date in d-MMM-yyyy format\n      const getTodayFormatted = () => {\n        const d = new Date();\n        const months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];\n        return `${String(d.getDate()).padStart(2,'0')} ${months[d.getMonth()]} ${String(d.getFullYear()).slice(-2)}`;\n      };\n\n      // Helper to compute dates based on status and existing task\n      // Only show ONE date field based on current status (last action):\n      // - To Do: Task initiated\n      // - In Progress: Status updated\n      // - Done: Completed\n      const computeDates = (name, newStatus, existingTask) => {\n        const today = getTodayFormatted();\n        const oldStatus = existingTask ? (existingTask.status || '').toLowerCase() : '';\n        const newStatusLower = (newStatus || '').toLowerCase();\n        \n        // Preserve existing dates (use empty string if not present)\n        let initiated = (existingTask && existingTask.initiated) ? existingTask.initiated : '';\n        let updated = (existingTask && existingTask.updated) ? existingTask.updated : '';\n        let completed = (existingTask && existingTask.completed) ? existingTask.completed : '';\n        \n        // Check if this task has ANY date - if not, it's effectively new\n        const hasAnyDate = initiated || updated || completed;\n\n        // Update the relevant date based on status\n        // We show only ONE date field based on current status (last action)\n        if (newStatusLower === 'to do') {\n          // For To Do: always show initiated date\n          initiated = initiated || today;\n          // Clear other dates for display\n          updated = '';\n          completed = '';\n        } else if (newStatusLower === 'in progress') {\n          // For In Progress: set updated date if new or status changed\n          if (!hasAnyDate || oldStatus !== newStatusLower) {\n            updated = today;\n          }\n          // Clear other dates for display\n          initiated = '';\n          completed = '';\n        } else if (newStatusLower === 'done') {\n          // For Done: set completed date if new or status changed\n          if (!hasAnyDate || !completed || oldStatus !== newStatusLower) {\n            completed = today;\n          }\n          // Clear other dates for display\n          initiated = '';\n          updated = '';\n        }\n\n        return { initiated, updated, completed };\n      };\n\n      if (isOther) {\n        const otherCard = getTaskCard('__other__');\n        const name = taskNameInput ? taskNameInput.value.trim() : '';\n        if (name) {\n          const status = getCardStatus(otherCard) || 'To Do';\n          const commentEl = otherCard ? otherCard.querySelector('[data-role=\"comment\"]') : null;\n          const deadlineEl = otherCard ? otherCard.querySelector('[data-role=\"deadline\"]') : null;\n          const taskAssigneeEl = otherCard ? otherCard.querySelector('[data-role=\"task-assignee\"]') : null;\n          // Use per-task assignee if set, otherwise fall back to global assignees\n          const taskAssignee = taskAssigneeEl && taskAssigneeEl.value ? taskAssigneeEl.value : assignees;\n          \n          // Look up existing task to preserve dates\n          const existingTask = existingTasks[name.toLowerCase()];\n          const dates = computeDates(name, status, existingTask);\n          \n          const payload = {\n            name,\n            status,\n            assignees: taskAssignee,\n            comment: commentEl ? commentEl.value.trim() : '',\n            giveUpId: '',\n            initiated: dates.initiated,\n            updated: dates.updated,\n            completed: dates.completed,\n            deadline: deadlineEl ? deadlineEl.value : ''\n          };\n          const builtLine = buildSummaryLine(payload);\n          newTaskLines.push({ line: builtLine, status });\n        }\n      } else {\n        const toggles = getSelectedTaskToggles();\n        const fixedNames = ['Broker Agreement','Give-up Agreement','Amend Annex A','KYC (produced by LCMC)','KYC External'];\n        toggles.forEach(name => {\n          if (!fixedNames.includes(name)) return;\n          const card = getTaskCard(name);\n          if (!card) return;\n          const status = getCardStatus(card);\n          const commentEl = card.querySelector('[data-role=\"comment\"]');\n          const deadlineEl = card.querySelector('[data-role=\"deadline\"]');\n          const giveUpIdEl = card.querySelector('[data-role=\"giveUpId\"]');\n          const taskAssigneeEl = card.querySelector('[data-role=\"task-assignee\"]');\n          // Use per-task assignee if set, otherwise fall back to global assignees\n          const taskAssignee = taskAssigneeEl && taskAssigneeEl.value ? taskAssigneeEl.value : assignees;\n          \n          // Look up existing task to preserve dates (handle legacy KYC name)\n          let existingTask = existingTasks[name.toLowerCase()];\n          if (!existingTask && name.toLowerCase() === 'kyc (produced by lcmc)') {\n            existingTask = existingTasks['kyc (internal)'];\n          }\n          const dates = computeDates(name, status, existingTask);\n          \n          const payload = {\n            name,\n            status,\n            assignees: taskAssignee,\n            comment: commentEl ? commentEl.value.trim() : '',\n            giveUpId: giveUpIdEl ? giveUpIdEl.value.trim() : '',\n            initiated: dates.initiated,\n            updated: dates.updated,\n            completed: dates.completed,\n            deadline: deadlineEl ? deadlineEl.value : ''\n          };\n          newTaskLines.push({ line: buildSummaryLine(payload), status });\n        });\n      }\n\n      // Sort task lines by status priority: To Do > In Progress > Done\n      const statusPriority = { 'to do': 1, 'in progress': 2, 'done': 3 };\n      newTaskLines.sort((a, b) => {\n        const aPriority = statusPriority[(a.status || '').toLowerCase()] || 4;\n        const bPriority = statusPriority[(b.status || '').toLowerCase()] || 4;\n        return aPriority - bPriority;\n      });\n      const sortedLines = newTaskLines.map(t => t.line);\n\n      const newValue = nonTaskLines.concat(sortedLines).filter(Boolean).join('\\n');\n      console.log('Saving to H - newTaskLines:', sortedLines, 'newValue:', newValue);\n\n      hRange.values = [[newValue]];\n\n      // Apply font color based on status priority: In Progress > To Do > Done\n      // Since Excel.js can't do per-line colors, use the \"most urgent\" status\n      if (sortedLines.length > 0) {\n        let hasInProgress = false;\n        let hasToDo = false;\n        let hasDone = false;\n        \n        sortedLines.forEach(line => {\n          const lower = line.toLowerCase();\n          if (lower.includes(': in progress')) hasInProgress = true;\n          else if (lower.includes(': to do')) hasToDo = true;\n          else if (lower.includes(': done')) hasDone = true;\n        });\n        \n        // Priority: In Progress (orange) > To Do (green) > Done (red)\n        // Use original Google Sheet colours: To Do #34a853, In Progress #ff9900, Done #cc6666\n        let fontColor;\n        if (hasInProgress) {\n          fontColor = '#ff9900'; // In Progress (orange)\n        } else if (hasToDo) {\n          fontColor = '#34a853'; // To Do (green)\n        } else if (hasDone) {\n          fontColor = '#cc6666'; // Done (soft red)\n        } else {\n          fontColor = '#34a853'; // default green\n        }\n        hRange.format.font.color = fontColor;\n      }\n\n      await context.sync();\n      console.log('Save completed successfully for row', uiRow);\n    });\n  }\n\n  // Clear form for a fresh new task entry\n  function clearFormForNewTask() {\n    // Clear company name\n    if (companyNameInput) companyNameInput.value = '';\n    \n    // Reset task category checkboxes\n    qsa('#taskCategories .category-toggle').forEach(cb => {\n      cb.checked = false;\n    });\n    \n    // Clear broker lead\n    if (brokerLeadEl) brokerLeadEl.value = '';\n    \n    // Clear all assignee checkboxes\n    document.querySelectorAll('#assignees input[type=checkbox]').forEach(cb => {\n      cb.checked = false;\n    });\n    \n    // Clear dates\n    if (initialRequestInput) initialRequestInput.value = '';\n    if (introEmailInput) introEmailInput.value = '';\n    if (remindersStartInput) remindersStartInput.value = '';\n    \n    // Clear email frequency and extra note\n    if (emailFrequencyEl) emailFrequencyEl.value = '';\n    if (extraNoteEl) extraNoteEl.value = '';\n    \n    // Uncheck all task toggles\n    qsa('#tasksChecklist .task-toggle').forEach(cb => {\n      cb.checked = false;\n    });\n    \n    // Reset all task cards (including Other Task card)\n    qsa('#taskCards .task-card, #otherTaskCard').forEach(card => {\n      // Reset status chips\n      const chips = card.querySelectorAll('[data-role=\"status-chips\"] .chip');\n      chips.forEach(c => c.classList.remove('active'));\n      \n      // Clear comment\n      const commentEl = card.querySelector('[data-role=\"comment\"]');\n      if (commentEl) commentEl.value = '';\n      \n      // Clear deadline\n      const deadlineEl = card.querySelector('[data-role=\"deadline\"]');\n      if (deadlineEl) deadlineEl.value = '';\n      \n      // Clear give-up ID\n      const giveUpIdEl = card.querySelector('[data-role=\"giveUpId\"]');\n      if (giveUpIdEl) giveUpIdEl.value = '';\n      \n      // Clear per-task assignee\n      const taskAssigneeEl = card.querySelector('[data-role=\"task-assignee\"]');\n      if (taskAssigneeEl) taskAssigneeEl.value = '';\n    });\n    \n    // Clear other task name\n    if (taskNameInput) taskNameInput.value = '';\n    \n    // Clear audit text\n    if (auditTextEl) auditTextEl.textContent = '';\n    \n    // Clear Last KYC date\n    const lastKycEl = qs('#lastKycDate');\n    if (lastKycEl) lastKycEl.textContent = '';\n    \n    // Clear search results\n    if (searchResults) {\n      searchResults.classList.remove('visible');\n      searchResults.innerHTML = '';\n    }\n\n    // Close email summary section\n    if (emailSummarySection) {\n      emailSummarySection.classList.remove('visible');\n    }\n\n    // Mark as new task for save logic\n    currentRowNum = 'new';\n\n    // Update email summary button state\n    updateEmailSummaryButton();\n    \n    // Clear date displays\n    updateDateDisplays();\n    \n    // Update visibility and placeholder\n    syncTasksVisibility();\n    updateExtraNotePlaceholder();\n\n    // Autofocus first visible task comment field after a short delay\n    setTimeout(() => {\n      const visibleCard = document.querySelector('#taskCards .task-card:not([style*=\"display: none\"]), #otherTaskCard:not([style*=\"display: none\"])');\n      if (visibleCard) {\n        const commentEl = visibleCard.querySelector('[data-role=\"comment\"]');\n        if (commentEl && typeof commentEl.focus === 'function') {\n          commentEl.focus();\n        }\n      }\n    }, 100);\n  }\n\n  // Delete the current row from Excel\n  async function deleteCurrentRow() {\n    if (currentRowNum === null || currentRowNum === 'new') {\n      throw new Error('No row to delete');\n    }\n    \n    await Excel.run(async (context) => {\n      const sheet = context.workbook.worksheets.getItemOrNullObject('TASK MANAGER FORM');\n      sheet.load('name');\n      await context.sync();\n      \n      if (sheet.isNullObject) {\n        throw new Error('Sheet TASK MANAGER FORM not found');\n      }\n      \n      // Delete the entire row\n      const rowRange = sheet.getRange(`${currentRowNum}:${currentRowNum}`);\n      rowRange.delete(Excel.DeleteShiftDirection.up);\n      \n      await context.sync();\n      console.log('Deleted row', currentRowNum);\n    });\n  }\n\n  // Add a new task to the next available row\n  async function addNewTask() {\n    await Excel.run(async (context) => {\n      const sheet = context.workbook.worksheets.getItemOrNullObject('TASK MANAGER FORM');\n      sheet.load('name');\n      await context.sync();\n      if (sheet.isNullObject) {\n        console.error('Sheet TASK MANAGER FORM not found');\n        return;\n      }\n\n      // Find the first empty row by scanning column A from row 2 onwards\n      const colA = sheet.getRange('A2:A1000');\n      colA.load('values');\n      await context.sync();\n\n      let nextRow = 2; // Start from row 2 (after header)\n      const values = colA.values || [];\n      for (let i = 0; i < values.length; i++) {\n        if (values[i][0] && String(values[i][0]).trim() !== '') {\n          nextRow = i + 3; // i is 0-indexed, row 2 is first data row, so next empty is i+2+1\n        } else {\n          // Found an empty cell\n          nextRow = i + 2; // i is 0-indexed from row 2\n          break;\n        }\n      }\n\n      // Collect current form data\n      const companyVal = companyNameInput ? companyNameInput.value.trim() : '';\n      const descVal = getSelectedCategories().join(', ');\n      const isOther = isOtherTaskSelected();\n      const brokerVal = brokerLeadEl ? brokerLeadEl.value : '';\n      const assignees = getSelectedAssignees().join(', ');\n\n      // Write company name to column A\n      sheet.getRange(`A${nextRow}`).values = [[companyVal]];\n      // Write task category to column B\n      sheet.getRange(`B${nextRow}`).values = [[descVal]];\n      // Write assignees to column C\n      sheet.getRange(`C${nextRow}`).values = [[assignees]];\n      // Write broker lead to column D\n      sheet.getRange(`D${nextRow}`).values = [[brokerVal]];\n\n      // Write dates to columns E, F, G\n      const dateE = formatDateForExcel(initialRequestInput ? initialRequestInput.value : '');\n      const dateF = formatDateForExcel(introEmailInput ? introEmailInput.value : '');\n      const dateG = formatDateForExcel(remindersStartInput ? remindersStartInput.value : '');\n      sheet.getRange(`E${nextRow}:G${nextRow}`).values = [[dateE, dateF, dateG]];\n\n      // Write Email Frequency (J) and Extra Note (K)\n      sheet.getRange(`J${nextRow}`).values = [[emailFrequencyEl ? emailFrequencyEl.value : '']];\n      sheet.getRange(`K${nextRow}`).values = [[extraNoteEl ? extraNoteEl.value : '']];\n\n      // Helper to get today's date in d-MMM-yy format\n      const getTodayFormatted = () => {\n        const d = new Date();\n        const months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];\n        return `${String(d.getDate()).padStart(2,'0')} ${months[d.getMonth()]} ${String(d.getFullYear()).slice(-2)}`;\n      };\n      const today = getTodayFormatted();\n\n      // Build Column H from selected tasks\n      const newTaskLines = [];\n      if (isOther) {\n        const otherCard = getTaskCard('__other__');\n        const name = taskNameInput ? taskNameInput.value.trim() : '';\n        if (name) {\n          const status = getCardStatus(otherCard) || 'To Do';\n          const commentEl = otherCard ? otherCard.querySelector('[data-role=\"comment\"]') : null;\n          const deadlineEl = otherCard ? otherCard.querySelector('[data-role=\"deadline\"]') : null;\n          const taskAssigneeEl = otherCard ? otherCard.querySelector('[data-role=\"task-assignee\"]') : null;\n          const taskAssignee = taskAssigneeEl && taskAssigneeEl.value ? taskAssigneeEl.value : assignees;\n          \n          // Set date based on status for new task\n          let initiated = '', updated = '', completed = '';\n          const statusLower = status.toLowerCase();\n          if (statusLower === 'to do') {\n            initiated = today;\n          } else if (statusLower === 'in progress') {\n            updated = today;\n          } else if (statusLower === 'done') {\n            completed = today;\n          }\n          \n          const payload = {\n            name,\n            status,\n            assignees: taskAssignee,\n            comment: commentEl ? commentEl.value.trim() : '',\n            giveUpId: '',\n            initiated,\n            updated,\n            completed,\n            deadline: deadlineEl ? deadlineEl.value : ''\n          };\n          newTaskLines.push(buildSummaryLine(payload));\n        }\n      } else {\n        const toggles = getSelectedTaskToggles();\n        const fixedNames = ['Broker Agreement','Give-up Agreement','Amend Annex A','KYC (produced by LCMC)','KYC External'];\n        toggles.forEach(name => {\n          if (!fixedNames.includes(name)) return;\n          const card = getTaskCard(name);\n          if (!card) return;\n          const status = getCardStatus(card) || 'To Do';\n          const commentEl = card.querySelector('[data-role=\"comment\"]');\n          const deadlineEl = card.querySelector('[data-role=\"deadline\"]');\n          const giveUpIdEl = card.querySelector('[data-role=\"giveUpId\"]');\n          const taskAssigneeEl = card.querySelector('[data-role=\"task-assignee\"]');\n          const taskAssignee = taskAssigneeEl && taskAssigneeEl.value ? taskAssigneeEl.value : assignees;\n          \n          // Set date based on status for new task\n          let initiated = '', updated = '', completed = '';\n          const statusLower = status.toLowerCase();\n          if (statusLower === 'to do') {\n            initiated = today;\n          } else if (statusLower === 'in progress') {\n            updated = today;\n          } else if (statusLower === 'done') {\n            completed = today;\n          }\n          \n          const payload = {\n            name,\n            status,\n            assignees: taskAssignee,\n            comment: commentEl ? commentEl.value.trim() : '',\n            giveUpId: giveUpIdEl ? giveUpIdEl.value.trim() : '',\n            initiated,\n            updated,\n            completed,\n            deadline: deadlineEl ? deadlineEl.value : ''\n          };\n          newTaskLines.push(buildSummaryLine(payload));\n        });\n      }\n\n      const hRangeNew = sheet.getRange(`H${nextRow}`);\n      hRangeNew.values = [[newTaskLines.join('\\n')]];\n\n      // Apply font color based on status priority: In Progress > To Do > Done\n      // Use original Google Sheet colours: To Do #34a853, In Progress #ff9900, Done #cc6666\n      if (newTaskLines.length > 0) {\n        let hasInProgress = false;\n        let hasToDo = false;\n        let hasDone = false;\n        \n        newTaskLines.forEach(line => {\n          const lower = line.toLowerCase();\n          if (lower.includes(': in progress')) hasInProgress = true;\n          else if (lower.includes(': to do')) hasToDo = true;\n          else if (lower.includes(': done')) hasDone = true;\n        });\n        \n        let fontColor;\n        if (hasInProgress) {\n          fontColor = '#ff9900'; // In Progress (orange)\n        } else if (hasToDo) {\n          fontColor = '#34a853'; // To Do (green)\n        } else if (hasDone) {\n          fontColor = '#cc6666'; // Done (soft red)\n        } else {\n          fontColor = '#34a853'; // default green\n        }\n        hRangeNew.format.font.color = fontColor;\n      }\n\n      await context.sync();\n\n      // Select the new row so user can see it\n      const newRowRange = sheet.getRange(`A${nextRow}`);\n      newRowRange.select();\n      await context.sync();\n\n      // Update current row number for save logic\n      currentRowNum = nextRow;\n    });\n  }\n\n  // Update date display helpers to show d-MMM-yyyy format\n  function updateDateDisplays() {\n    const dateFields = [\n      { input: '#initialRequest', display: '#initialRequestDisplay' },\n      { input: '#introEmail', display: '#introEmailDisplay' },\n      { input: '#remindersStart', display: '#remindersStartDisplay' }\n    ];\n    dateFields.forEach(({ input, display }) => {\n      const inputEl = qs(input);\n      const displayEl = qs(display);\n      if (inputEl && displayEl) {\n        const formatted = formatDateForDisplay(inputEl.value);\n        displayEl.textContent = formatted ? ` ${formatted}` : '';\n      }\n    });\n  }\n\n  // Wire date inputs to update displays\n  function wireDateInputs() {\n    const dateInputs = ['#initialRequest', '#introEmail', '#remindersStart'];\n    dateInputs.forEach(selector => {\n      const el = qs(selector);\n      if (el) {\n        el.addEventListener('change', updateDateDisplays);\n      }\n    });\n  }\n\n  // Wire deadline inputs to update warnings\n  function wireDeadlineInputs() {\n    qsa('[data-role=\"deadline\"]').forEach(input => {\n      input.addEventListener('change', () => {\n        applyDeadlineWarnings();\n      });\n    });\n  }\n\n  // ============== Email Summary Integration ==============\n\n  const emailSummaryBtn = qs('#viewEmailSummaryBtn');\n  const emailSummarySection = qs('#emailSummarySection');\n  const emailSummaryList = qs('#emailSummaryList');\n  const emailSummaryCount = qs('#emailSummaryCount');\n  const closeEmailSummaryBtn = qs('#closeEmailSummaryBtn');\n\n  // Update email summary button state based on company name\n  function updateEmailSummaryButton() {\n    const company = companyNameInput ? companyNameInput.value.trim() : '';\n    if (emailSummaryBtn) {\n      emailSummaryBtn.disabled = !company;\n    }\n  }\n\n  // Wire company name input to update button state\n  if (companyNameInput) {\n    companyNameInput.addEventListener('input', updateEmailSummaryButton);\n    companyNameInput.addEventListener('change', updateEmailSummaryButton);\n  }\n\n  // Wire email summary button click\n  if (emailSummaryBtn) {\n    emailSummaryBtn.addEventListener('click', async () => {\n      await loadEmailSummaries();\n    });\n  }\n\n  // Wire close button\n  if (closeEmailSummaryBtn) {\n    closeEmailSummaryBtn.addEventListener('click', () => {\n      if (emailSummarySection) {\n        emailSummarySection.classList.remove('visible');\n      }\n    });\n  }\n\n  // Load email summaries from the API\n  async function loadEmailSummaries() {\n    const company = companyNameInput ? companyNameInput.value.trim() : '';\n    if (!company) {\n      showToast('No company name entered', 'error');\n      return;\n    }\n\n    // Show the section with loading state\n    if (emailSummarySection) {\n      emailSummarySection.classList.add('visible');\n    }\n    if (emailSummaryList) {\n      emailSummaryList.innerHTML = '<div class=\"email-loading\">Loading summaries...</div>';\n    }\n\n    try {\n      const response = await fetch(\n        `${EMAIL_SUMMARIZER_API_URL}/api/task-manager/summaries/${encodeURIComponent(company)}?include_drafts=true`\n      );\n\n      if (!response.ok) {\n        throw new Error(`Server returned ${response.status}`);\n      }\n\n      const data = await response.json();\n      const summaries = data.summaries || [];\n\n      // Update count badge\n      if (emailSummaryCount) {\n        emailSummaryCount.textContent = summaries.length;\n      }\n\n      // Render summaries\n      if (summaries.length === 0) {\n        emailSummaryList.innerHTML = '<div class=\"email-no-summaries\">No email summaries found for this company.</div>';\n        return;\n      }\n\n      emailSummaryList.innerHTML = summaries.map(s => `\n        <div class=\"email-summary-item ${s.is_draft ? 'draft' : 'confirmed'}\" data-id=\"${s.id}\">\n          <div class=\"email-summary-subject\">\n            ${escapeHtml(s.subject || 'No subject')}\n            ${s.is_draft ? '<span class=\"draft-badge\">Draft</span>' : ''}\n          </div>\n          <div class=\"email-summary-meta\">\n            From: ${escapeHtml(s.from || 'Unknown')} | ${formatEmailDate(s.date)}\n          </div>\n          <div class=\"email-summary-text\">${escapeHtml(s.summary || 'No summary available')}</div>\n          ${s.is_draft ? `\n            <div class=\"email-summary-actions\">\n              <button class=\"btn-confirm-summary\" onclick=\"window.confirmEmailSummary(${s.id})\">\n                 Confirm & Link to Task\n              </button>\n            </div>\n          ` : ''}\n        </div>\n      `).join('');\n\n    } catch (err) {\n      console.error('Error loading email summaries:', err);\n      if (emailSummaryList) {\n        emailSummaryList.innerHTML = `<div class=\"email-no-summaries\">Error loading summaries: ${escapeHtml(err.message)}<br><small>Make sure the Email Summarizer service is running.</small></div>`;\n      }\n    }\n  }\n\n  // Format date for display\n  function formatEmailDate(dateStr) {\n    if (!dateStr) return 'Unknown date';\n    try {\n      const d = new Date(dateStr);\n      if (isNaN(d.getTime())) return dateStr;\n      return d.toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' });\n    } catch (e) {\n      return dateStr;\n    }\n  }\n\n  // Confirm a draft summary and link it to the current task\n  window.confirmEmailSummary = async function(summaryId) {\n    if (currentRowNum === null || currentRowNum === 'new') {\n      showToast('Please save the task first', 'error');\n      return;\n    }\n\n    try {\n      // Call the API to confirm the summary\n      const response = await fetch(`${EMAIL_SUMMARIZER_API_URL}/api/task-manager/confirm/${summaryId}`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ task_row: currentRowNum })\n      });\n\n      if (!response.ok) {\n        throw new Error(`Server returned ${response.status}`);\n      }\n\n      // Write summary reference to column L in Excel\n      await Excel.run(async (context) => {\n        const sheet = context.workbook.worksheets.getItemOrNullObject('TASK MANAGER FORM');\n        sheet.load('name');\n        await context.sync();\n\n        if (sheet.isNullObject) {\n          throw new Error('Sheet not found');\n        }\n\n        const cell = sheet.getRange(`L${currentRowNum}`);\n        cell.load('values');\n        await context.sync();\n\n        // Append or create new reference\n        const existing = (cell.values && cell.values[0] && cell.values[0][0])\n          ? String(cell.values[0][0])\n          : '';\n        const newRef = `[Email Summary #${summaryId}]`;\n        cell.values = [[existing ? `${existing} ${newRef}` : newRef]];\n        await context.sync();\n      });\n\n      showToast('Summary confirmed and linked!', 'success');\n\n      // Reload summaries to reflect the change\n      await loadEmailSummaries();\n\n    } catch (err) {\n      console.error('Error confirming summary:', err);\n      showToast('Error confirming summary: ' + err.message, 'error');\n    }\n  };\n\n  // Initial load when Office host is ready\n  if (typeof Office !== 'undefined' && typeof Office.onReady === 'function') {\n  \n      Office.onReady((info) => {\n        if (info.host === Office.HostType.Excel) {\n          wireCardChips();\n          wireDateInputs();\n          wireDeadlineInputs(); // Wire deadline warnings\n          wireChangeTracking(); // Track unsaved changes\n        // Wire task checkbox visibility\n        qsa('#tasksChecklist .task-toggle').forEach(cb => {\n          cb.addEventListener('change', () => syncTasksVisibility());\n        });\n        // Wire category checkbox visibility\n        qsa('#taskCategories .category-toggle').forEach(cb => {\n          cb.addEventListener('change', () => syncTasksVisibility());\n        });\n        loadFromActiveRow().then(() => {\n          // Reset unsaved indicator after initial load\n          setUnsavedChanges(false);\n          // Auto-load active tasks on startup\n          performSearch();\n        });\n      }\n    });\n  }\n})();\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.js\", import.meta.url);\n// Module\nvar code = \"<!DOCTYPE html> <html> <head> <meta charset=\\\"utf-8\\\"/> <title>LCMC Task Manager</title> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"/> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <style>:root{--primary:#1e40af;--primary-hover:#1e3a8a;--success:#34a853;--warning:#ff9900;--danger:#cc6666;--gray-50:#f9fafb;--gray-100:#f3f4f6;--gray-200:#e5e7eb;--gray-300:#d1d5db;--gray-500:#6b7280;--gray-700:#374151;--gray-900:#111827;--radius:8px;--shadow-sm:0 1px 2px rgba(0,0,0,0.05);--shadow:0 1px 3px rgba(0,0,0,0.1),0 1px 2px rgba(0,0,0,0.06)}*{box-sizing:border-box}body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,sans-serif;font-size:13px;margin:0;padding:16px;background:var(--gray-50);color:var(--gray-900);line-height:1.5}.header{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px;padding-bottom:10px}.btn-stats{padding:6px 12px;font-size:12px;font-weight:500;border:1px solid var(--primary);border-radius:6px;background:0 0;color:var(--primary);cursor:pointer;transition:all .2s ease}.btn-stats:hover{background:var(--primary);color:#fff}.btn-return{padding:8px 14px;font-size:13px;font-weight:500;border:none;border-radius:6px;background:var(--gray-100);color:var(--gray-700);cursor:pointer;transition:all .2s ease}.btn-return:hover{background:var(--gray-200);color:var(--gray-900)}.stats-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}.stats-header h2{font-size:16px;font-weight:700;color:var(--gray-900);margin:0}.stats-cards{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:16px}.stat-card{background:linear-gradient(135deg,#667eea 0,#764ba2 100%);border-radius:12px;padding:16px;text-align:center;color:#fff;box-shadow:0 4px 15px rgba(102,126,234,.3)}.stat-value{font-size:28px;font-weight:700;line-height:1.2}.stat-label{font-size:11px;opacity:.9;margin-top:4px;text-transform:uppercase;letter-spacing:.5px}.stats-section{background:#fff;border-radius:10px;padding:14px;margin-bottom:12px;box-shadow:var(--shadow-sm);border:1px solid var(--gray-200)}.stats-section-title{font-size:13px;font-weight:600;color:var(--gray-800);margin-bottom:12px}.stats-table-wrap{overflow-x:auto}.stats-table{width:100%;border-collapse:collapse;font-size:12px}.stats-table th{text-align:left;padding:8px 6px;border-bottom:2px solid var(--gray-200);font-weight:600;color:var(--gray-600);font-size:10px;text-transform:uppercase}.stats-table td{padding:8px 6px;border-bottom:1px solid var(--gray-100);color:var(--gray-800)}.stats-table tr:last-child td{border-bottom:none}.stats-table tr:hover td{background:var(--gray-50)}.status-bar-row{display:flex;align-items:center;gap:10px;margin-bottom:10px}.status-bar-row:last-child{margin-bottom:0}.status-label{width:80px;font-size:12px;color:var(--gray-700)}.status-bar-track{flex:1;height:20px;background:var(--gray-100);border-radius:10px;overflow:hidden}.status-bar-fill{height:100%;border-radius:10px;transition:width .5s ease}.status-bar-fill.todo{background:linear-gradient(90deg,#34d399,#10b981)}.status-bar-fill.inprogress{background:linear-gradient(90deg,#fbbf24,#f59e0b)}.status-bar-fill.done{background:linear-gradient(90deg,#f87171,#ef4444)}.status-count{width:35px;text-align:right;font-size:12px;font-weight:600;color:var(--gray-700)}.deadline-stats{display:flex;gap:12px}.deadline-stat{flex:1;text-align:center;padding:12px;border-radius:8px;background:var(--gray-50)}.deadline-value{font-size:24px;font-weight:700}.deadline-value.warning{color:#f59e0b}.deadline-value.danger{color:#ef4444}.deadline-label{font-size:11px;color:var(--gray-600);margin-top:4px}.attention-stats{display:flex;flex-direction:column;gap:8px}.attention-group{border-radius:8px;overflow:hidden;border:1px solid var(--gray-200);display:none}.attention-group.has-items{display:block}.attention-group.danger{border-left:3px solid #ef4444}.attention-group.warning{border-left:3px solid #f59e0b}.attention-group.stale{border-left:3px solid #eab308}.attention-group.danger .attention-header{background:#fef2f2}.attention-group.warning .attention-header{background:#fffbeb}.attention-group.stale .attention-header{background:#fefce8}.attention-header{display:flex;align-items:center;gap:8px;padding:8px 10px;cursor:pointer}.attention-badge{font-size:13px;font-weight:600}.attention-badge span{font-weight:700}.attention-title{font-size:12px;color:var(--gray-600)}.attention-list{background:#fff;max-height:120px;overflow-y:auto}.attention-list:empty{display:none}.attention-item{display:flex;align-items:center;gap:6px;padding:5px 10px;font-size:11px;border-top:1px solid var(--gray-100)}.attention-item:first-child{border-top:none}.attention-item .task-info{flex:1;color:var(--gray-700);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.attention-item .task-info .to-assignee{color:var(--gray-500)}.attention-item .task-detail{color:var(--gray-400);font-size:10px;white-space:nowrap;flex-shrink:0}.chart-legend{display:flex;gap:16px;margin-bottom:10px;font-size:11px;color:var(--gray-600)}.stats-caption{margin-top:6px;font-size:10px;color:var(--gray-500)}.legend-item{display:flex;align-items:center;gap:4px}.legend-dot{width:10px;height:10px;border-radius:2px}.legend-dot.tasks{background:linear-gradient(135deg,#667eea,#764ba2)}.legend-dot.kyc{background:linear-gradient(135deg,#10b981,#059669)}.legend-dot.active{background:linear-gradient(135deg,#f59e0b,#d97706)}.legend-dot.completed{background:linear-gradient(135deg,#10b981,#059669)}.monthly-chart{display:flex;align-items:flex-end;gap:8px;height:120px;padding-top:10px}.month-bar-group{flex:1;display:flex;flex-direction:column;align-items:center;gap:4px}.month-bars{display:flex;gap:3px;align-items:flex-end;height:90px}.month-bar{width:14px;border-radius:3px 3px 0 0;transition:height .5s ease;position:relative}.month-bar.tasks{background:linear-gradient(180deg,#667eea,#764ba2)}.month-bar.kyc{background:linear-gradient(180deg,#10b981,#059669)}.month-bar-label{font-size:9px;color:var(--gray-500);text-align:center}.month-bar-value{position:absolute;top:-16px;left:50%;transform:translateX(-50%);font-size:9px;font-weight:600;color:var(--gray-700)}.broker-chart{display:flex;flex-direction:column;gap:8px}.broker-row{display:flex;align-items:center;gap:10px}.broker-name{width:80px;font-size:12px;color:var(--gray-700);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.broker-bar-track{flex:1;height:20px;background:var(--gray-100);border-radius:10px;overflow:hidden;display:flex}.broker-bar-fill{height:100%;transition:width .5s ease}.broker-bar-fill.active{background:linear-gradient(90deg,#f59e0b,#d97706)}.broker-bar-fill.completed{background:linear-gradient(90deg,#10b981,#059669)}.broker-bar-fill .bar-num{display:flex;align-items:center;justify-content:center;height:100%;font-size:10px;font-weight:600;color:#fff;padding:0 4px;min-width:16px}.task-assignee-select{flex:1;padding:6px 10px;font-size:12px;border:1px solid var(--gray-300);border-radius:6px;background:#fff;color:var(--gray-700);cursor:pointer}.task-assignee-select:focus{outline:0;border-color:var(--primary);box-shadow:0 0 0 2px rgba(30,64,175,.1)}.btn-new-task{display:inline-flex;align-items:center;gap:6px;padding:10px 20px;font-size:13px;font-weight:600;border-radius:10px;border:none;background:linear-gradient(135deg,#10b981 0,#059669 100%);color:#fff;cursor:pointer;box-shadow:0 3px 10px rgba(16,185,129,.35),inset 0 1px 0 rgba(255,255,255,.2);transition:all .2s ease}.btn-new-task:hover{transform:translateY(-1px);box-shadow:0 5px 15px rgba(16,185,129,.45),inset 0 1px 0 rgba(255,255,255,.2)}.btn-new-task:active{transform:translateY(0)}.btn-new-task .plus-icon{font-size:16px;font-weight:700}.section{background:#fff;border-radius:var(--radius);padding:14px;margin-bottom:12px;box-shadow:var(--shadow-sm);border:1px solid var(--gray-200)}.section-title{font-size:11px;font-weight:600;text-transform:uppercase;letter-spacing:.5px;color:var(--gray-500);margin-bottom:10px}.row{margin-bottom:12px}.row:last-child{margin-bottom:0}label{display:block;margin-bottom:4px;font-weight:500;font-size:12px;color:var(--gray-700)}input[type=date],input[type=text],select,textarea{width:100%;padding:8px 10px;border:1px solid var(--gray-300);border-radius:6px;font-size:13px;background:#fff;transition:border-color .15s,box-shadow .15s}input[type=date]:focus,input[type=text]:focus,select:focus,textarea:focus{outline:0;border-color:var(--primary);box-shadow:0 0 0 3px rgba(30,64,175,.1)}textarea{resize:vertical;min-height:48px}.chips{display:flex;gap:6px;margin:6px 0;flex-wrap:wrap}.chip{padding:5px 12px;border-radius:999px;cursor:pointer;border:1px solid var(--gray-200);background:var(--gray-50);color:var(--gray-700);font-size:12px;font-weight:500;transition:all .15s}.chip:hover{background:var(--gray-100)}.chip.active{color:#fff;border-color:transparent}.chip[data-value=\\\"To Do\\\"].active{background:var(--success)}.chip[data-value=\\\"In Progress\\\"].active{background:var(--warning)}.chip[data-value=Done].active{background:var(--danger)}.actions{display:flex;gap:8px;flex-wrap:wrap;margin-top:16px}.btn{background:var(--primary);color:#fff;border:none;padding:10px 16px;cursor:pointer;border-radius:6px;font-size:13px;font-weight:500;transition:background .15s;display:inline-flex;align-items:center;gap:6px}.btn:hover{background:var(--primary-hover)}.btn.secondary{background:var(--gray-500)}.btn.secondary:hover{background:var(--gray-700)}.btn.success{background:var(--success)}.btn.success:hover{background:#15803d}.btn-sm{padding:6px 10px;font-size:12px}.btn-link{background:0 0;color:var(--primary);padding:6px 10px;border:1px solid var(--primary)}.btn-link:hover{background:rgba(30,64,175,.05)}.toggle-list{max-height:78px;overflow-y:auto;border:1px solid var(--gray-200);border-radius:8px;padding:8px 10px;background:#fff}.toggle-list label{display:inline-flex;align-items:center;gap:8px;margin-right:12px;margin-bottom:4px;font-weight:400;cursor:pointer;font-size:12px;color:var(--gray-700);transition:color .15s}.toggle-list label:hover{color:var(--gray-900)}.toggle-list input[type=checkbox]{appearance:none;-webkit-appearance:none;width:18px;height:18px;border:2px solid var(--gray-300);border-radius:5px;background:#fff;cursor:pointer;position:relative;transition:all .2s ease;flex-shrink:0}.toggle-list input[type=checkbox]:hover{border-color:var(--primary)}.toggle-list input[type=checkbox]:checked{background:linear-gradient(135deg,#10b981 0,#059669 100%);border-color:#059669}.toggle-list input[type=checkbox]:checked::after{content:'';position:absolute;left:5px;top:2px;width:5px;height:9px;border:solid #fff;border-width:0 2px 2px 0;transform:rotate(45deg)}#assignees{max-height:78px}#tasksChecklist{max-height:70px}#taskCategories{max-height:78px;padding:2px 0}.task-card{background:var(--gray-50);border:1px solid var(--gray-200);border-radius:6px;padding:12px;margin-top:10px}.task-card strong{font-size:13px;color:var(--primary)}.task-card .row{margin-bottom:8px}#auditInfo{font-size:11px;color:var(--gray-500);background:var(--gray-100);padding:8px 10px;border-radius:6px;margin-top:12px}#auditInfo label{font-size:11px;margin-bottom:2px}#lastKycDate{color:var(--primary);font-weight:600}.search-section{background:linear-gradient(135deg,#1e40af 0,#3b82f6 100%);border-radius:var(--radius);padding:14px;margin-bottom:12px;box-shadow:var(--shadow)}.search-section .section-title{color:rgba(255,255,255,.9);margin-bottom:12px}.search-tabs{display:flex;gap:4px;margin-bottom:10px}.search-tab{flex:1;padding:8px 8px;border:none;border-radius:6px;font-size:11px;font-weight:500;cursor:pointer;background:rgba(255,255,255,.2);color:#fff;transition:all .2s;text-align:center}.search-tab:hover{background:rgba(255,255,255,.3)}.search-tab.active{background:#fff;color:var(--primary);font-weight:600}.search-input-wrap{display:flex;gap:8px}.autocomplete-wrap{flex:1;position:relative}.search-input-wrap input{width:100%;padding:10px 12px;border:none;border-radius:6px;font-size:13px}.autocomplete-dropdown{position:absolute;top:100%;left:0;right:0;background:#fff;border-radius:0 0 6px 6px;box-shadow:0 4px 12px rgba(0,0,0,.15);max-height:200px;overflow-y:auto;z-index:100;display:none}.autocomplete-dropdown.visible{display:block}.autocomplete-item{padding:10px 12px;cursor:pointer;border-bottom:1px solid var(--gray-100);display:flex;justify-content:space-between;align-items:center;gap:8px}.autocomplete-item:last-child{border-bottom:none}.autocomplete-item:hover{background:var(--gray-50)}.autocomplete-item .company-name{font-size:13px;font-weight:500;color:var(--gray-900);flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.autocomplete-item .row-hint{font-size:10px;color:var(--gray-500);white-space:nowrap;text-align:right}.search-input-wrap button{padding:10px 16px;border:none;border-radius:6px;background:#fff;color:var(--primary);font-weight:600;cursor:pointer;transition:all .2s}.search-input-wrap button:hover{background:#f0f0f0}.search-results{background:#fff;border-radius:6px;margin-top:10px;max-height:200px;overflow-y:auto;display:none}.search-results.visible{display:block}.search-result-item{padding:10px 12px;border-bottom:1px solid var(--gray-200);cursor:pointer;transition:background .15s}.search-result-item:last-child{border-bottom:none}.search-result-item:hover{background:var(--gray-50)}.search-result-item .company{font-weight:600;color:var(--gray-900)}.search-result-item .meta{font-size:11px;color:var(--gray-500);margin-top:2px}.search-result-item .status-badge{display:inline-block;padding:2px 8px;border-radius:999px;font-size:10px;font-weight:600;margin-left:6px}.status-badge.todo{background:#e8f5e9;color:#2e7d32}.status-badge.progress{background:#fff3e0;color:#ef6c00}.status-badge.done{background:#ffebee;color:#d04949}.no-results{padding:12px;text-align:center;color:var(--gray-500);font-size:12px}.search-hint{font-size:11px;color:rgba(255,255,255,.6);margin-top:6px;font-style:italic}.btn-magic{background:linear-gradient(135deg,#667eea 0,#764ba2 50%,#f093fb 100%);background-size:200% 200%;animation:gradientShift 3s ease infinite;color:#fff;border:none;padding:8px 14px;border-radius:8px;font-size:12px;font-weight:600;cursor:pointer;position:relative;overflow:hidden;box-shadow:0 4px 15px rgba(102,126,234,.4);transition:all .3s ease}.btn-magic:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(102,126,234,.6)}.btn-magic::before{content:'';position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:linear-gradient(45deg,transparent,rgba(255,255,255,.3),transparent);transform:rotate(45deg);animation:shimmer 2s infinite}.btn-magic .sparkle{display:inline-block;margin-right:6px;animation:sparkle 1.5s ease-in-out infinite}@keyframes gradientShift{0%{background-position:0 50%}50%{background-position:100% 50%}100%{background-position:0 50%}}@keyframes shimmer{0%{transform:translateX(-100%) rotate(45deg)}100%{transform:translateX(100%) rotate(45deg)}}@keyframes sparkle{0%,100%{opacity:1;transform:scale(1)}50%{opacity:.6;transform:scale(1.2)}}.date-display{font-size:11px;color:var(--gray-500);margin-top:4px}.bottom-save-section{background:linear-gradient(135deg,#f8fafc 0,#f1f5f9 100%);border-radius:var(--radius);padding:12px 16px;margin-top:12px;box-shadow:0 -4px 20px rgba(0,0,0,.05);border:1px solid var(--gray-200);display:flex;align-items:center;justify-content:center;gap:14px;position:sticky;bottom:0}.btn-save-main{position:relative;padding:10px 28px;font-size:13px;font-weight:600;letter-spacing:.3px;border-radius:10px;border:none;background:linear-gradient(135deg,#10b981 0,#059669 50%,#047857 100%);background-size:200% 200%;color:#fff;cursor:pointer;box-shadow:0 3px 12px rgba(16,185,129,.4),0 1px 3px rgba(0,0,0,.1),inset 0 1px 0 rgba(255,255,255,.2);transition:all .3s cubic-bezier(.4, 0, .2, 1);overflow:hidden}.btn-save-main::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);transition:left .5s}.btn-save-main:hover{transform:translateY(-2px);box-shadow:0 8px 25px rgba(16,185,129,.5),0 4px 10px rgba(0,0,0,.1),inset 0 1px 0 rgba(255,255,255,.2);background-position:100% 100%}.btn-save-main:hover::before{left:100%}.btn-save-main:active{transform:translateY(0);box-shadow:0 2px 8px rgba(16,185,129,.4),inset 0 1px 0 rgba(255,255,255,.1)}.btn-save-main .save-icon{display:inline-flex;align-items:center;justify-content:center;margin-right:6px}.btn-save-main .save-icon svg{width:15px;height:15px;stroke:currentColor;stroke-width:2.5;fill:none}.load-row-hint{display:flex;align-items:center;gap:10px;margin-top:10px;padding:10px 12px;background:rgba(255,255,255,.15);border-radius:6px}.load-row-hint span{font-size:12px;color:rgba(255,255,255,.8)}.btn-load-selected{background:#fff;color:var(--primary);border:none;font-size:11px;padding:6px 12px;font-weight:600}.btn-load-selected:hover{background:#f0f0f0}.deadline-warning{background:#fef3c7;border:1px solid #f59e0b;color:#92400e}.deadline-overdue{background:#fee2e2;border:1px solid #ef4444;color:#991b1b}.deadline-badge{display:inline-block;padding:2px 6px;border-radius:4px;font-size:10px;font-weight:600;margin-left:8px}.deadline-badge.warning{background:#fef3c7;color:#92400e}.deadline-badge.overdue{background:#fee2e2;color:#991b1b}.toast{position:fixed;bottom:80px;right:16px;transform:translateX(120%);background:#1e40af;color:#fff;padding:12px 20px;border-radius:8px;font-size:13px;font-weight:500;box-shadow:0 4px 12px rgba(0,0,0,.2);opacity:0;transition:all .3s ease;z-index:1000;max-width:220px}.toast.show{transform:translateX(0);opacity:1}.toast.success{background:#15803d}.toast.error{background:#dc2626}.unsaved-indicator{display:none;align-items:center;gap:6px;font-size:12px;color:var(--warning);font-weight:500}.unsaved-indicator.visible{display:inline-flex}.unsaved-dot{width:8px;height:8px;background:var(--warning);border-radius:50%;animation:pulse 1.5s infinite}@keyframes pulse{0%,100%{opacity:1}50%{opacity:.4}}.delete-task-row{display:flex;justify-content:flex-end;padding:8px 0;margin-top:8px}.btn-delete-task{padding:4px 8px;font-size:10px;font-weight:400;border:none;border-radius:4px;background:0 0;color:var(--gray-400);cursor:pointer;transition:all .2s ease}.btn-delete-task:hover{color:#ef4444;background:#fef2f2}.confirm-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:2000}.confirm-box{background:#fff;border-radius:12px;padding:24px;max-width:280px;text-align:center;box-shadow:0 10px 40px rgba(0,0,0,.2)}.confirm-box p{margin:0 0 20px 0;font-size:14px;color:var(--gray-900)}.confirm-buttons{display:flex;gap:10px;justify-content:center}.btn-confirm-cancel{padding:8px 16px;font-size:13px;font-weight:500;border:1px solid var(--gray-300);border-radius:6px;background:#fff;color:var(--gray-700);cursor:pointer}.btn-confirm-cancel:hover{background:var(--gray-100)}.btn-confirm-ok{padding:8px 16px;font-size:13px;font-weight:500;border:none;border-radius:6px;background:#ef4444;color:#fff;cursor:pointer}.btn-confirm-ok:hover{background:#dc2626}.btn-email-summary{width:100%;padding:10px 14px;font-size:12px;font-weight:600;border:none;border-radius:8px;background:linear-gradient(135deg,#1976d2 0,#00b8d4 100%);color:#fff;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:8px;transition:all .2s ease;box-shadow:0 2px 8px rgba(25,118,210,.3)}.btn-email-summary:hover:not(:disabled){transform:translateY(-1px);box-shadow:0 4px 12px rgba(25,118,210,.4)}.btn-email-summary:disabled{background:var(--gray-300);color:var(--gray-500);cursor:not-allowed;box-shadow:none}.btn-email-summary .email-icon{font-size:14px}.email-summary-section{display:none;background:#fff;border:1px solid var(--gray-200);border-radius:var(--radius);margin-bottom:12px;box-shadow:var(--shadow);overflow:hidden}.email-summary-section.visible{display:block}.email-summary-header{display:flex;justify-content:space-between;align-items:center;padding:12px 14px;background:linear-gradient(135deg,#1976d2 0,#00b8d4 100%);color:#fff}.email-summary-title{font-size:13px;font-weight:600}.summary-count-badge{display:inline-block;padding:2px 8px;border-radius:10px;background:rgba(255,255,255,.2);font-size:11px;margin-left:6px}.summary-close-btn{background:0 0;border:none;color:#fff;font-size:20px;cursor:pointer;padding:0 4px;line-height:1;opacity:.8}.summary-close-btn:hover{opacity:1}.email-summary-list{max-height:300px;overflow-y:auto;padding:10px}.email-loading{text-align:center;color:var(--gray-500);padding:20px;font-size:12px}.email-no-summaries{text-align:center;color:var(--gray-500);padding:20px;font-style:italic;font-size:12px}.email-summary-item{padding:12px;margin-bottom:8px;background:var(--gray-50);border:1px solid var(--gray-200);border-radius:8px;transition:all .2s ease}.email-summary-item:last-child{margin-bottom:0}.email-summary-item.draft{border-left:3px solid var(--gray-400);opacity:.85}.email-summary-item.confirmed{border-left:3px solid #22c55e}.email-summary-subject{font-weight:600;font-size:13px;color:var(--gray-900);margin-bottom:4px}.email-summary-meta{font-size:11px;color:var(--gray-500);margin-bottom:8px}.email-summary-text{font-size:12px;line-height:1.5;color:var(--gray-700)}.email-summary-actions{margin-top:10px;display:flex;gap:8px}.btn-confirm-summary{padding:6px 12px;font-size:11px;font-weight:600;border:none;border-radius:6px;background:#22c55e;color:#fff;cursor:pointer;transition:background .2s}.btn-confirm-summary:hover{background:#16a34a}.draft-badge{display:inline-block;padding:2px 6px;border-radius:4px;font-size:10px;font-weight:600;background:var(--gray-200);color:var(--gray-600);margin-left:6px}</style> </head> <body> <div style=\\\"height:3px;background:linear-gradient(90deg,var(--primary) 0,#3b82f6 100%);margin:-16px -16px 12px -16px\\\"></div> <div class=\\\"header\\\" id=\\\"tasksHeader\\\"> <button class=\\\"btn-new-task\\\" id=\\\"newTaskBtn\\\"> <span class=\\\"plus-icon\\\">+</span> New Task </button> <button class=\\\"btn-stats\\\" id=\\\"openStatsBtn\\\"> Statistics</button> </div> <div class=\\\"header\\\" id=\\\"statsHeader\\\" style=\\\"display:none\\\"> <button class=\\\"btn-return\\\" id=\\\"returnToTasksBtn\\\"> Return to Tasks</button> <button class=\\\"btn btn-sm\\\" id=\\\"refreshStatsBtn\\\"> Refresh</button> </div> <div id=\\\"tasksView\\\"> <div class=\\\"search-section\\\"> <div class=\\\"section-title\\\"> Quick Search</div> <div class=\\\"search-tabs\\\"> <button class=\\\"search-tab active\\\" data-search=\\\"active\\\">Active Tasks</button> <button class=\\\"search-tab\\\" data-search=\\\"company\\\">By Company</button> </div> <div class=\\\"search-input-wrap\\\" id=\\\"searchInputWrap\\\"> <div class=\\\"autocomplete-wrap\\\"> <input type=\\\"text\\\" id=\\\"searchInput\\\" placeholder=\\\"Type company name...\\\" autocomplete=\\\"off\\\"/> <div class=\\\"autocomplete-dropdown\\\" id=\\\"autocompleteDropdown\\\"></div> </div> <button id=\\\"searchBtn\\\">Go</button> </div> <div class=\\\"load-row-hint\\\" id=\\\"loadRowHint\\\" style=\\\"display:none\\\"> <span> Or click a row in Excel, then:</span> <button class=\\\"btn btn-sm btn-load-selected\\\" id=\\\"loadSelectedBtn\\\"> Load Selected Row</button> </div> <div id=\\\"searchHint\\\" class=\\\"search-hint\\\"></div> <div class=\\\"search-results\\\" id=\\\"searchResults\\\"></div> </div> <div class=\\\"section\\\"> <div class=\\\"section-title\\\">Company</div> <div class=\\\"row\\\"> <input type=\\\"text\\\" id=\\\"companyName\\\" placeholder=\\\"Enter company name\\\" style=\\\"width:100%;min-width:0;box-sizing:border-box\\\"/> </div> <div class=\\\"row\\\"> <button class=\\\"btn-email-summary\\\" id=\\\"viewEmailSummaryBtn\\\" disabled=\\\"disabled\\\"> <span class=\\\"email-icon\\\"></span> View Email Summaries </button> </div> </div> <div id=\\\"emailSummarySection\\\" class=\\\"email-summary-section\\\"> <div class=\\\"email-summary-header\\\"> <span class=\\\"email-summary-title\\\"> Email Summaries <span id=\\\"emailSummaryCount\\\" class=\\\"summary-count-badge\\\">0</span></span> <button class=\\\"summary-close-btn\\\" id=\\\"closeEmailSummaryBtn\\\">&times;</button> </div> <div id=\\\"emailSummaryList\\\" class=\\\"email-summary-list\\\"> <div class=\\\"email-loading\\\">Loading summaries...</div> </div> </div> <div class=\\\"section\\\"> <div class=\\\"section-title\\\">Task Details</div> <div class=\\\"row\\\"> <label>Task Category:</label> <div id=\\\"taskCategories\\\" class=\\\"toggle-list\\\"> <label><input type=\\\"checkbox\\\" class=\\\"category-toggle\\\" value=\\\"Onboarding\\\"> Onboarding</label> <label><input type=\\\"checkbox\\\" class=\\\"category-toggle\\\" value=\\\"KYC update\\\"> KYC update</label> <label><input type=\\\"checkbox\\\" class=\\\"category-toggle\\\" value=\\\"Amended Product/Rate\\\"> Amended Product/Rate</label> <label><input type=\\\"checkbox\\\" class=\\\"category-toggle\\\" value=\\\"Other Task\\\"> Other Task</label> </div> </div> <div class=\\\"row\\\"> <label>Assigned to</label> <div id=\\\"assignees\\\" class=\\\"toggle-list\\\"></div> </div> <div class=\\\"row\\\"> <label>Broker Lead:</label> <select id=\\\"brokerLead\\\"></select> </div> </div> <div class=\\\"section\\\"> <div class=\\\"section-title\\\">Key Dates</div> <div class=\\\"row\\\"> <label>Initial Request Date:</label> <input id=\\\"initialRequest\\\" type=\\\"date\\\"/> <div class=\\\"date-display\\\" id=\\\"initialRequestDisplay\\\"></div> </div> <div class=\\\"row\\\"> <label>Intro Email Date:</label> <input id=\\\"introEmail\\\" type=\\\"date\\\"/> <div class=\\\"date-display\\\" id=\\\"introEmailDisplay\\\"></div> </div> <div class=\\\"row\\\"> <label> Reminders Starting Date:</label> <input id=\\\"remindersStart\\\" type=\\\"date\\\"/> <div class=\\\"date-display\\\" id=\\\"remindersStartDisplay\\\"></div> </div> </div> <div class=\\\"section\\\" id=\\\"tasksRow\\\"> <div class=\\\"section-title\\\">Tasks</div> <div class=\\\"row\\\"> <label>Select Tasks:</label> <div id=\\\"tasksChecklist\\\" class=\\\"toggle-list\\\"> <label><input type=\\\"checkbox\\\" class=\\\"task-toggle\\\" value=\\\"Broker Agreement\\\"> Broker Agreement</label> <label><input type=\\\"checkbox\\\" class=\\\"task-toggle\\\" value=\\\"Give-up Agreement\\\"> Give-up Agreement</label> <label><input type=\\\"checkbox\\\" class=\\\"task-toggle\\\" value=\\\"Amend Annex A\\\"> Amend Annex A</label> <label><input type=\\\"checkbox\\\" class=\\\"task-toggle\\\" value=\\\"KYC (produced by LCMC)\\\"> KYC (produced by LCMC)</label> <label><input type=\\\"checkbox\\\" class=\\\"task-toggle\\\" value=\\\"KYC External\\\"> KYC External</label> </div> </div> <div id=\\\"taskCards\\\"> <div class=\\\"task-card\\\" data-task=\\\"Broker Agreement\\\"> <div class=\\\"row\\\"><strong>Broker Agreement</strong></div> <div class=\\\"row\\\"> <label>Status:</label> <div class=\\\"chips\\\" data-role=\\\"status-chips\\\"> <div class=\\\"chip\\\" data-value=\\\"To Do\\\">To Do</div> <div class=\\\"chip\\\" data-value=\\\"In Progress\\\">In Progress</div> <div class=\\\"chip\\\" data-value=\\\"Done\\\">Done</div> </div> </div> <div class=\\\"row\\\"> <label>Assigned to:</label> <select data-role=\\\"task-assignee\\\" class=\\\"task-assignee-select\\\"></select> </div> <div class=\\\"row\\\"> <label>Comment:</label> <textarea rows=\\\"2\\\" data-role=\\\"comment\\\" placeholder=\\\"Add a brief comment for this task\\\"></textarea> </div> <div class=\\\"row\\\"> <label>Deadline:</label> <input type=\\\"date\\\" data-role=\\\"deadline\\\"/> </div> </div> <div class=\\\"task-card\\\" data-task=\\\"Give-up Agreement\\\"> <div class=\\\"row\\\"><strong>Give-up Agreement</strong></div> <div class=\\\"row\\\"> <label>Status:</label> <div class=\\\"chips\\\" data-role=\\\"status-chips\\\"> <div class=\\\"chip\\\" data-value=\\\"To Do\\\">To Do</div> <div class=\\\"chip\\\" data-value=\\\"In Progress\\\">In Progress</div> <div class=\\\"chip\\\" data-value=\\\"Done\\\">Done</div> </div> </div> <div class=\\\"row\\\"> <label>Assigned to:</label> <select data-role=\\\"task-assignee\\\" class=\\\"task-assignee-select\\\"></select> </div> <div class=\\\"row\\\"> <label>Comment:</label> <textarea rows=\\\"2\\\" data-role=\\\"comment\\\" placeholder=\\\"Add a brief comment for this task\\\"></textarea> </div> <div class=\\\"row\\\"> <label>Give-up ID:</label> <input type=\\\"text\\\" data-role=\\\"giveUpId\\\"/> </div> <div class=\\\"row\\\"> <label>Deadline:</label> <input type=\\\"date\\\" data-role=\\\"deadline\\\"/> </div> </div> <div class=\\\"task-card\\\" data-task=\\\"Amend Annex A\\\"> <div class=\\\"row\\\"><strong>Amend Annex A</strong></div> <div class=\\\"row\\\"> <label>Status:</label> <div class=\\\"chips\\\" data-role=\\\"status-chips\\\"> <div class=\\\"chip\\\" data-value=\\\"To Do\\\">To Do</div> <div class=\\\"chip\\\" data-value=\\\"In Progress\\\">In Progress</div> <div class=\\\"chip\\\" data-value=\\\"Done\\\">Done</div> </div> </div> <div class=\\\"row\\\"> <label>Assigned to:</label> <select data-role=\\\"task-assignee\\\" class=\\\"task-assignee-select\\\"></select> </div> <div class=\\\"row\\\"> <label>Comment:</label> <textarea rows=\\\"2\\\" data-role=\\\"comment\\\" placeholder=\\\"Add a brief comment for this task\\\"></textarea> </div> <div class=\\\"row\\\"> <label>Deadline:</label> <input type=\\\"date\\\" data-role=\\\"deadline\\\"/> </div> </div> <div class=\\\"task-card\\\" data-task=\\\"KYC (produced by LCMC)\\\"> <div class=\\\"row\\\" style=\\\"display:flex;justify-content:space-between;align-items:center\\\"> <strong>KYC (produced by LCMC)</strong> <button class=\\\"btn-magic\\\" id=\\\"openKycPortal\\\" type=\\\"button\\\"><span class=\\\"sparkle\\\"></span>Open KYCai Assistant</button> </div> <div class=\\\"row\\\"> <label>Status:</label> <div class=\\\"chips\\\" data-role=\\\"status-chips\\\"> <div class=\\\"chip\\\" data-value=\\\"To Do\\\">To Do</div> <div class=\\\"chip\\\" data-value=\\\"In Progress\\\">In Progress</div> <div class=\\\"chip\\\" data-value=\\\"Done\\\">Done</div> </div> </div> <div class=\\\"row\\\"> <label>Assigned to:</label> <select data-role=\\\"task-assignee\\\" class=\\\"task-assignee-select\\\"></select> </div> <div class=\\\"row\\\"> <label>Comment:</label> <textarea rows=\\\"2\\\" data-role=\\\"comment\\\" placeholder=\\\"Add a brief comment for this task\\\"></textarea> </div> <div class=\\\"row\\\"> <label>Deadline:</label> <input type=\\\"date\\\" data-role=\\\"deadline\\\"/> </div> </div> <div class=\\\"task-card\\\" data-task=\\\"KYC External\\\"> <div class=\\\"row\\\"><strong>KYC External</strong></div> <div class=\\\"row\\\"> <label>Status:</label> <div class=\\\"chips\\\" data-role=\\\"status-chips\\\"> <div class=\\\"chip\\\" data-value=\\\"To Do\\\">To Do</div> <div class=\\\"chip\\\" data-value=\\\"In Progress\\\">In Progress</div> <div class=\\\"chip\\\" data-value=\\\"Done\\\">Done</div> </div> </div> <div class=\\\"row\\\"> <label>Assigned to:</label> <select data-role=\\\"task-assignee\\\" class=\\\"task-assignee-select\\\"></select> </div> <div class=\\\"row\\\"> <label>Comment:</label> <textarea rows=\\\"2\\\" data-role=\\\"comment\\\" placeholder=\\\"Add a brief comment for this task\\\"></textarea> </div> <div class=\\\"row\\\"> <label>Deadline:</label> <input type=\\\"date\\\" data-role=\\\"deadline\\\"/> </div> </div> </div> </div> <div class=\\\"section task-card\\\" id=\\\"otherTaskCard\\\" data-task=\\\"__other__\\\" style=\\\"display:none\\\"> <div class=\\\"section-title\\\">Other Task</div> <div class=\\\"row\\\"> <label>Task Name:</label> <input id=\\\"taskName\\\" type=\\\"text\\\" placeholder=\\\"Name of the other task\\\"/> </div> <div class=\\\"row\\\"> <label>Status:</label> <div class=\\\"chips\\\" data-role=\\\"status-chips\\\"> <div class=\\\"chip\\\" data-value=\\\"To Do\\\">To Do</div> <div class=\\\"chip\\\" data-value=\\\"In Progress\\\">In Progress</div> <div class=\\\"chip\\\" data-value=\\\"Done\\\">Done</div> </div> </div> <div class=\\\"row\\\"> <label>Assigned to:</label> <select data-role=\\\"task-assignee\\\" class=\\\"task-assignee-select\\\"></select> </div> <div class=\\\"row\\\"> <label>Comment:</label> <textarea rows=\\\"2\\\" data-role=\\\"comment\\\" placeholder=\\\"Add a brief comment for this task\\\"></textarea> </div> <div class=\\\"row\\\"> <label>Deadline:</label> <input type=\\\"date\\\" data-role=\\\"deadline\\\"/> </div> </div> <div class=\\\"section\\\"> <div class=\\\"section-title\\\">Reminders & Notes</div> <div class=\\\"row\\\"> <label>Email Reminders Frequency (EDT):</label> <select id=\\\"emailFrequency\\\"> <option value=\\\"\\\">(none)</option> <option value=\\\"Every Monday at 8AM\\\">Every Monday at 8AM</option> <option value=\\\"Every Monday, Wednesday and Friday at 8AM\\\">Every Monday, Wednesday and Friday at 8AM</option> <option value=\\\"Every working days at 8AM\\\">Every working days at 8AM</option> <option value=\\\"Every working days at 8AM and 2PM\\\">Every working days at 8AM and 2PM</option> </select> </div> <div class=\\\"row\\\"> <label>Extra Note:</label> <textarea id=\\\"extraNote\\\" rows=\\\"3\\\" placeholder=\\\"General note about this task\\\"></textarea> </div> </div> <div id=\\\"auditInfo\\\"> <label>History:</label> <div id=\\\"auditText\\\"></div> <div style=\\\"margin-top:8px\\\"><strong>Last KYC Produced:</strong> <span id=\\\"lastKycDate\\\"></span></div> </div> <div class=\\\"delete-task-row\\\"> <button class=\\\"btn-delete-task\\\" id=\\\"deleteTaskBtn\\\">Delete Task</button> </div> <div class=\\\"bottom-save-section\\\"> <span class=\\\"unsaved-indicator\\\" id=\\\"unsavedIndicator\\\"><span class=\\\"unsaved-dot\\\"></span>Unsaved changes</span> <button class=\\\"btn-save-main\\\" id=\\\"saveBtn\\\"> <span class=\\\"save-icon\\\"> <svg viewBox=\\\"0 0 24 24\\\"><path d=\\\"M5 12l5 5L20 7\\\"/></svg> </span> Save Changes </button> </div> </div> <div id=\\\"statsView\\\" style=\\\"display:none\\\"> <div class=\\\"stats-cards\\\"> <div class=\\\"stat-card\\\"> <div class=\\\"stat-value\\\" id=\\\"statActiveTasks\\\">-</div> <div class=\\\"stat-label\\\">Active Tasks</div> </div> <div class=\\\"stat-card\\\"> <div class=\\\"stat-value\\\" id=\\\"statAvgDuration\\\">-</div> <div class=\\\"stat-label\\\">Avg Duration (days)</div> </div> </div> <div class=\\\"stats-section\\\"> <div class=\\\"stats-section-title\\\"> Monthly Activity</div> <div class=\\\"chart-legend\\\"> <span class=\\\"legend-item\\\"><span class=\\\"legend-dot tasks\\\"></span> Tasks created</span> <span class=\\\"legend-item\\\"><span class=\\\"legend-dot kyc\\\"></span> KYC completed</span> </div> <div class=\\\"monthly-chart\\\" id=\\\"monthlyChart\\\"></div> </div> <div class=\\\"stats-section\\\"> <div class=\\\"stats-section-title\\\"> Broker Lead Activity</div> <div class=\\\"chart-legend\\\"> <span class=\\\"legend-item\\\"><span class=\\\"legend-dot active\\\"></span> Active</span> <span class=\\\"legend-item\\\"><span class=\\\"legend-dot completed\\\"></span> Completed</span> </div> <div class=\\\"broker-chart\\\" id=\\\"brokerChart\\\"></div> </div> <div class=\\\"stats-section\\\"> <div class=\\\"stats-section-title\\\"> Status Distribution</div> <div class=\\\"status-bars\\\" id=\\\"statusBars\\\"> <div class=\\\"status-bar-row\\\"> <span class=\\\"status-label\\\">To Do</span> <div class=\\\"status-bar-track\\\"> <div class=\\\"status-bar-fill todo\\\" id=\\\"barToDo\\\" style=\\\"width:0%\\\"></div> </div> <span class=\\\"status-count\\\" id=\\\"countToDo\\\">0</span> </div> <div class=\\\"status-bar-row\\\"> <span class=\\\"status-label\\\">In Progress</span> <div class=\\\"status-bar-track\\\"> <div class=\\\"status-bar-fill inprogress\\\" id=\\\"barInProgress\\\" style=\\\"width:0%\\\"></div> </div> <span class=\\\"status-count\\\" id=\\\"countInProgress\\\">0</span> </div> <div class=\\\"status-bar-row\\\"> <span class=\\\"status-label\\\">Done</span> <div class=\\\"status-bar-track\\\"> <div class=\\\"status-bar-fill done\\\" id=\\\"barDone\\\" style=\\\"width:0%\\\"></div> </div> <span class=\\\"status-count\\\" id=\\\"countDone\\\">0</span> </div> </div> </div> <div class=\\\"stats-section\\\"> <div class=\\\"stats-section-title\\\"> Attention Required</div> <div class=\\\"attention-stats\\\"> <div class=\\\"attention-group danger\\\" id=\\\"overdueGroup\\\"> <div class=\\\"attention-header\\\"> <span class=\\\"attention-badge\\\"> <span id=\\\"statOverdue\\\">0</span></span> <span class=\\\"attention-title\\\">Overdue</span> </div> <div class=\\\"attention-list\\\" id=\\\"overdueList\\\"></div> </div> <div class=\\\"attention-group warning\\\" id=\\\"upcomingGroup\\\"> <div class=\\\"attention-header\\\"> <span class=\\\"attention-badge\\\"> <span id=\\\"statUpcoming\\\">0</span></span> <span class=\\\"attention-title\\\">Due within 7 days</span> </div> <div class=\\\"attention-list\\\" id=\\\"upcomingList\\\"></div> </div> <div class=\\\"attention-group stale\\\" id=\\\"staleGroup\\\"> <div class=\\\"attention-header\\\"> <span class=\\\"attention-badge\\\"> <span id=\\\"statStale\\\">0</span></span> <span class=\\\"attention-title\\\">No update 30+ days</span> </div> <div class=\\\"attention-list\\\" id=\\\"staleList\\\"></div> </div> </div> </div> </div> <div id=\\\"toast\\\" class=\\\"toast\\\"></div> <div id=\\\"confirmDialog\\\" class=\\\"confirm-overlay\\\" style=\\\"display:none\\\"> <div class=\\\"confirm-box\\\"> <p id=\\\"confirmMessage\\\">Are you sure?</p> <div class=\\\"confirm-buttons\\\"> <button class=\\\"btn-confirm-cancel\\\" id=\\\"confirmCancel\\\">Cancel</button> <button class=\\\"btn-confirm-ok\\\" id=\\\"confirmOk\\\">Delete</button> </div> </div> </div> <\" + \"script src=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\"><\" + \"/script> </body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","t","r","Symbol","n","iterator","toStringTag","c","Generator","u","create","_regeneratorDefine2","f","y","G","v","a","d","bind","l","TypeError","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","qs","s","querySelector","qsa","Array","from","querySelectorAll","teamMembersLoaded","hasUnsavedChanges","EMAIL_SUMMARIZER_API_URL","showToast","message","type","toast","textContent","className","setTimeout","classList","remove","setUnsavedChanges","unsaved","indicator","toggle","escapeHtml","text","div","createElement","String","innerHTML","applyDeadlineWarnings","forEach","card","deadlineInput","warningClass","deadlineStr","deadline","Date","isNaN","getTime","today","setHours","diffDays","Math","ceil","getDueDateWarningClass","add","addEventListener","preventDefault","returnValue","companyNameInput","brokerLeadEl","initialRequestInput","introEmailInput","remindersStartInput","emailFrequencyEl","extraNoteEl","auditTextEl","tasksRowEl","taskCardsContainer","taskNameInput","saveBtn","newTaskBtn","loadSelectedBtn","openKycPortalBtn","currentRowNum","showConfirmDialog","dialog","msgEl","cancelBtn","okBtn","style","display","cleanup","removeEventListener","onCancel","onOk","_callee","_t","_context","addNewTask","saveToActiveRow","console","error","_callee2","_t2","_context2","loadFromActiveRow","clearFormForNewTask","deleteTaskBtn","_callee3","_t3","_context3","deleteCurrentRow","dataset","kycListenerAttached","stopPropagation","kycOpening","open","tasksView","statsView","tasksHeader","statsHeader","openStatsBtn","returnToTasksBtn","refreshStatsBtn","loadStatistics","_loadStatistics","_callee11","_t5","_context12","Excel","run","_ref11","_callee10","context","sheet","dataRange","rows","todoCount","inProgressCount","doneCount","brokerStats","monthlyStats","kycMonthly","totalDuration","durationCount","overdueItems","upcomingItems","staleItems","sevenDaysFromNow","thirtyDaysAgo","_loop","activeTasks","totalStatus","renderAttentionGroup","monthlyChart","sortedMonths","maxTasks","maxKyc","maxVal","monthNames","brokerChart","sortedBrokers","_maxTasks","_context11","workbook","worksheets","getItemOrNullObject","load","sync","isNullObject","getRange","values","setDate","getDate","row","company","broker","initialRequest","introEmail","remindersStart","taskSummary","taskDate","dateE","dateF","dateG","availableDates","monthKey","_context10","trim","parseDate","filter","reduce","min","concat","getFullYear","getMonth","padStart","total","active","completed","split","Boolean","line","lower","toLowerCase","includes","completedMatch","match","kycDate","taskNameMatch","assigneeMatch","taskName","assignee","deadlineMatch","daysUntil","push","task","detail","abs","initiatedMatch","updatedMatch","lastActionDate","daysSince","initiated","days","_regeneratorValues","round","width","items","groupId","listId","countId","group","container","countEl","slice","map","item","assigneePart","join","sort","parseInt","keys","reverse","max","_toConsumableArray","month","_month$split2","_slicedToArray","shortMonth","tasks","kyc","kycHeight","entries","_ref12","name","_ref14","_ref16","_ref17","stats","activeWidth","completedWidth","_x6","dateVal","excelEpoch","result","dateStr","day","jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec","year","searchInput","searchInputWrap","searchBtn","searchResults","searchHint","searchTabs","currentSearchMode","loadRowHint","updateSearchUI","placeholder","tab","_callee4","_context4","getAttribute","performSearch","_callee5","_context5","_ref6","_callee6","_context6","key","hideAutocomplete","_x","autocompleteDropdown","companyList","autocompleteTimeout","loadCompanyList","_loadCompanyList","_callee13","_t6","_context14","_ref18","_callee12","category","_context13","rowNum","log","_x7","showAutocomplete","query","q","allMatches","startsWithMatches","startsWith","containsMatches","sortedMatches","categoryHint","_callee7","_context7","selectAndLoadRow","_performSearch","_callee16","_t7","_context18","_ref19","_callee15","rawValues","results","scannedRows","_loop2","totalRows","modeLabel","rawQuery","_context17","isArray","companyName","taskCategory","hasActiveTasks","dominantStatus","hasTodo","hasProgress","hasDone","todoDates","progressDates","doneDates","mostRecentDate","statusDateLabel","statusDateRaw","statusDateDisplay","_context16","dateArr","best","dStr","yyyy","mm","dd","every","parsed","parseTaskLine","st","status","updated","formatDateForDisplay","statusBadge","datePart","_callee14","_context15","_x8","_x2","_selectAndLoadRow","_callee18","_context20","_ref21","_callee17","_context19","select","_x9","findLastKycDate","_x3","_findLastKycDate","_callee20","_context22","_ref22","_callee19","usedRange","lastKycDate","rowCompany","_context21","getUsedRange","_x0","ymdMatch","clearTimeout","val","target","_callee8","_context8","formatDateForExcel","getSelectedCategories","cb","isOtherTaskSelected","checked","getTaskCard","getTaskStatusChips","setCardStatus","getCardStatus","find","contains","syncTasksVisibility","isOther","otherCard","hasNonOtherCategory","some","selected","Set","getSelectedTaskToggles","has","updateExtraNotePlaceholder","categories","reorderCheckboxesToTop","containerSelector","children","unchecked","appendChild","loadTeamMembers","_loadTeamMembers","_callee22","box","_context24","initialized","_ref23","_callee21","namesRaw","names","noneOpt","_context23","opt","_x1","getSelectedAssignees","updateTaskAssigneeDropdowns","selectedAssignees","dropdown","currentValue","emptyOpt","raw","basicMatch","exec","comment","giveUpId","commentMatch","giveUpMatch","buildSummaryLine","parts","assignees","_loadFromActiveRow","_callee26","_context28","_ref25","_callee25","selectedRange","uiRow","companyRange","descRange","assigneesRange","brokerRange","datesRange","hRange","jRange","kRange","companyVal","descVal","brokerVal","assigneesVal","assigneesList","datesRow","toInputDate","freqVal","noteVal","summary","lines","parsedTasks","nonTaskLines","cand","statusPriority","sNorm","commentEl","deadlineEl","taskAssigneeEl","chosenAudit","lastKycEl","kycCompletedDate","_context27","dmmyMatch","mon","getSelectedRange","rowIndex","cat","giveUpIdEl","pt","ptName","cbName","date","updateDateDisplays","updateEmailSummaryButton","emailSummarySection","_x11","_saveToActiveRow","_callee28","_context30","_ref26","_callee27","existing","newTaskLines","existingTasks","getTodayFormatted","computeDates","taskAssignee","existingTask","dates","payload","builtLine","toggles","fixedNames","sortedLines","newValue","hasInProgress","hasToDo","fontColor","_context29","newStatus","oldStatus","newStatusLower","hasAnyDate","format","font","color","_x12","visibleCard","focus","_deleteCurrentRow","_callee30","_context32","_ref27","_callee29","_context31","delete","DeleteShiftDirection","up","_x13","_addNewTask","_callee32","_context34","_ref28","_callee31","colA","nextRow","statusLower","hRangeNew","_context33","_x14","input","_ref9","inputEl","displayEl","formatted","emailSummaryBtn","emailSummaryList","emailSummaryCount","closeEmailSummaryBtn","disabled","loadEmailSummaries","_loadEmailSummaries","_callee33","response","data","summaries","_t8","_context35","fetch","encodeURIComponent","ok","json","is_draft","id","subject","formatEmailDate","toLocaleDateString","_callee9","_context9","confirmEmailSummary","_ref1","_callee1","summaryId","_t4","_context1","method","headers","body","JSON","stringify","task_row","_ref10","_callee0","cell","newRef","_context0","_x5","_x4","Office","onReady","info","host","HostType","chip","closest","selector","el","URL"],"ignoreList":[],"sourceRoot":""}