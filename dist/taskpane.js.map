{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js"],"sourcesContent":["// Task Manager task pane logic, wired to Excel via Office.js\n// Based on the scaffold in Task Manager Excel/addin/taskpane.js\n\n/* global document, Excel, Office */\n\n(function(){\n  const qs = (s)=>document.querySelector(s);\n  const qsa = (s)=>Array.from(document.querySelectorAll(s));\n  let teamMembersLoaded = false;\n  let hasUnsavedChanges = false;\n\n  // SmartBrief Integration\n  // Email summaries are fetched by VBA macro (SmartBrief.bas) and written to column L\n  // The add-in reads from column L to display summaries (no direct API calls from JS)\n\n  const EMAIL_SUMMARIZER_API_URL = 'http://192.168.1.141:5002';\n  const SMARTBRIEF_MATCH_THRESHOLD = 0.5;\n  \n  // Task-assignee pattern mapping\n  let taskAssigneePatterns = new Map(); // taskName -> Map(assignee -> count)\n  \n  // Build task-assignee pattern map from existing Excel data\n  async function buildTaskAssigneePatterns() {\n    try {\n      await Excel.run(async (context) => {\n        const sheet = context.workbook.worksheets.getItemOrNullObject('TASK MANAGER FORM');\n        sheet.load('name');\n        await context.sync();\n        \n        if (!sheet || sheet.isNullObject) {\n          return;\n        }\n        \n        // Clear existing patterns\n        taskAssigneePatterns.clear();\n        \n        // Read rows 2-1000 one by one\n        for (let row = 2; row <= 1000; row++) {\n          const hRange = sheet.getRange(`H${row}`);\n          hRange.load('values');\n          hRange.load('text');\n          await context.sync();\n          \n          // Check if we have data\n          const hasValue = hRange.values && hRange.values[0] && hRange.values[0][0];\n          const hasText = hRange.text && hRange.text[0] && hRange.text[0][0];\n          \n          if (!hasValue && !hasText) continue; // Skip empty rows\n          \n          const taskData = hRange.values[0][0] || hRange.text[0][0];\n          \n                    \n          if (typeof taskData === 'string') {\n            // Split by lines first, then by semicolon\n            const lines = taskData.split('\\n');\n            \n            lines.forEach(line => {\n              if (!line.trim()) return;\n              \n              // Parse format: \"Task: Status || Assigned to Assignee || Comment: ...\"\n              const taskEntries = line.split(';');\n              \n              taskEntries.forEach(entry => {\n                // Extract task name (before first colon)\n                const colonIndex = entry.indexOf(':');\n                if (colonIndex === -1) return;\n                \n                const taskName = entry.substring(0, colonIndex).trim();\n                if (!taskName) return;\n                \n                // Extract assignee after \"Assigned to\"\n                const assignedToMatch = entry.match(/Assigned to ([^|]+)/);\n                if (assignedToMatch) {\n                  const assignee = assignedToMatch[1].trim();\n                  \n                  if (assignee && assignee !== '') {\n                    // Update pattern map for this task-assignee pair\n                    if (!taskAssigneePatterns.has(taskName)) {\n                      taskAssigneePatterns.set(taskName, new Map());\n                    }\n                    \n                    const patternMap = taskAssigneePatterns.get(taskName);\n                    patternMap.set(assignee, (patternMap.get(assignee) || 0) + 1);\n                  }\n                }\n              });\n            });\n          }\n        }\n      });\n    } catch (error) {\n      console.error('Error building task-assignee patterns:', error);\n    }\n  }\n  \n  // Get most common assignee for a task based on patterns\n  function getMostCommonAssignee(taskName) {\n    const patterns = taskAssigneePatterns.get(taskName);\n    if (!patterns || patterns.size === 0) return null;\n    \n    let maxCount = 0;\n    let mostCommonAssignee = null;\n    \n    patterns.forEach((count, assignee) => {\n      if (count > maxCount) {\n        maxCount = count;\n        mostCommonAssignee = assignee;\n      }\n    });\n    \n    return mostCommonAssignee;\n  }\n\n  // Toast notification helper\n  function showToast(message, type = 'success', duration = 3000) {\n    const toast = qs('#toast');\n    if (!toast) return;\n    toast.textContent = message;\n    toast.className = 'toast ' + type + ' show';\n    setTimeout(() => {\n      toast.classList.remove('show');\n    }, duration);\n  }\n\n  // Check for missing fields and return array of missing field names\n  function checkMissingFields() {\n    const missing = [];\n\n    // Check company name\n    const companyName = qs('#companyName');\n    if (!companyName || !companyName.value.trim()) {\n      missing.push('Company Name');\n    }\n\n    // Check task category\n    const selectedCategories = Array.from(document.querySelectorAll('.category-toggle:checked'));\n    if (selectedCategories.length === 0) {\n      missing.push('Task Category');\n    }\n\n    // Check broker lead\n    const brokerLead = qs('#brokerLead');\n    if (!brokerLead || !brokerLead.value) {\n      missing.push('Broker Lead');\n    }\n\n    // Check assignees\n    const selectedAssignees = Array.from(document.querySelectorAll('#assignees input[type=checkbox]:checked'));\n    if (selectedAssignees.length === 0) {\n      missing.push('Assigned To');\n    }\n\n    \n    // Check visible task cards for status and deadline\n    const visibleTaskCards = Array.from(document.querySelectorAll('.task-card')).filter(card => {\n      return card.style.display !== 'none' && card.id !== 'otherTaskCard';\n    });\n\n    visibleTaskCards.forEach(card => {\n      const taskName = card.dataset.task || 'Task';\n      const activeChip = card.querySelector('.chip.active');\n      const deadlineInput = card.querySelector('[data-role=\"deadline\"]');\n\n      if (!activeChip) {\n        missing.push(`${taskName}: Status`);\n      }\n      if (!deadlineInput || !deadlineInput.value) {\n        missing.push(`${taskName}: Deadline`);\n      }\n    });\n\n    // Check \"Other Task\" card if visible\n    const otherTaskCard = qs('#otherTaskCard');\n    if (otherTaskCard && otherTaskCard.style.display !== 'none') {\n      const taskNameInput = qs('#taskName');\n      if (!taskNameInput || !taskNameInput.value.trim()) {\n        missing.push('Other Task: Task Name');\n      }\n      const activeChip = otherTaskCard.querySelector('.chip.active');\n      if (!activeChip) {\n        missing.push('Other Task: Status');\n      }\n      const deadlineInput = otherTaskCard.querySelector('[data-role=\"deadline\"]');\n      if (!deadlineInput || !deadlineInput.value) {\n        missing.push('Other Task: Deadline');\n      }\n    }\n\n    // Check email frequency (always at the end)\n    const emailFrequency = qs('#emailFrequency');\n    if (emailFrequency) {\n      const isEmpty = emailFrequency.tagName === 'SELECT' \n        ? emailFrequency.selectedIndex <= 0 || !emailFrequency.value\n        : !emailFrequency.value || emailFrequency.value.trim() === '';\n      \n      if (isEmpty) {\n        missing.push(' Email Frequency');\n      }\n    }\n\n    return missing;\n  }\n\n  // Show missing fields warning in a styled popup\n  function showMissingFieldsWarning(missingFields, successMessage = null) {\n    // Create overlay\n    const overlay = document.createElement('div');\n    overlay.className = 'confirm-overlay';\n    overlay.id = 'missingFieldsOverlay';\n\n    // Create box\n    const box = document.createElement('div');\n    box.className = 'confirm-box';\n    box.style.maxWidth = '320px';\n    box.style.textAlign = 'left';\n\n    // Title and content\n    if (missingFields.length === 0 && successMessage) {\n      // Show success message only\n      const title = document.createElement('p');\n      title.innerHTML = `<strong style=\"color:#10b981;\">${successMessage}</strong>`;\n      title.style.marginBottom = '12px';\n      title.style.textAlign = 'center';\n      box.appendChild(title);\n    } else {\n      // Show missing fields\n      const title = document.createElement('p');\n      title.innerHTML = '<strong style=\"color:#f59e0b;\"> Missing Fields</strong>';\n      title.style.marginBottom = '12px';\n      title.style.textAlign = 'center';\n      box.appendChild(title);\n\n      // Description\n      const desc = document.createElement('p');\n      desc.textContent = successMessage || 'The following fields are empty:';\n      desc.style.fontSize = '12px';\n      desc.style.color = '#64748b';\n      desc.style.marginBottom = '8px';\n      box.appendChild(desc);\n\n      // List of missing fields\n      const list = document.createElement('ul');\n      list.style.cssText = 'margin:0 0 16px 0;padding-left:20px;font-size:12px;color:#334155;max-height:150px;overflow-y:auto;';\n      missingFields.forEach(field => {\n        const li = document.createElement('li');\n        li.textContent = field;\n        li.style.marginBottom = '4px';\n        list.appendChild(li);\n      });\n      box.appendChild(list);\n    }\n\n    // Close button\n    const btnWrap = document.createElement('div');\n    btnWrap.style.textAlign = 'center';\n    const closeBtn = document.createElement('button');\n    closeBtn.textContent = 'Got it';\n    closeBtn.style.cssText = 'padding:8px 24px;font-size:13px;font-weight:500;border:none;border-radius:6px;background:#1e40af;color:#fff;cursor:pointer;';\n    closeBtn.addEventListener('click', () => {\n      overlay.remove();\n    });\n    btnWrap.appendChild(closeBtn);\n    box.appendChild(btnWrap);\n\n    overlay.appendChild(box);\n    document.body.appendChild(overlay);\n  }\n\n  // Unsaved changes indicator\n  function setUnsavedChanges(unsaved) {\n    hasUnsavedChanges = unsaved;\n    const indicator = qs('#unsavedIndicator');\n    if (indicator) {\n      indicator.classList.toggle('visible', unsaved);\n    }\n  }\n\n  // ============== SmartBrief Parsing Helpers ==============\n\n  function isLcmCommoditiesEmail(email) {\n    if (!email) return false;\n    const s = String(email).trim().toLowerCase();\n    return s.endsWith('@lcmcommodities.com');\n  }\n\n  // Parse participants from SmartBrief summary\n  // Format: \"## PARTICIPANTS\\n- Name (email@domain.com)\\n- Name2 (email2@domain.com)\"\n  function parseParticipantsFromSummary(summaryText) {\n    const participants = [];\n    const participantsMatch = summaryText.match(/## PARTICIPANTS\\n([\\s\\S]*?)(?=\\n## |$)/);\n    if (participantsMatch) {\n      const participantsBlock = participantsMatch[1];\n      const lines = participantsBlock.split('\\n').filter(l => l.trim().startsWith('-'));\n      lines.forEach(line => {\n        // Parse \"- Name (email@domain.com)\" or \"- Name\"\n        const match = line.match(/^-\\s*(.+?)(?:\\s*\\(([^)]+)\\))?\\s*$/);\n        if (match) {\n          const name = match[1].trim();\n          const email = match[2] ? match[2].trim() : '';\n          if (name) {\n            participants.push({ name, email });\n          }\n        }\n      });\n    }\n    return participants;\n  }\n\n  // Parse summary body from SmartBrief (the ## SUMMARY section)\n  function parseSummaryBodyFromSummary(summaryText) {\n    const summaryMatch = summaryText.match(/## SUMMARY\\n([\\s\\S]*?)(?=\\n## |$)/);\n    if (summaryMatch) {\n      return summaryMatch[1].trim();\n    }\n    // Fallback: return everything after the first line\n    const lines = summaryText.split('\\n');\n    return lines.slice(1).join('\\n').trim();\n  }\n\n  // Detect task category from summary text using keywords\n  function detectCategoryFromSummary(summaryText) {\n    const text = summaryText.toLowerCase();\n    \n    // Check for specific keywords\n    if (text.includes('onboarding') || text.includes('new client') || text.includes('new account') || text.includes('account opening')) {\n      return 'Onboarding';\n    }\n    if (text.includes('kyc') || text.includes('know your customer') || text.includes('compliance') || text.includes('documents') || text.includes('documentation')) {\n      return 'KYC update';\n    }\n    if (text.includes('rate') || text.includes('pricing') || text.includes('amendment') || text.includes('amended') || text.includes('fee') || text.includes('commission')) {\n      return 'Amended Product/Rate';\n    }\n    if (text.includes('give-up') || text.includes('giveup') || text.includes('give up')) {\n      return 'Give-up';\n    }\n    \n    return null; // No clear category detected\n  }\n\n  // Detect relevant tasks from summary text\n  function detectTasksFromSummary(summaryText) {\n    const text = (summaryText || '').toLowerCase();\n    const suggestedTasks = [];\n    \n    // Task keyword mappings\n    const taskMappings = [\n      { keywords: ['give-up', 'giveup', 'give up'], task: 'Give-up Agreement' },\n      { keywords: ['broker agreement', 'brokerage agreement', 'brokerage'], task: 'Broker Agreement' },\n      { keywords: ['annex a', 'amend annex', 'amendment'], task: 'Amend Annex A' },\n      { keywords: ['kyc', 'know your client', 'due diligence'], task: 'KYC (produced by LCMC)' },\n      { keywords: ['external kyc', 'third party kyc', 'counterparty kyc'], task: 'KYC External' }\n    ];\n    \n    // Check each mapping\n    taskMappings.forEach(mapping => {\n      if (mapping.keywords.some(keyword => text.includes(keyword))) {\n        suggestedTasks.push(mapping.task);\n      }\n    });\n    \n    // Remove duplicates while preserving order\n    return [...new Set(suggestedTasks)];\n  }\n\n  // Match participants to team members\n  // IMPORTANT: Only LCMCommodities employees can be assignees\n  // External participants (non-lcmcommodities.com emails) are excluded\n  function matchParticipantsToTeamMembers(participants) {\n    // Debug logging\n    console.log('=== SMARTBRIEF MATCH DEBUG ===');\n    console.log('Total participants found:', participants.length);\n    console.log('All participants:', participants);\n    \n    // Also show a toast notification\n    showToast(`SmartBrief: Processing ${participants.length} participants`, 'info');\n    \n    const teamCheckboxes = Array.from(document.querySelectorAll('#assignees input[type=checkbox]'));\n    \n    // Create team entries with email support - only include those with emails\n    const teamEntries = teamCheckboxes\n      .filter(cb => cb.dataset.email && cb.dataset.email.trim().length > 0)\n      .map(cb => {\n        const raw = String(cb.value || '');\n        const email = String(cb.dataset.email || '').toLowerCase();\n        const normalizeName = (s) => String(s || '')\n          .toLowerCase()\n          .replace(/[^a-z0-9\\s]/g, ' ')\n          .replace(/\\s+/g, ' ')\n          .trim();\n        \n        const norm = normalizeName(raw);\n        const parts = norm.split(' ').filter(Boolean);\n        return {\n          cb,\n          raw,\n          norm,\n          email,\n          first: parts[0] || '',\n          last: parts.length > 1 ? parts[parts.length - 1] : '',\n          isSingleToken: parts.length <= 1\n        };\n      });\n\n    const matched = [];\n    \n    // Filter to only LCMCommodities participants first\n    const lcmParticipants = participants.filter(p => isLcmCommoditiesEmail(p.email));\n    \n    console.log('[SmartBrief] LCM participants:', lcmParticipants.map(p => ({ name: p.name, email: p.email })));\n    console.log('[SmartBrief] Team entries:', teamEntries.map(e => ({ raw: e.raw, norm: e.norm, first: e.first, last: e.last, isSingleToken: e.isSingleToken })));\n\n    lcmParticipants.forEach(p => {\n      const pEmail = (p.email || '').toLowerCase();\n      let matchedEntry = null;\n      let matchReason = '';\n\n      // Only match by exact email - no fallbacks\n      if (pEmail) {\n        matchedEntry = teamEntries.find(e => e.email && e.email === pEmail);\n        if (matchedEntry) matchReason = 'exact email';\n      }\n\n      if (matchedEntry) {\n        console.log(`[SmartBrief] Matched participant \"${p.name}\" (${p.email}) -> team \"${matchedEntry.raw}\" via ${matchReason}`);\n        matched.push(matchedEntry.raw);\n      } else {\n        console.log(`[SmartBrief] No match for participant \"${p.name}\" (${p.email}) - no email match found`);\n      }\n    });\n    \n    return [...new Set(matched)]; // dedupe\n  }\n\n  // Store parsed SmartBrief data for \"Apply to Task\" action\n  let lastParsedSmartBrief = null;\n\n  async function fetchSmartBriefSummaryFromApi(company, initialRequest, introEmail, remindersStart) {\n    // Use proxy path on localhost (webpack dev server proxies /api to the API server)\n    // This avoids mixed-content issues (HTTPS page calling HTTP API)\n    const isLocalhost = typeof window !== 'undefined' \n      && window.location \n      && window.location.hostname === 'localhost';\n    \n    const baseUrl = isLocalhost ? '' : EMAIL_SUMMARIZER_API_URL;\n    const url = `${baseUrl}/api/task-manager/summaries/${encodeURIComponent(company)}`;\n\n    try {\n      // Only include dates that are non-empty to avoid API datetime parsing issues\n      const requestBody = { threshold: SMARTBRIEF_MATCH_THRESHOLD };\n      if (initialRequest) requestBody.initial_request = initialRequest;\n      if (introEmail) requestBody.intro_email = introEmail;\n      if (remindersStart) requestBody.reminders_start = remindersStart;\n\n      const doFetch = async (bodyObj) => {\n        const response = await fetch(url, {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify(bodyObj)\n        });\n\n        if (response.ok) {\n          return { ok: true, status: response.status, data: await response.json() };\n        }\n\n        let serverMsg = '';\n        try {\n          const errJson = await response.json();\n          if (errJson && typeof errJson === 'object') {\n            serverMsg = String(errJson.error || errJson.message || '');\n          }\n        } catch (_) {\n          try {\n            serverMsg = String(await response.text());\n          } catch (_) {\n            serverMsg = '';\n          }\n        }\n\n        return { ok: false, status: response.status, serverMsg };\n      };\n\n      // First attempt (with any provided date filters)\n      let result = await doFetch(requestBody);\n\n      // Workaround: API can 500 on date parsing (offset-naive vs offset-aware). Retry without dates.\n      const hasDates = Boolean(requestBody.initial_request || requestBody.intro_email || requestBody.reminders_start);\n      if (!result.ok && result.status === 500 && hasDates) {\n        result = await doFetch({ threshold: SMARTBRIEF_MATCH_THRESHOLD });\n      }\n\n      if (!result.ok) {\n        const suffix = result.serverMsg ? `: ${result.serverMsg}` : '';\n        throw new Error(`Server returned ${result.status}${suffix}`);\n      }\n\n      const data = result.data;\n      const summaries = Array.isArray(data.summaries) ? data.summaries : [];\n      if (summaries.length === 0) return '';\n\n      const best = summaries[0] || {};\n      const subject = String(best.subject || 'No subject');\n      const summary = String(best.summary || '').trim();\n      const matchScore = typeof best.match_score === 'number' ? best.match_score : parseFloat(best.match_score);\n      const matchPercent = Number.isFinite(matchScore) ? Math.round(matchScore * 100) : 0;\n\n      if (!summary) return '';\n      return `[${matchPercent}% match] ${subject}\\n\\n${summary}`;\n    } catch (err) {\n      // Common failure modes: mixed content (https add-in calling http API) or CORS\n      const msg = err && err.message ? err.message : String(err);\n      showToast('SmartBrief API error: ' + msg, 'error');\n      return '';\n    }\n  }\n\n  // Track form changes\n  function wireChangeTracking() {\n    const formElements = qsa('input, select, textarea');\n    formElements.forEach(el => {\n      el.addEventListener('change', () => setUnsavedChanges(true));\n      el.addEventListener('input', () => setUnsavedChanges(true));\n    });\n    // Also track chip clicks\n    qsa('.chip').forEach(chip => {\n      chip.addEventListener('click', () => setUnsavedChanges(true));\n    });\n  }\n\n  // Warn before leaving with unsaved changes\n  window.addEventListener('beforeunload', (e) => {\n    if (hasUnsavedChanges) {\n      e.preventDefault();\n      e.returnValue = '';\n      return '';\n    }\n  });\n\n  // Escape HTML helper\n  function escapeHtml(text) {\n    const div = document.createElement('div');\n    div.textContent = String(text || '');\n    return div.innerHTML;\n  }\n\n  function formatSmartBriefBodyToHtml(bodyText) {\n    const text = String(bodyText || '').replace(/\\r\\n/g, '\\n').replace(/\\r/g, '\\n');\n    const lines = text.split('\\n');\n\n    const out = [];\n    let lastWasBlank = false;\n\n    lines.forEach((line) => {\n      const headerMatch = line.match(/^##\\s*(.+?)\\s*$/);\n      if (headerMatch) {\n        const title = headerMatch[1].trim();\n        out.push(\n          `<div style=\"margin-top:10px;margin-bottom:6px;color:var(--primary);font-weight:700;font-size:11px;letter-spacing:.6px;text-transform:uppercase;\">${escapeHtml(title)}</div>`\n        );\n        lastWasBlank = false;\n        return;\n      }\n\n      // Remove markdown task checkboxes (e.g. \"- [ ] Do something\", \"- [x] Done\")\n      const normalizedLine = String(line).replace(/^(\\s*-\\s*)\\[(?:\\s|x|X)\\]\\s+/, '$1');\n\n      if (!normalizedLine.trim()) {\n        if (!lastWasBlank) {\n          out.push('<div style=\"height:8px\"></div>');\n          lastWasBlank = true;\n        }\n        return;\n      }\n\n      out.push(`<div>${escapeHtml(normalizedLine)}</div>`);\n      lastWasBlank = false;\n    });\n\n    return out.join('');\n  }\n\n  // Due date warning helper\n  function getDueDateWarningClass(deadlineStr) {\n    if (!deadlineStr) return '';\n    const deadline = new Date(deadlineStr);\n    if (isNaN(deadline.getTime())) return '';\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n    deadline.setHours(0, 0, 0, 0);\n    const diffDays = Math.ceil((deadline - today) / (1000 * 60 * 60 * 24));\n    if (diffDays < 0) return 'overdue';\n    if (diffDays <= 3) return 'warning';\n    return '';\n  }\n\n  function formatDeadlineBadge(deadlineStr) {\n    const warningClass = getDueDateWarningClass(deadlineStr);\n    if (!warningClass) return '';\n    if (warningClass === 'overdue') {\n      return '<span class=\"deadline-badge overdue\"> Overdue</span>';\n    }\n    const deadline = new Date(deadlineStr);\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n    deadline.setHours(0, 0, 0, 0);\n    const diffDays = Math.ceil((deadline - today) / (1000 * 60 * 60 * 24));\n    if (diffDays === 0) return '<span class=\"deadline-badge warning\"> Due today</span>';\n    if (diffDays === 1) return '<span class=\"deadline-badge warning\"> Due tomorrow</span>';\n    return `<span class=\"deadline-badge warning\"> ${diffDays} days left</span>`;\n  }\n\n  // Apply deadline warnings to task cards\n  function applyDeadlineWarnings() {\n    qsa('.task-card').forEach(card => {\n      const deadlineInput = card.querySelector('[data-role=\"deadline\"]');\n      if (!deadlineInput) return;\n      const deadline = deadlineInput.value;\n      const warningClass = getDueDateWarningClass(deadline);\n      card.classList.remove('deadline-warning', 'deadline-overdue');\n      if (warningClass === 'overdue') {\n        card.classList.add('deadline-overdue');\n      } else if (warningClass === 'warning') {\n        card.classList.add('deadline-warning');\n      }\n    });\n  }\n\n  const companyNameInput = qs('#companyName');\n  // taskDescriptionEl is now a container with checkboxes, not a select\n  const brokerLeadEl = qs('#brokerLead');\n  const initialRequestInput = qs('#initialRequest');\n  const introEmailInput = qs('#introEmail');\n  const remindersStartInput = qs('#remindersStart');\n  const emailFrequencyEl = qs('#emailFrequency');\n  const extraNoteEl = qs('#extraNote');\n  const auditTextEl = qs('#auditText');\n  const tasksRowEl = qs('#tasksRow');\n  const taskCardsContainer = qs('#taskCards');\n  const taskNameInput = qs('#taskName'); // only for __other__ card\n\n  // Wire Save, New Task, Load Selected, and KYC Portal buttons\n  const saveBtn = qs('#saveBtn');\n  const newTaskBtn = qs('#newTaskBtn');\n  const loadSelectedBtn = qs('#loadSelectedBtn');\n  const openKycPortalBtn = qs('#openKycPortal');\n\n  // Track current row for display\n  let currentRowNum = null;\n\n  if (saveBtn) {\n    saveBtn.addEventListener('click', async () => {\n      try {\n        // Check for missing fields before saving\n        const missingFields = checkMissingFields();\n\n        if (currentRowNum === null || currentRowNum === 'new') {\n          await addNewTask();\n          if (missingFields.length === 0) {\n            // Show success in central popup only\n            showMissingFieldsWarning([], ' Excellent! Task completed with all required fields properly filled.');\n          } else {\n            // Show missing fields in central popup only\n            showMissingFieldsWarning(missingFields, ' New task added successfully!');\n          }\n        } else {\n          await saveToActiveRow();\n          if (missingFields.length === 0) {\n            // Show success in central popup only\n            showMissingFieldsWarning([], ' Perfect! All task details are complete and saved successfully.');\n          } else {\n            // Show missing fields in central popup only\n            showMissingFieldsWarning(missingFields, ` Changes saved to row ${currentRowNum}!`);\n          }\n        }\n        setUnsavedChanges(false);\n        \n        // Update task-assignee patterns after successful save\n        buildTaskAssigneePatterns();\n      } catch (e) {\n        console.error('Save error:', e);\n        showToast(' Save failed: ' + e.message, 'error');\n      }\n    });\n  }\n\n  // Load Selected Row button (in By Row tab)\n  if (loadSelectedBtn) {\n    loadSelectedBtn.addEventListener('click', async () => {\n      try {\n        await loadFromActiveRow();\n        showToast(' Loaded row ' + currentRowNum, 'success');\n      } catch (e) {\n        console.error('Load error:', e);\n        showToast(' Failed to load row', 'error');\n      }\n    });\n  }\n\n  if (newTaskBtn) {\n    newTaskBtn.addEventListener('click', () => {\n      clearFormForNewTask();\n    });\n  }\n\n  // Custom confirm dialog (since window.confirm is not supported in Office Add-ins)\n  function showConfirmDialog(message) {\n    return new Promise((resolve) => {\n      const dialog = qs('#confirmDialog');\n      const msgEl = qs('#confirmMessage');\n      const cancelBtn = qs('#confirmCancel');\n      const okBtn = qs('#confirmOk');\n      \n      if (!dialog || !msgEl || !cancelBtn || !okBtn) {\n        resolve(false);\n        return;\n      }\n      \n      msgEl.textContent = message;\n      dialog.style.display = 'flex';\n      \n      const cleanup = () => {\n        dialog.style.display = 'none';\n        cancelBtn.removeEventListener('click', onCancel);\n        okBtn.removeEventListener('click', onOk);\n      };\n      \n      const onCancel = () => {\n        cleanup();\n        resolve(false);\n      };\n      \n      const onOk = () => {\n        cleanup();\n        resolve(true);\n      };\n      \n      cancelBtn.addEventListener('click', onCancel);\n      okBtn.addEventListener('click', onOk);\n    });\n  }\n\n  // Delete Task button\n  const deleteTaskBtn = qs('#deleteTaskBtn');\n  if (deleteTaskBtn) {\n    deleteTaskBtn.addEventListener('click', async () => {\n      // Don't allow delete if this is a new unsaved task\n      if (currentRowNum === null || currentRowNum === 'new') {\n        showToast('No task to delete - this is a new task', 'error');\n        return;\n      }\n      \n      // Confirm before deleting\n      const confirmed = await showConfirmDialog('Are you sure you want to delete this Task?');\n      if (!confirmed) return;\n      \n      try {\n        await deleteCurrentRow();\n        showToast(' Task deleted successfully', 'success');\n        clearFormForNewTask();\n      } catch (e) {\n        console.error('Delete error:', e);\n        showToast(' Failed to delete task: ' + e.message, 'error');\n      }\n    });\n  }\n\n  // Guard on the DOM element so we don't wire multiple listeners or open twice\n  if (openKycPortalBtn && openKycPortalBtn.dataset.kycListenerAttached !== '1') {\n    openKycPortalBtn.dataset.kycListenerAttached = '1';\n    openKycPortalBtn.addEventListener('click', (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n      if (openKycPortalBtn.dataset.kycOpening === '1') return;\n      openKycPortalBtn.dataset.kycOpening = '1';\n      window.open('http://192.168.1.141:8080/', '_blank');\n      setTimeout(() => { openKycPortalBtn.dataset.kycOpening = '0'; }, 1000);\n    });\n  }\n\n  // Statistics Navigation\n  const tasksView = qs('#tasksView');\n  const statsView = qs('#statsView');\n  const tasksHeader = qs('#tasksHeader');\n  const statsHeader = qs('#statsHeader');\n  const openStatsBtn = qs('#openStatsBtn');\n  const returnToTasksBtn = qs('#returnToTasksBtn');\n  const refreshStatsBtn = qs('#refreshStatsBtn');\n\n  if (openStatsBtn) {\n    openStatsBtn.addEventListener('click', () => {\n      if (tasksView) tasksView.style.display = 'none';\n      if (tasksHeader) tasksHeader.style.display = 'none';\n      if (statsView) statsView.style.display = '';\n      if (statsHeader) statsHeader.style.display = 'flex';\n      loadStatistics();\n    });\n  }\n\n  if (returnToTasksBtn) {\n    returnToTasksBtn.addEventListener('click', () => {\n      if (tasksView) tasksView.style.display = '';\n      if (tasksHeader) tasksHeader.style.display = 'flex';\n      if (statsView) statsView.style.display = 'none';\n      if (statsHeader) statsHeader.style.display = 'none';\n    });\n  }\n\n  if (refreshStatsBtn) {\n    refreshStatsBtn.addEventListener('click', () => {\n      loadStatistics();\n    });\n  }\n\n  // Statistics calculation\n  async function loadStatistics() {\n    try {\n      await Excel.run(async (context) => {\n        const sheet = context.workbook.worksheets.getItemOrNullObject('TASK MANAGER FORM');\n        sheet.load('name');\n        await context.sync();\n        if (sheet.isNullObject) {\n          console.error('Sheet not found for statistics');\n          return;\n        }\n\n        // Load all data\n        const dataRange = sheet.getRange('A1:K5000');\n        dataRange.load('values');\n        await context.sync();\n\n        const rows = dataRange.values || [];\n        if (rows.length < 2) return;\n\n        // Parse all tasks\n        const tasks = [];\n        let todoCount = 0, inProgressCount = 0, doneCount = 0;\n        const brokerStats = {};\n        const monthlyStats = {};\n        const kycMonthly = {};\n        let totalDuration = 0, durationCount = 0;\n        \n        // Attention items with details\n        const overdueItems = [];\n        const upcomingItems = [];\n        const staleItems = [];\n\n        const today = new Date();\n        today.setHours(0, 0, 0, 0);\n        const sevenDaysFromNow = new Date(today);\n        sevenDaysFromNow.setDate(sevenDaysFromNow.getDate() + 7);\n        const thirtyDaysAgo = new Date(today);\n        thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);\n\n        for (let i = 1; i < rows.length; i++) {\n          const row = rows[i];\n          const company = row[0] ? String(row[0]).trim() : '';\n          if (!company) continue;\n\n          const category = row[1] ? String(row[1]).trim() : '';\n          const broker = row[3] ? String(row[3]).trim() : '(none)';\n          const initialRequest = row[4]; // Column E - Initial Request Date\n          const introEmail = row[5]; // Column F - Intro Email Date\n          const remindersStart = row[6]; // Column G - Reminders Start Date\n          const taskSummary = row[7] ? String(row[7]).trim() : '';\n\n          // Parse dates from columns E, F, G for monthly stats\n          // Use the earliest available date as the task creation date\n          let taskDate = null;\n          const dateE = parseDate(initialRequest);\n          const dateF = parseDate(introEmail);\n          const dateG = parseDate(remindersStart);\n          \n          // Pick the earliest non-null date\n          const availableDates = [dateE, dateF, dateG].filter(d => d !== null);\n          if (availableDates.length > 0) {\n            taskDate = availableDates.reduce((min, d) => d < min ? d : min);\n          }\n          \n          if (taskDate) {\n            const monthKey = `${taskDate.getFullYear()}-${String(taskDate.getMonth() + 1).padStart(2, '0')}`;\n            monthlyStats[monthKey] = (monthlyStats[monthKey] || 0) + 1;\n          }\n\n          // Broker stats\n          if (!brokerStats[broker]) {\n            brokerStats[broker] = { total: 0, active: 0, completed: 0 };\n          }\n          brokerStats[broker].total++;\n\n          // Parse task summary for status\n          if (taskSummary) {\n            const lines = taskSummary.split(/\\r?\\n/).filter(Boolean);\n            lines.forEach(line => {\n              const lower = line.toLowerCase();\n              \n              // Count statuses\n              if (lower.includes(': to do')) {\n                todoCount++;\n                brokerStats[broker].active++;\n              } else if (lower.includes(': in progress')) {\n                inProgressCount++;\n                brokerStats[broker].active++;\n              } else if (lower.includes(': done')) {\n                doneCount++;\n                brokerStats[broker].completed++;\n              }\n\n              // Check for KYC completed\n              if (lower.includes('kyc') && lower.includes(': done')) {\n                const completedMatch = line.match(/completed:\\s*(\\d{1,2}[-\\s][A-Za-z]{3}[-\\s]\\d{2,4})/i);\n                if (completedMatch) {\n                  const kycDate = parseDate(completedMatch[1]);\n                  if (kycDate) {\n                    const monthKey = `${kycDate.getFullYear()}-${String(kycDate.getMonth() + 1).padStart(2, '0')}`;\n                    kycMonthly[monthKey] = (kycMonthly[monthKey] || 0) + 1;\n                  }\n                }\n              }\n\n              // Extract task name and assignee for attention items\n              const taskNameMatch = line.match(/^(.*?)\\s*:\\s*(to do|in progress|done)/i);\n              const assigneeMatch = line.match(/assigned to\\s+([^|]+)/i);\n              const taskName = taskNameMatch ? taskNameMatch[1].trim() : 'Unknown';\n              const assignee = assigneeMatch ? assigneeMatch[1].trim() : '';\n\n              // Check deadlines (support both formats)\n              const deadlineMatch = line.match(/deadline:\\s*(\\d{4}-\\d{2}-\\d{2}|\\d{1,2}[-\\s][A-Za-z]{3}[-\\s]\\d{2,4})/i);\n              if (deadlineMatch && !lower.includes(': done')) {\n                const deadline = parseDate(deadlineMatch[1]);\n                if (deadline) {\n                  const daysUntil = Math.ceil((deadline - today) / (1000 * 60 * 60 * 24));\n                  if (deadline < today) {\n                    overdueItems.push({\n                      company,\n                      task: taskName,\n                      assignee,\n                      detail: `${Math.abs(daysUntil)}d overdue`\n                    });\n                  } else if (deadline <= sevenDaysFromNow) {\n                    upcomingItems.push({\n                      company,\n                      task: taskName,\n                      assignee,\n                      detail: daysUntil === 0 ? 'Today' : `${daysUntil}d left`\n                    });\n                  }\n                }\n              }\n\n              // Check for stale tasks (no status update for 30+ days, not Done)\n              if (!lower.includes(': done')) {\n                // Look for the last action date (initiated, updated, or completed)\n                const initiatedMatch = line.match(/initiated:\\s*(\\d{1,2}[-\\s][A-Za-z]{3}[-\\s]\\d{2,4})/i);\n                const updatedMatch = line.match(/updated:\\s*(\\d{1,2}[-\\s][A-Za-z]{3}[-\\s]\\d{2,4})/i);\n                \n                let lastActionDate = null;\n                if (updatedMatch) {\n                  lastActionDate = parseDate(updatedMatch[1]);\n                } else if (initiatedMatch) {\n                  lastActionDate = parseDate(initiatedMatch[1]);\n                }\n                \n                if (lastActionDate && lastActionDate < thirtyDaysAgo) {\n                  const daysSince = Math.ceil((today - lastActionDate) / (1000 * 60 * 60 * 24));\n                  staleItems.push({\n                    company,\n                    task: taskName,\n                    assignee,\n                    detail: `${daysSince}d ago`\n                  });\n                }\n              }\n\n              // Calculate duration for completed tasks\n              if (lower.includes(': done')) {\n                const initiatedMatch = line.match(/initiated:\\s*(\\d{1,2}[-\\s][A-Za-z]{3}[-\\s]\\d{2,4})/i);\n                const completedMatch = line.match(/completed:\\s*(\\d{1,2}[-\\s][A-Za-z]{3}[-\\s]\\d{2,4})/i);\n                if (initiatedMatch && completedMatch) {\n                  const initiated = parseDate(initiatedMatch[1]);\n                  const completed = parseDate(completedMatch[1]);\n                  if (initiated && completed) {\n                    const days = Math.ceil((completed - initiated) / (1000 * 60 * 60 * 24));\n                    if (days >= 0 && days < 365) {\n                      totalDuration += days;\n                      durationCount++;\n                    }\n                  }\n                }\n              }\n            });\n          }\n        }\n\n        // Update UI\n        const activeTasks = todoCount + inProgressCount;\n        qs('#statActiveTasks').textContent = activeTasks;\n        qs('#statAvgDuration').textContent = durationCount > 0 ? Math.round(totalDuration / durationCount) : '-';\n\n        // Status bars\n        const totalStatus = todoCount + inProgressCount + doneCount;\n        if (totalStatus > 0) {\n          qs('#barToDo').style.width = (todoCount / totalStatus * 100) + '%';\n          qs('#barInProgress').style.width = (inProgressCount / totalStatus * 100) + '%';\n          qs('#barDone').style.width = (doneCount / totalStatus * 100) + '%';\n        }\n        qs('#countToDo').textContent = todoCount;\n        qs('#countInProgress').textContent = inProgressCount;\n        qs('#countDone').textContent = doneCount;\n\n        // Attention Required section - render counts and task lists\n        // Helper to render attention items and show/hide group\n        const renderAttentionGroup = (items, groupId, listId, countId) => {\n          const group = qs(`#${groupId}`);\n          const container = qs(`#${listId}`);\n          const countEl = qs(`#${countId}`);\n          \n          if (countEl) countEl.textContent = items.length;\n          \n          if (!group || !container) return;\n          \n          if (items.length === 0) {\n            group.classList.remove('has-items');\n            container.innerHTML = '';\n            return;\n          }\n          \n          group.classList.add('has-items');\n          // Format: \"Company: Task to Assignee\" with detail on right\n          container.innerHTML = items.slice(0, 10).map(item => {\n            const assigneePart = item.assignee ? ` <span class=\"to-assignee\">to ${escapeHtml(item.assignee)}</span>` : '';\n            return `<div class=\"attention-item\">\n              <span class=\"task-info\" title=\"${escapeHtml(item.company)}: ${escapeHtml(item.task)}\">${escapeHtml(item.company)}: ${escapeHtml(item.task)}${assigneePart}</span>\n              <span class=\"task-detail\">${escapeHtml(item.detail)}</span>\n            </div>`;\n          }).join('');\n        };\n        \n        // Sort and render each list\n        overdueItems.sort((a, b) => parseInt(b.detail) - parseInt(a.detail)); // Most overdue first\n        upcomingItems.sort((a, b) => parseInt(a.detail) - parseInt(b.detail)); // Soonest first\n        staleItems.sort((a, b) => parseInt(b.detail) - parseInt(a.detail)); // Oldest first\n        \n        renderAttentionGroup(overdueItems, 'overdueGroup', 'overdueList', 'statOverdue');\n        renderAttentionGroup(upcomingItems, 'upcomingGroup', 'upcomingList', 'statUpcoming');\n        renderAttentionGroup(staleItems, 'staleGroup', 'staleList', 'statStale');\n\n        // Monthly Activity Visual Chart\n        const monthlyChart = qs('#monthlyChart');\n        if (monthlyChart) {\n          const sortedMonths = Object.keys(monthlyStats).sort().reverse().slice(0, 6).reverse();\n          const maxTasks = Math.max(...sortedMonths.map(m => monthlyStats[m] || 0), 1);\n          const maxKyc = Math.max(...sortedMonths.map(m => kycMonthly[m] || 0), 1);\n          const maxVal = Math.max(maxTasks, maxKyc);\n          \n          const monthNames = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];\n          monthlyChart.innerHTML = sortedMonths.map(month => {\n            const [year, m] = month.split('-');\n            const shortMonth = monthNames[parseInt(m) - 1];\n            const tasks = monthlyStats[month] || 0;\n            const kyc = kycMonthly[month] || 0;\n            const taskHeight = maxVal > 0 ? (tasks / maxVal * 80) : 0;\n            const kycHeight = maxVal > 0 ? (kyc / maxVal * 80) : 0;\n            return `<div class=\"month-bar-group\">\n              <div class=\"month-bars\">\n                <div class=\"month-bar tasks\" style=\"height:${taskHeight}px\">\n                  ${tasks > 0 ? `<span class=\"month-bar-value\">${tasks}</span>` : ''}\n                </div>\n                <div class=\"month-bar kyc\" style=\"height:${kycHeight}px\">\n                  ${kyc > 0 ? `<span class=\"month-bar-value\">${kyc}</span>` : ''}\n                </div>\n              </div>\n              <div class=\"month-bar-label\">${shortMonth}</div>\n            </div>`;\n          }).join('');\n        }\n\n        // Broker Activity Visual Chart - Horizontal Bars like Status Distribution\n        const brokerChart = qs('#brokerChart');\n        if (brokerChart) {\n          const sortedBrokers = Object.entries(brokerStats)\n            .filter(([name]) => name && name !== '(none)' && name.trim() !== '')\n            .sort((a, b) => (b[1].active + b[1].completed) - (a[1].active + a[1].completed));\n          // Find max for scaling (active + completed combined)\n          const maxTasks = Math.max(...sortedBrokers.map(([,s]) => s.active + s.completed), 1);\n          \n          brokerChart.innerHTML = sortedBrokers.map(([name, stats]) => {\n            const activeWidth = maxTasks > 0 ? (stats.active / maxTasks * 100) : 0;\n            const completedWidth = maxTasks > 0 ? (stats.completed / maxTasks * 100) : 0;\n            return `<div class=\"broker-row\">\n              <span class=\"broker-name\" title=\"${escapeHtml(name)}\">${escapeHtml(name)}</span>\n              <div class=\"broker-bar-track\">\n                <div class=\"broker-bar-fill active\" style=\"width:${activeWidth}%\">${stats.active > 0 ? `<span class=\"bar-num\">${stats.active}</span>` : ''}</div>\n                <div class=\"broker-bar-fill completed\" style=\"width:${completedWidth}%\">${stats.completed > 0 ? `<span class=\"bar-num\">${stats.completed}</span>` : ''}</div>\n              </div>\n            </div>`;\n          }).join('');\n        }\n      });\n    } catch (e) {\n      console.error('Error loading statistics:', e);\n    }\n  }\n\n  // Helper to parse various date formats including Excel serial numbers\n  // Fix for timezone-related date parsing bug\n  // When parsing yyyy-MM-dd strings, JavaScript interprets them as UTC midnight.\n  // This can cause day shifts when the local timezone is behind UTC.\n  function parseDate(dateVal) {\n    if (!dateVal) return null;\n    \n    // Check if it's an Excel serial number (numeric value)\n    // Excel dates are days since Jan 1, 1900 (with a bug for 1900 leap year)\n    if (typeof dateVal === 'number' && dateVal > 1 && dateVal < 100000) {\n      // Excel serial date: days since Dec 30, 1899 (accounting for Excel's leap year bug)\n      // Use UTC to avoid timezone issues, then create local date\n      const excelEpoch = Date.UTC(1899, 11, 30); // Dec 30, 1899 in UTC\n      const utcDate = new Date(excelEpoch + dateVal * 24 * 60 * 60 * 1000);\n      // Create a local date with the same year/month/day\n      const result = new Date(utcDate.getUTCFullYear(), utcDate.getUTCMonth(), utcDate.getUTCDate());\n      if (!isNaN(result.getTime()) && result.getFullYear() > 1970) {\n        return result;\n      }\n    }\n    \n    // Try as string\n    const dateStr = String(dateVal).trim();\n    \n    // Handle yyyy-MM-dd format (ISO) - parse directly to avoid timezone issues\n    const isoMatch = dateStr.match(/^(\\d{4})-(\\d{2})-(\\d{2})$/);\n    if (isoMatch) {\n      const year = parseInt(isoMatch[1], 10);\n      const month = parseInt(isoMatch[2], 10) - 1; // 0-indexed\n      const day = parseInt(isoMatch[3], 10);\n      return new Date(year, month, day);\n    }\n    \n    // Try d-MMM-yyyy format (e.g., \"15-Nov-2025\")\n    const match = dateStr.match(/(\\d{1,2})[-\\s]([A-Za-z]{3})[-\\s](\\d{2,4})/);\n    if (match) {\n      const months = {jan:0,feb:1,mar:2,apr:3,may:4,jun:5,jul:6,aug:7,sep:8,oct:9,nov:10,dec:11};\n      const day = parseInt(match[1]);\n      const month = months[match[2].toLowerCase()];\n      let year = parseInt(match[3]);\n      if (year < 100) year += 2000;\n      if (month !== undefined) {\n        return new Date(year, month, day);\n      }\n    }\n    \n    // Fallback: try native parsing (but this may have timezone issues)\n    let d = new Date(dateStr);\n    if (!isNaN(d.getTime()) && d.getFullYear() > 1970) return d;\n    \n    return null;\n  }\n\n  // Search functionality\n  const searchInput = qs('#searchInput');\n  const searchInputWrap = qs('#searchInputWrap');\n  const searchBtn = qs('#searchBtn');\n  const searchResults = qs('#searchResults');\n  const searchHint = qs('#searchHint');\n  const searchTabs = qsa('.search-tab');\n  let currentSearchMode = 'active'; // Default to active tasks\n\n  // Update search UI based on mode\n  const loadRowHint = qs('#loadRowHint');\n  \n  function updateSearchUI() {\n    if (!searchHint || !searchInput || !searchInputWrap) return;\n    \n    if (currentSearchMode === 'active') {\n      searchInputWrap.style.display = 'none'; // No input needed\n      if (loadRowHint) loadRowHint.style.display = 'none';\n      searchHint.textContent = ' Showing tasks with status: To Do or In Progress';\n    } else if (currentSearchMode === 'company') {\n      searchInputWrap.style.display = 'flex';\n      if (loadRowHint) loadRowHint.style.display = 'flex';\n      searchInput.placeholder = 'Type company name...';\n      searchInput.type = 'text';\n      searchHint.textContent = '';\n    }\n  }\n\n  // Search tab switching\n  searchTabs.forEach(tab => {\n    tab.addEventListener('click', async () => {\n      searchTabs.forEach(t => t.classList.remove('active'));\n      tab.classList.add('active');\n      currentSearchMode = tab.getAttribute('data-search');\n      if (searchInput) {\n        searchInput.value = '';\n      }\n      updateSearchUI();\n      \n      // Auto-load active tasks when that tab is selected\n      if (currentSearchMode === 'active') {\n        await performSearch();\n      } else {\n        // Clear results for other modes until user searches\n        if (searchResults) {\n          searchResults.classList.remove('visible');\n          searchResults.innerHTML = '';\n        }\n      }\n    });\n  });\n\n  // Search button click\n  if (searchBtn) {\n    searchBtn.addEventListener('click', async () => {\n      await performSearch();\n    });\n  }\n\n  // Enter key in search input\n  if (searchInput) {\n    searchInput.addEventListener('keypress', async (e) => {\n      if (e.key === 'Enter') {\n        hideAutocomplete();\n        await performSearch();\n      }\n    });\n  }\n\n  // Autocomplete for company search\n  const autocompleteDropdown = qs('#autocompleteDropdown');\n  let companyList = []; // Cache of all companies with row numbers\n  let autocompleteTimeout = null;\n\n  // Load all companies for autocomplete (includes ALL rows, not just unique companies)\n  async function loadCompanyList() {\n    if (companyList.length > 0) return; // Already loaded\n    try {\n      await Excel.run(async (context) => {\n        const sheet = context.workbook.worksheets.getItemOrNullObject('TASK MANAGER FORM');\n        sheet.load('name');\n        await context.sync();\n        if (sheet.isNullObject) return;\n\n        // Load columns A (company) and B (task category) to differentiate multiple rows\n        const dataRange = sheet.getRange('A2:B5000');\n        dataRange.load('values');\n        await context.sync();\n\n        const values = dataRange.values || [];\n        companyList = [];\n        for (let i = 0; i < values.length; i++) {\n          const name = values[i][0] ? String(values[i][0]).trim() : '';\n          const category = values[i][1] ? String(values[i][1]).trim() : '';\n          if (name) {\n            companyList.push({ name, category, rowNum: i + 2 });\n          }\n        }\n        // Keep ALL entries - don't remove duplicates so users can see all tasks for a company\n        console.log('Loaded', companyList.length, 'company rows for autocomplete');\n      });\n    } catch (e) {\n      console.error('Failed to load company list:', e);\n    }\n  }\n\n  function showAutocomplete(query) {\n    if (!autocompleteDropdown || !query || currentSearchMode !== 'company') {\n      hideAutocomplete();\n      return;\n    }\n    const q = query.toLowerCase();\n    \n    // Filter matches and sort: companies starting with query first, then contains\n    const allMatches = companyList.filter(c => c.name.toLowerCase().includes(q));\n    const startsWithMatches = allMatches.filter(c => c.name.toLowerCase().startsWith(q));\n    const containsMatches = allMatches.filter(c => !c.name.toLowerCase().startsWith(q));\n    const sortedMatches = [...startsWithMatches, ...containsMatches].slice(0, 15);\n    \n    if (sortedMatches.length === 0) {\n      hideAutocomplete();\n      return;\n    }\n    autocompleteDropdown.innerHTML = sortedMatches.map(c => {\n      const categoryHint = c.category ? `  ${escapeHtml(c.category)}` : '';\n      return `<div class=\"autocomplete-item\" data-row=\"${c.rowNum}\" data-name=\"${escapeHtml(c.name)}\">\n        <span class=\"company-name\">${escapeHtml(c.name)}</span>\n        <span class=\"row-hint\">Row ${c.rowNum}${categoryHint}</span>\n      </div>`;\n    }).join('');\n    autocompleteDropdown.classList.add('visible');\n\n    // Wire click handlers\n    autocompleteDropdown.querySelectorAll('.autocomplete-item').forEach(item => {\n      item.addEventListener('click', async () => {\n        const rowNum = parseInt(item.getAttribute('data-row'), 10);\n        const name = item.getAttribute('data-name');\n        if (searchInput) searchInput.value = name;\n        hideAutocomplete();\n        await selectAndLoadRow(rowNum);\n      });\n    });\n  }\n\n  function hideAutocomplete() {\n    if (autocompleteDropdown) {\n      autocompleteDropdown.classList.remove('visible');\n      autocompleteDropdown.innerHTML = '';\n    }\n  }\n\n  // Wire autocomplete on input\n  if (searchInput) {\n    searchInput.addEventListener('input', (e) => {\n      if (currentSearchMode !== 'company') return;\n      clearTimeout(autocompleteTimeout);\n      const val = e.target.value.trim();\n      if (val.length < 1) {\n        hideAutocomplete();\n        return;\n      }\n      // Debounce to avoid too many updates\n      autocompleteTimeout = setTimeout(() => {\n        showAutocomplete(val);\n      }, 150);\n    });\n\n    searchInput.addEventListener('focus', async () => {\n      if (currentSearchMode === 'company') {\n        await loadCompanyList();\n        if (searchInput.value.trim().length >= 1) {\n          showAutocomplete(searchInput.value.trim());\n        }\n      }\n    });\n\n    searchInput.addEventListener('blur', () => {\n      // Delay hide to allow click on dropdown\n      setTimeout(hideAutocomplete, 200);\n    });\n  }\n\n  // Initialize search UI on load\n  updateSearchUI();\n\n  async function performSearch() {\n    if (!searchResults) return;\n    \n    searchResults.innerHTML = '<div class=\"no-results\">Searching...</div>';\n    searchResults.classList.add('visible');\n    console.log('Search started, mode:', currentSearchMode);\n\n    try {\n      await Excel.run(async (context) => {\n        const sheet = context.workbook.worksheets.getItemOrNullObject('TASK MANAGER FORM');\n        sheet.load('name');\n        await context.sync();\n        console.log('Sheet found:', !sheet.isNullObject);\n        if (sheet.isNullObject) {\n          searchResults.innerHTML = '<div class=\"no-results\">Sheet not found</div>';\n          return;\n        }\n\n        // Read a fixed block of rows to avoid issues with usedRange returning too small an area.\n        const maxRows = 5000;\n        const dataRange = sheet.getRange(`A1:K${maxRows}`);\n        dataRange.load('values');\n        await context.sync();\n\n        const rawValues = dataRange.values || [];\n        console.log('Raw rows loaded (including header and blanks):', rawValues.length);\n\n        const values = Array.isArray(rawValues) ? rawValues : [];\n        const results = [];\n        let scannedRows = 0;\n\n        for (let i = 1; i < values.length; i++) { // Skip header row\n          const row = values[i] || [];\n          const isEmpty = row.every(c => c === null || c === '');\n          if (isEmpty) continue;\n          scannedRows++;\n          const companyName = row[0] ? String(row[0]).trim() : '';\n          const taskCategory = row[1] ? String(row[1]).trim() : '';\n          const taskSummary = row[7] ? String(row[7]).trim() : ''; // Column H\n\n          // Determine status and dates from Column H\n          let hasActiveTasks = false;\n          let dominantStatus = 'unknown';\n          let hasTodo = false, hasProgress = false, hasDone = false;\n          let todoDates = [];\n          let progressDates = [];\n          let doneDates = [];\n\n          if (taskSummary) {\n            const lines = taskSummary.split(/\\r?\\n/).filter(Boolean);\n            lines.forEach(line => {\n              const parsed = parseTaskLine(line);\n              if (!parsed) return;\n              const st = (parsed.status || '').toLowerCase();\n              if (st === 'to do') {\n                hasTodo = true;\n                if (parsed.initiated) todoDates.push(parsed.initiated);\n              } else if (st === 'in progress') {\n                hasProgress = true;\n                if (parsed.updated) progressDates.push(parsed.updated);\n              } else if (st === 'done') {\n                hasDone = true;\n                if (parsed.completed) doneDates.push(parsed.completed);\n              }\n            });\n            hasActiveTasks = hasTodo || hasProgress;\n            if (hasProgress) dominantStatus = 'progress';\n            else if (hasTodo) dominantStatus = 'todo';\n            else if (hasDone) dominantStatus = 'done';\n          }\n\n          // Choose a status-specific date to display\n          function mostRecentDate(dateArr) {\n            if (!dateArr || dateArr.length === 0) return '';\n            let best = null;\n            dateArr.forEach(dStr => {\n              if (!dStr) return;\n              const d = new Date(dStr);\n              if (isNaN(d.getTime())) return;\n              if (!best || d > best) best = d;\n            });\n            if (!best) return '';\n            const yyyy = best.getFullYear();\n            const mm = String(best.getMonth() + 1).padStart(2,'0');\n            const dd = String(best.getDate()).padStart(2,'0');\n            return `${yyyy}-${mm}-${dd}`; // normalized for display formatter\n          }\n\n          let statusDateLabel = '';\n          let statusDateRaw = '';\n          if (dominantStatus === 'progress') {\n            statusDateRaw = mostRecentDate(progressDates);\n            statusDateLabel = statusDateRaw ? 'Updated' : '';\n          } else if (dominantStatus === 'todo') {\n            statusDateRaw = mostRecentDate(todoDates);\n            statusDateLabel = statusDateRaw ? 'Initiated' : '';\n          } else if (dominantStatus === 'done') {\n            statusDateRaw = mostRecentDate(doneDates);\n            statusDateLabel = statusDateRaw ? 'Completed' : '';\n          }\n\n          const statusDateDisplay = statusDateRaw ? formatDateForDisplay(statusDateRaw) : '';\n\n          const rowNum = i + 1; // 1-based row number\n\n          if (currentSearchMode === 'company') {\n            const query = (searchInput ? searchInput.value : '').toLowerCase().trim();\n            console.log('Checking row', rowNum, '- Company:', companyName, '- Query:', query);\n            if (query && companyName.toLowerCase().includes(query)) {\n              console.log('Match found:', companyName);\n              results.push({ rowNum, companyName, taskCategory, dominantStatus, hasActiveTasks, statusDateLabel, statusDateDisplay });\n            }\n          } else if (currentSearchMode === 'active') {\n            console.log('Checking row', rowNum, '- Company:', companyName, '- Active:', hasActiveTasks);\n            if (hasActiveTasks) {\n              results.push({ rowNum, companyName, taskCategory, dominantStatus, hasActiveTasks, statusDateLabel, statusDateDisplay });\n            }\n          }\n        }\n\n        const totalRows = scannedRows;\n        const modeLabel = currentSearchMode === 'company' ? 'Company' : 'Active tasks';\n        const rawQuery = (searchInput ? searchInput.value : '').trim();\n        console.log('Search complete, mode:', modeLabel, 'rows scanned:', totalRows, 'matches:', results.length, 'query:', rawQuery);\n        if (results.length === 0) {\n          searchResults.innerHTML = '<div class=\"no-results\">No results found</div>';\n        } else {\n          searchResults.innerHTML = results.map(r => {\n            const statusBadge = r.dominantStatus === 'progress' \n              ? '<span class=\"status-badge progress\">In Progress</span>'\n              : r.dominantStatus === 'todo'\n              ? '<span class=\"status-badge todo\">To Do</span>'\n              : r.dominantStatus === 'done'\n              ? '<span class=\"status-badge done\">Done</span>'\n              : '';\n\n            const datePart = (r.statusDateLabel && r.statusDateDisplay)\n              ? `  ${r.statusDateLabel} ${escapeHtml(r.statusDateDisplay)}`\n              : '';\n\n            return `<div class=\"search-result-item\" data-row=\"${r.rowNum}\">\n              <div class=\"company\">${escapeHtml(r.companyName || '(No name)')}${statusBadge}</div>\n              <div class=\"meta\">Row ${r.rowNum}  ${escapeHtml(r.taskCategory || 'No category')}${datePart}</div>\n            </div>`;\n          }).join('');\n\n          // Wire click handlers\n          searchResults.querySelectorAll('.search-result-item').forEach(item => {\n            item.addEventListener('click', async () => {\n              const rowNum = parseInt(item.getAttribute('data-row'), 10);\n              await selectAndLoadRow(rowNum);\n              searchResults.classList.remove('visible');\n            });\n          });\n        }\n      });\n    } catch (e) {\n      console.error('Search error:', e);\n      searchResults.innerHTML = '<div class=\"no-results\">Search error</div>';\n    }\n  }\n\n  async function selectAndLoadRow(rowNum) {\n    await Excel.run(async (context) => {\n      const sheet = context.workbook.worksheets.getItemOrNullObject('TASK MANAGER FORM');\n      sheet.load('name');\n      await context.sync();\n      if (sheet.isNullObject) return;\n\n      const targetRange = sheet.getRange(`A${rowNum}`);\n      targetRange.select();\n      await context.sync();\n    });\n    await loadFromActiveRow();\n  }\n\n  // Find Last KYC Produced date for a company\n  async function findLastKycDate(companyName) {\n    if (!companyName) return null;\n    \n    return Excel.run(async (context) => {\n      const sheet = context.workbook.worksheets.getItemOrNullObject('TASK MANAGER FORM');\n      sheet.load('name');\n      await context.sync();\n      if (sheet.isNullObject) return null;\n\n      const usedRange = sheet.getUsedRange();\n      usedRange.load('values');\n      await context.sync();\n\n      const values = usedRange.values || [];\n      let lastKycDate = null;\n\n      for (let i = 1; i < values.length; i++) {\n        const row = values[i];\n        const rowCompany = row[0] ? String(row[0]).trim().toLowerCase() : '';\n        const taskSummary = row[7] ? String(row[7]).trim() : ''; // Column H\n\n        if (rowCompany === companyName.toLowerCase() && taskSummary) {\n          // Look for KYC task with Done status\n          const lines = taskSummary.split(/\\r?\\n/).filter(Boolean);\n          lines.forEach(line => {\n            const lower = line.toLowerCase();\n            if ((lower.includes('kyc') && lower.includes(': done'))) {\n              // Try to extract completed date\n              const completedMatch = line.match(/completed:\\s*(\\d{1,2}[-\\s][A-Za-z]{3}[-\\s]\\d{2,4})/i);\n              if (completedMatch) {\n                lastKycDate = completedMatch[1];\n              }\n            }\n          });\n        }\n      }\n      return lastKycDate;\n    });\n  }\n\n  // Format date as d-MMM-yyyy (e.g., 1-Jul-2025)\n  // Fix for timezone-related date shift bug\n  // When parsing yyyy-MM-dd strings, JavaScript interprets them as UTC midnight.\n  // This can cause day shifts when converting back to local time.\n  function formatDateForDisplay(dateStr) {\n    if (!dateStr) return '';\n    \n    // Handle yyyy-MM-dd format specially to avoid timezone issues\n    const ymdMatch = String(dateStr).match(/^(\\d{4})-(\\d{2})-(\\d{2})$/);\n    if (ymdMatch) {\n      // Parse components directly to avoid UTC interpretation\n      const year = parseInt(ymdMatch[1], 10);\n      const month = parseInt(ymdMatch[2], 10) - 1; // 0-indexed\n      const day = parseInt(ymdMatch[3], 10);\n      const months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];\n      return `${day}-${months[month]}-${year}`;\n    }\n    \n    // For other formats, use Date parsing\n    const d = new Date(dateStr);\n    if (isNaN(d.getTime())) return '';\n    const months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];\n    const day = d.getDate();\n    const month = months[d.getMonth()];\n    const year = d.getFullYear();\n    return `${day}-${month}-${year}`;\n  }\n  \n  // Alias for Excel output (same format)\n  const formatDateForExcel = formatDateForDisplay;\n\n  // Get selected task categories\n  function getSelectedCategories() {\n    return qsa('#taskCategories .category-toggle:checked').map(cb => cb.value);\n  }\n\n  // Check if \"Other Task\" is selected\n  function isOtherTaskSelected() {\n    const cb = qs('#taskCategories .category-toggle[value=\"Other Task\"]');\n    return cb && cb.checked;\n  }\n\n  function getTaskCard(taskName){\n    // __other__ card is now outside #taskCards\n    if (taskName === '__other__') {\n      return qs('#otherTaskCard');\n    }\n    return taskCardsContainer ? taskCardsContainer.querySelector(`.task-card[data-task=\"${taskName}\"]`) : null;\n  }\n\n  function getTaskStatusChips(card){\n    if (!card) return [];\n    const container = card.querySelector('[data-role=\"status-chips\"]');\n    return container ? Array.from(container.querySelectorAll('.chip')) : [];\n  }\n\n  function setCardStatus(card, val){\n    const chips = getTaskStatusChips(card);\n    chips.forEach(c=>{\n      c.classList.toggle('active', c.getAttribute('data-value')===val);\n    });\n  }\n\n  function getCardStatus(card){\n    const chips = getTaskStatusChips(card);\n    const active = chips.find(c=>c.classList.contains('active'));\n    return active ? active.getAttribute('data-value') : 'To Do';\n  }\n\n  function wireCardChips(){\n    // Wire chips in #taskCards and #otherTaskCard\n    qsa('#taskCards [data-role=\"status-chips\"] .chip, #otherTaskCard [data-role=\"status-chips\"] .chip').forEach(chip => {\n      chip.addEventListener('click', () => {\n        const container = chip.closest('[data-role=\"status-chips\"]');\n        if (!container) return;\n        const siblings = Array.from(container.querySelectorAll('.chip'));\n        siblings.forEach(c=>{\n          c.classList.toggle('active', c === chip);\n        });\n      });\n    });\n  }\n\n  function syncTasksVisibility(){\n    if (!tasksRowEl || !taskCardsContainer) return;\n    const isOther = isOtherTaskSelected();\n    const otherCard = qs('#otherTaskCard'); // Now outside #taskCards\n    const selectedCategories = getSelectedCategories();\n    const hasNonOtherCategory = selectedCategories.some(c => c !== 'Other Task');\n\n    // Show tasks section if any non-\"Other Task\" category is selected\n    if (hasNonOtherCategory) {\n      tasksRowEl.style.display = '';\n    } else {\n      tasksRowEl.style.display = 'none';\n    }\n\n    // Show/hide fixed task cards based on task toggles\n    const selected = new Set(getSelectedTaskToggles());\n    const fixedCards = qsa('#taskCards .task-card');\n    fixedCards.forEach(card => {\n      const name = card.getAttribute('data-task');\n      card.style.display = selected.has(name) ? '' : 'none';\n    });\n\n    // Show __other__ card if \"Other Task\" category is selected\n    if (otherCard) {\n      otherCard.style.display = isOther ? '' : 'none';\n    }\n  }\n\n  // Update Extra Note placeholder based on selected categories\n  function updateExtraNotePlaceholder() {\n    if (!extraNoteEl) return;\n    const categories = getSelectedCategories().filter(c => c !== 'Other Task');\n    if (categories.length === 0) {\n      extraNoteEl.placeholder = 'General note about this task';\n    } else if (categories.length === 1) {\n      extraNoteEl.placeholder = 'General note about this ' + categories[0];\n    } else {\n      extraNoteEl.placeholder = 'General note about these tasks';\n    }\n  }\n\n  // Wire category checkboxes to update visibility and placeholder\n  qsa('#taskCategories .category-toggle').forEach(cb => {\n    cb.addEventListener('change', () => {\n      syncTasksVisibility();\n      updateExtraNotePlaceholder();\n    });\n  });\n\n  function getSelectedTaskToggles(){\n    return qsa('#tasksChecklist .task-toggle:checked').map(cb => cb.value);\n  }\n\n  // Reorder checkboxes so checked ones appear at the top\n  function reorderCheckboxesToTop(containerSelector) {\n    const container = qs(containerSelector);\n    if (!container) return;\n    \n    // Get all items - could be direct children (div wrappers) or labels\n    const items = Array.from(container.children);\n    if (items.length === 0) return;\n    \n    // Sort: checked items first, then unchecked (maintain original order within each group)\n    const checked = [];\n    const unchecked = [];\n    items.forEach(item => {\n      const cb = item.querySelector('input[type=checkbox]') || item.querySelector('input[type=\"checkbox\"]');\n      if (cb && cb.checked) {\n        checked.push(item);\n      } else {\n        unchecked.push(item);\n      }\n    });\n    \n    // Re-append in sorted order: checked first, then unchecked\n    [...checked, ...unchecked].forEach(item => container.appendChild(item));\n  }\n\n  async function loadTeamMembers(){\n    if (teamMembersLoaded) return;\n    teamMembersLoaded = true; // guard immediately to avoid overlapping calls\n    const box = qs('#assignees');\n    if (!box) return;\n    // Additional DOM-level guard in case the script is evaluated more than once\n    if (box.dataset.initialized === '1') {\n      return;\n    }\n    box.dataset.initialized = '1';\n    box.innerHTML='';\n\n    await Excel.run(async (context) => {\n      const sheet = context.workbook.worksheets.getItemOrNullObject('Team members');\n      sheet.load('name');\n      await context.sync();\n      if (sheet.isNullObject) {\n        console.error('Team members sheet not found');\n        return;\n      }\n\n      // Read columns A and B for names and emails\n      const usedRange = sheet.getUsedRange();\n      usedRange.load('values');\n      await context.sync();\n\n      const values = usedRange.values || [];\n      const teamMembers = values.slice(1) // skip header row\n        .map(row => ({\n          name: row[0] ? String(row[0]).trim() : '',\n          email: row[1] ? String(row[1]).trim().toLowerCase() : ''\n        }))\n        .filter(m => m.name && m.name.length > 0);\n\n      console.log('Team members loaded from columns A and B:', teamMembers); // Debug log\n\n      teamMembers.forEach(m => {\n        const w = document.createElement('div');\n        // Store email in data attribute for matching\n        w.innerHTML = `<label><input type=\"checkbox\" value=\"${m.name}\" data-email=\"${m.email}\"> ${m.name}</label>`;\n        box.appendChild(w);\n      });\n\n      if (brokerLeadEl) {\n        brokerLeadEl.innerHTML = '';\n        const noneOpt = document.createElement('option');\n        noneOpt.value = '';\n        noneOpt.textContent = '(none)';\n        brokerLeadEl.appendChild(noneOpt);\n        teamMembers.forEach(m => {\n          const opt = document.createElement('option');\n          opt.value = m.name;\n          opt.textContent = m.name;\n          brokerLeadEl.appendChild(opt);\n        });\n      }\n    });\n  }\n\n  function getSelectedAssignees(){\n    return Array.from(document.querySelectorAll('#assignees input[type=checkbox]:checked')).map(i=>i.value);\n  }\n\n  // Populate per-task assignee dropdowns with selected assignees\n  function updateTaskAssigneeDropdowns() {\n    const selectedAssignees = getSelectedAssignees();\n    const dropdowns = qsa('.task-assignee-select');\n    \n    dropdowns.forEach(dropdown => {\n      const currentValue = dropdown.value;\n      dropdown.innerHTML = '';\n      \n      // Add empty option\n      const emptyOpt = document.createElement('option');\n      emptyOpt.value = '';\n      emptyOpt.textContent = '(Select assignee)';\n      dropdown.appendChild(emptyOpt);\n      \n      // Add selected assignees as options\n      selectedAssignees.forEach(name => {\n        const opt = document.createElement('option');\n        opt.value = name;\n        opt.textContent = name;\n        dropdown.appendChild(opt);\n      });\n      \n      // Auto-select if only one assignee\n      if (selectedAssignees.length === 1) {\n        dropdown.value = selectedAssignees[0];\n      } else if (selectedAssignees.includes(currentValue)) {\n        // Restore previous selection if still valid\n        dropdown.value = currentValue;\n      }\n    });\n  }\n\n  // Wire assignee checkboxes to update per-task dropdowns\n  document.querySelectorAll('#assignees').forEach(container => {\n    container.addEventListener('change', (e) => {\n      if (e.target.type === 'checkbox') {\n        updateTaskAssigneeDropdowns();\n      }\n    });\n  });\n\n  async function getActiveRowIndex(){\n    return Excel.run(async (context) => {\n      // Use the currently selected range in the workbook\n      const range = context.workbook.getSelectedRange();\n      range.load('rowIndex');\n      await context.sync();\n      // rowIndex is 0-based; UI shows 1-based row numbers\n      return range.rowIndex + 1;\n    });\n  }\n\n  function parseTaskLine(raw){\n    // More flexible parsing that handles fields in any order\n    if (!raw) return null;\n    \n    // First, check basic structure: \"TaskName: Status || Assigned to ...\"\n    const basicMatch = /^(.*?)\\s*:\\s*(to do|in progress|done)\\s*\\|\\|\\s*assigned to\\s+([^|]+)/i.exec(raw);\n    if (!basicMatch) return null;\n    \n    const result = {\n      name: basicMatch[1].trim(),\n      status: basicMatch[2],\n      assignee: basicMatch[3].trim(),\n      comment: '',\n      giveUpId: '',\n      initiated: '',\n      updated: '',\n      completed: '',\n      deadline: ''\n    };\n    \n    // Extract optional fields in any order\n    const commentMatch = /\\|\\|\\s*comment:\\s*([^|]+)/i.exec(raw);\n    if (commentMatch) result.comment = commentMatch[1].trim();\n    \n    const giveUpMatch = /\\|\\|\\s*give-up id:\\s*([^|]+)/i.exec(raw);\n    if (giveUpMatch) result.giveUpId = giveUpMatch[1].trim();\n    \n    const initiatedMatch = /\\|\\|\\s*task initiated:\\s*([^|]+)/i.exec(raw);\n    if (initiatedMatch) result.initiated = initiatedMatch[1].trim();\n    \n    const updatedMatch = /\\|\\|\\s*status updated:\\s*([^|]+)/i.exec(raw);\n    if (updatedMatch) result.updated = updatedMatch[1].trim();\n    \n    const completedMatch = /\\|\\|\\s*completed:\\s*([^|]+)/i.exec(raw);\n    if (completedMatch) result.completed = completedMatch[1].trim();\n    \n    const deadlineMatch = /\\|\\|\\s*deadline:\\s*([^|]+)/i.exec(raw);\n    if (deadlineMatch) result.deadline = deadlineMatch[1].trim();\n    \n    return result;\n  }\n\n  function buildSummaryLine(v){\n    const parts = [];\n    const status = v.status || 'To Do';\n    // First segment must match parseTaskLine: \"<TaskName>: <Status>\"\n    parts.push(`${v.name}: ${status}`);\n    parts.push(`Assigned to ${v.assignees}`);\n    if (v.comment) parts.push(`Comment: ${v.comment}`);\n    if (v.giveUpId) parts.push(`Give-up ID: ${v.giveUpId}`);\n    // Only one date field will be set based on status (last action)\n    if (v.initiated) parts.push(`Task initiated: ${v.initiated}`);\n    if (v.updated) parts.push(`Status updated: ${v.updated}`);\n    if (v.completed) parts.push(`Completed: ${v.completed}`);\n    if (v.deadline) parts.push(`Deadline: ${v.deadline}`);\n    return parts.join(' || ');\n  }\n\n  async function loadFromActiveRow(){\n    await loadTeamMembers();\n    await Excel.run(async (context) => {\n      // Get active row within the same context to avoid sync issues\n      const selectedRange = context.workbook.getSelectedRange();\n      selectedRange.load('rowIndex');\n      await context.sync();\n      const uiRow = selectedRange.rowIndex + 1;\n\n      const sheet = context.workbook.worksheets.getItemOrNullObject('TASK MANAGER FORM');\n      sheet.load('name');\n      await context.sync();\n      if (sheet.isNullObject) return;\n\n      // Load row-level metadata and Column H, J, K in one go\n      const companyRange = sheet.getRange(`A${uiRow}`);\n      const descRange = sheet.getRange(`B${uiRow}`);\n      const assigneesRange = sheet.getRange(`C${uiRow}`);\n      const brokerRange = sheet.getRange(`D${uiRow}`);\n      const datesRange = sheet.getRange(`E${uiRow}:G${uiRow}`);\n      const hRange = sheet.getRange(`H${uiRow}`);\n      const jRange = sheet.getRange(`J${uiRow}`);\n      const kRange = sheet.getRange(`K${uiRow}`);\n      companyRange.load('values');\n      descRange.load('values');\n      assigneesRange.load('values');\n      brokerRange.load('values');\n      datesRange.load('values');\n      hRange.load('values');\n      jRange.load('values');\n      kRange.load('values');\n      await context.sync();\n\n      // Company name from column A\n      const companyVal = (companyRange.values && companyRange.values[0] && companyRange.values[0][0])\n        ? String(companyRange.values[0][0])\n        : '';\n      if (companyNameInput) companyNameInput.value = companyVal;\n\n      const descVal = (descRange.values && descRange.values[0] && descRange.values[0][0])\n        ? String(descRange.values[0][0])\n        : '';\n      // Parse comma-separated categories and check the corresponding checkboxes\n      const categories = descVal.split(',').map(s => s.trim()).filter(Boolean);\n      const allowedDescs = ['Onboarding', 'Amended Product/Rate', 'KYC update', 'Other Task'];\n      qsa('#taskCategories .category-toggle').forEach(cb => {\n        const match = categories.some(cat => cat.toLowerCase() === cb.value.toLowerCase());\n        cb.checked = match;\n      });\n\n      const brokerVal = (brokerRange.values && brokerRange.values[0] && brokerRange.values[0][0])\n        ? String(brokerRange.values[0][0])\n        : '';\n\n      if (brokerLeadEl) {\n        brokerLeadEl.value = brokerVal;\n      }\n\n      // Assignees from column C\n      const assigneesVal = (assigneesRange.values && assigneesRange.values[0] && assigneesRange.values[0][0])\n        ? String(assigneesRange.values[0][0])\n        : '';\n      const assigneesList = assigneesVal.split(/[,;]+/).map(s => s.trim().toLowerCase()).filter(Boolean);\n      console.log('Assignees from column C:', assigneesList);\n      document.querySelectorAll('#assignees input[type=checkbox]').forEach(cb => {\n        cb.checked = assigneesList.includes(cb.value.toLowerCase());\n      });\n\n      const datesRow = (datesRange.values && datesRange.values[0]) ? datesRange.values[0] : [null, null, null];\n\n      // Fix for timezone-related date shift bug in toInputDate\n      // When parsing yyyy-MM-dd strings, JavaScript interprets them as UTC midnight.\n      // This can cause day shifts when converting back to local time.\n      function toInputDate(v){\n        if (v == null || v === '') return '';\n        \n        // Excel serial number (days since 1900-01-01, with Excel's leap year bug)\n        if (typeof v === 'number') {\n          // Excel serial date: 1 = Jan 1, 1900\n          // Use UTC to avoid timezone issues\n          const excelEpoch = Date.UTC(1899, 11, 30); // Dec 30, 1899 (Excel's day 0) in UTC\n          const d = new Date(excelEpoch + v * 86400000);\n          const yyyy = d.getUTCFullYear();\n          const mm = String(d.getUTCMonth() + 1).padStart(2,'0');\n          const dd = String(d.getUTCDate()).padStart(2,'0');\n          return `${yyyy}-${mm}-${dd}`;\n        }\n        \n        // Excel usually returns Date objects for date cells\n        if (v instanceof Date) {\n          const yyyy = v.getFullYear();\n          const mm = String(v.getMonth() + 1).padStart(2,'0');\n          const dd = String(v.getDate()).padStart(2,'0');\n          return `${yyyy}-${mm}-${dd}`;\n        }\n        \n        const s = String(v).trim();\n        \n        // Handle yyyy-MM-dd format (ISO) - parse directly to avoid timezone issues\n        const ymdMatch = s.match(/^(\\d{4})-(\\d{2})-(\\d{2})$/);\n        if (ymdMatch) {\n          return s; // Already in correct format, return as-is\n        }\n        \n        // Handle d-MMM-yyyy format (e.g., \"1-Jul-2025\")\n        const dmmyMatch = s.match(/^(\\d{1,2})-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\\d{4})$/i);\n        if (dmmyMatch) {\n          const months = {jan:0,feb:1,mar:2,apr:3,may:4,jun:5,jul:6,aug:7,sep:8,oct:9,nov:10,dec:11};\n          const day = parseInt(dmmyMatch[1], 10);\n          const mon = months[dmmyMatch[2].toLowerCase()];\n          const year = parseInt(dmmyMatch[3], 10);\n          const dd = String(day).padStart(2,'0');\n          const mm = String(mon + 1).padStart(2,'0');\n          return `${year}-${mm}-${dd}`;\n        }\n        \n        // Try to parse strings / other values as dates\n        // But be careful with timezone issues\n        const d = new Date(v);\n        if (!isNaN(d.getTime())) {\n          const yyyy = d.getFullYear();\n          const mm = String(d.getMonth() + 1).padStart(2,'0');\n          const dd = String(d.getDate()).padStart(2,'0');\n          return `${yyyy}-${mm}-${dd}`;\n        }\n        \n        // Fallback: attempt to slice a yyyy-MM-dd looking prefix\n        return s.length >= 10 ? s.slice(0,10) : '';\n      }\n\n      console.log('Date values from Excel:', datesRow); // Debug log\n      if (initialRequestInput) initialRequestInput.value = toInputDate(datesRow[0]);\n      if (introEmailInput) introEmailInput.value = toInputDate(datesRow[1]);\n      if (remindersStartInput) remindersStartInput.value = toInputDate(datesRow[2]);\n      console.log('Parsed dates:', initialRequestInput?.value, introEmailInput?.value, remindersStartInput?.value); // Debug log\n\n      // Email Frequency from column J\n      const freqVal = (jRange.values && jRange.values[0] && jRange.values[0][0])\n        ? String(jRange.values[0][0])\n        : '';\n      if (emailFrequencyEl) emailFrequencyEl.value = freqVal;\n\n      // Extra Note from column K\n      const noteVal = (kRange.values && kRange.values[0] && kRange.values[0][0])\n        ? String(kRange.values[0][0])\n        : '';\n      if (extraNoteEl) extraNoteEl.value = noteVal;\n\n      const summary = (hRange.values && hRange.values[0] && hRange.values[0][0])\n        ? String(hRange.values[0][0])\n        : '';\n\n      // Parse all task lines in H\n      const lines = summary\n        .split(/\\r?\\n/)\n        .map(s => s.trim())\n        .filter(Boolean);\n      const parsedTasks = [];\n      const nonTaskLines = [];\n      for (let i = 0; i < lines.length; i++) {\n        const cand = parseTaskLine(lines[i]);\n        if (cand) {\n          parsedTasks.push(cand);\n        } else {\n          nonTaskLines.push(lines[i]);\n        }\n      }\n\n      // Sort tasks by status priority: To Do > In Progress > Done\n      const statusPriority = { 'to do': 1, 'in progress': 2, 'done': 3 };\n      parsedTasks.sort((a, b) => {\n        const aPriority = statusPriority[(a.status || '').toLowerCase()] || 4;\n        const bPriority = statusPriority[(b.status || '').toLowerCase()] || 4;\n        return aPriority - bPriority;\n      });\n\n      // Note: Assignees are already loaded from Column C (lines 1297-1305)\n      // Column C contains ALL assignees including \"passive\" ones not assigned to specific tasks\n      // We don't overwrite here - the checkboxes are already correctly set from Column C\n      console.log('Parsed tasks:', parsedTasks); // Debug log\n\n      // Update per-task assignee dropdowns with selected assignees\n      updateTaskAssigneeDropdowns();\n\n      // Reset all cards and task selections\n      qsa('#tasksChecklist .task-toggle').forEach(cb => { cb.checked = false; });\n      qsa('#taskCards .task-card, #otherTaskCard').forEach(card => {\n        const statusChips = getTaskStatusChips(card);\n        statusChips.forEach(c => c.classList.remove('active'));\n        const commentEl = card.querySelector('[data-role=\"comment\"]');\n        const deadlineEl = card.querySelector('[data-role=\"deadline\"]');\n        const giveUpIdEl = card.querySelector('[data-role=\"giveUpId\"]');\n        const taskAssigneeEl = card.querySelector('[data-role=\"task-assignee\"]');\n        if (commentEl) commentEl.value = '';\n        if (deadlineEl) deadlineEl.value = '';\n        if (giveUpIdEl) giveUpIdEl.value = '';\n        if (taskAssigneeEl) taskAssigneeEl.value = '';\n      });\n\n      const isOther = isOtherTaskSelected();\n      if (isOther) {\n        // Use __other__ card with first parsed task if present\n        const otherCard = getTaskCard('__other__');\n        if (otherCard) {\n          const t = parsedTasks[0] || null;\n          if (taskNameInput) taskNameInput.value = t && t.name ? t.name : '';\n          if (t) {\n            const sNorm = (t.status || '').toLowerCase();\n            const displayStatus = sNorm === 'in progress' ? 'In Progress'\n              : sNorm === 'done' ? 'Done'\n              : 'To Do';\n            setCardStatus(otherCard, displayStatus);\n            const commentEl = otherCard.querySelector('[data-role=\"comment\"]');\n            const deadlineEl = otherCard.querySelector('[data-role=\"deadline\"]');\n            const taskAssigneeEl = otherCard.querySelector('[data-role=\"task-assignee\"]');\n            if (commentEl) commentEl.value = t.comment || '';\n            if (deadlineEl) deadlineEl.value = (t.deadline || '').slice(0,10);\n            // Set per-task assignee from parsed task\n            if (taskAssigneeEl && t.assignee) {\n              taskAssigneeEl.value = t.assignee.trim();\n            }\n          }\n        }\n      } else {\n        // Fixed tasks: tick checkboxes and populate corresponding cards\n        const toggles = qsa('#tasksChecklist .task-toggle');\n        toggles.forEach(cb => {\n          const name = cb.value;\n          // Map legacy \"KYC (Internal)\" to \"KYC (produced by LCMC)\"\n          const t = parsedTasks.find(pt => {\n            const ptName = (pt.name || '').toLowerCase();\n            const cbName = name.toLowerCase();\n            if (ptName === cbName) return true;\n            // Legacy mapping\n            if (cbName === 'kyc (produced by lcmc)' && ptName === 'kyc (internal)') return true;\n            return false;\n          });\n          cb.checked = !!t;\n          const card = getTaskCard(name);\n          if (card && t) {\n            const sNorm = (t.status || '').toLowerCase();\n            const displayStatus = sNorm === 'in progress' ? 'In Progress'\n              : sNorm === 'done' ? 'Done'\n              : 'To Do';\n            setCardStatus(card, displayStatus);\n            const commentEl = card.querySelector('[data-role=\"comment\"]');\n            const deadlineEl = card.querySelector('[data-role=\"deadline\"]');\n            const giveUpIdEl = card.querySelector('[data-role=\"giveUpId\"]');\n            const taskAssigneeEl = card.querySelector('[data-role=\"task-assignee\"]');\n            if (commentEl) commentEl.value = t.comment || '';\n            if (deadlineEl) deadlineEl.value = (t.deadline || '').slice(0,10);\n            if (giveUpIdEl) giveUpIdEl.value = t.giveUpId || '';\n            // Set per-task assignee from parsed task\n            if (taskAssigneeEl && t.assignee) {\n              taskAssigneeEl.value = t.assignee.trim();\n            }\n          }\n        });\n      }\n\n      // Audit info from the most recently completed/updated task if available\n      if (auditTextEl) {\n        let chosenAudit = null;\n        if (parsedTasks.length > 0) {\n          chosenAudit = parsedTasks[0];\n        }\n        if (chosenAudit) {\n          const parts = [];\n          if (chosenAudit.initiated) parts.push(`Task initiated: ${chosenAudit.initiated}`);\n          if (chosenAudit.updated) parts.push(`Status updated: ${chosenAudit.updated}`);\n          if (chosenAudit.completed) parts.push(`Completed: ${chosenAudit.completed}`);\n          auditTextEl.textContent = parts.join(' | ');\n        } else {\n          auditTextEl.textContent = '';\n        }\n      }\n\n      // Update Last KYC Produced date\n      const lastKycEl = qs('#lastKycDate');\n      if (lastKycEl && companyVal) {\n        // Look for KYC Done status in current row's tasks\n        let kycCompletedDate = null;\n        parsedTasks.forEach(t => {\n          if (t.name && t.name.toLowerCase().includes('kyc') && \n              t.status && t.status.toLowerCase() === 'done' && t.completed) {\n            kycCompletedDate = t.completed;\n          }\n        });\n        if (kycCompletedDate) {\n          lastKycEl.textContent = kycCompletedDate;\n        } else {\n          // Search all rows for this company's last KYC\n          findLastKycDate(companyVal).then(date => {\n            lastKycEl.textContent = date || '';\n          });\n        }\n      } else if (lastKycEl) {\n        lastKycEl.textContent = '';\n      }\n\n      syncTasksVisibility();\n      updateDateDisplays();\n      updateExtraNotePlaceholder();\n      \n      // Reorder checked items to top\n      reorderCheckboxesToTop('#assignees');\n      reorderCheckboxesToTop('#tasksChecklist');\n      reorderCheckboxesToTop('#taskCategories');\n\n      // Track current row number for save logic\n      currentRowNum = uiRow;\n\n      // Apply deadline warnings to task cards\n      applyDeadlineWarnings();\n\n      // Update email summary button state\n      updateEmailSummaryButton();\n\n      // Close email summary section when switching rows\n      if (emailSummarySection) {\n        emailSummarySection.classList.remove('visible');\n      }\n    });\n  }\n\n  async function saveToActiveRow(){\n    const descVal = getSelectedCategories().join(', ');\n    const assignees = getSelectedAssignees().join(', ');\n    const isOther = isOtherTaskSelected();\n    console.log('Saving - Categories:', descVal, 'Assignees:', assignees, 'IsOther:', isOther);\n    await Excel.run(async (context) => {\n      // Get active row within the same context to avoid sync issues\n      const selectedRange = context.workbook.getSelectedRange();\n      selectedRange.load('rowIndex');\n      await context.sync();\n      const uiRow = selectedRange.rowIndex + 1;\n\n      const sheet = context.workbook.worksheets.getItemOrNullObject('TASK MANAGER FORM');\n      sheet.load('name');\n      await context.sync();\n      if (sheet.isNullObject) return;\n\n      // Persist row-level dates (E-G)\n      const datesRange = sheet.getRange(`E${uiRow}:G${uiRow}`);\n      datesRange.load('values');\n\n      // Persist company name (A), task category (B), assignees (C), broker lead (D)\n      const companyRange = sheet.getRange(`A${uiRow}`);\n      const descRange = sheet.getRange(`B${uiRow}`);\n      const assigneesRange = sheet.getRange(`C${uiRow}`);\n      const brokerRange = sheet.getRange(`D${uiRow}`);\n\n      const hRange = sheet.getRange(`H${uiRow}`);\n      const jRange = sheet.getRange(`J${uiRow}`);\n      const kRange = sheet.getRange(`K${uiRow}`);\n      hRange.load('values');\n      await context.sync();\n\n      const datesRow = (datesRange.values && datesRange.values[0]) ? datesRange.values[0] : [null,null,null];\n\n      // Format dates as d-MMM-yyyy for Excel display\n      if (initialRequestInput) datesRow[0] = formatDateForExcel(initialRequestInput.value);\n      if (introEmailInput) datesRow[1] = formatDateForExcel(introEmailInput.value);\n      if (remindersStartInput) datesRow[2] = formatDateForExcel(remindersStartInput.value);\n\n      datesRange.values = [datesRow];\n\n      descRange.values = [[descVal]];\n\n      if (brokerLeadEl) {\n        brokerRange.values = [[brokerLeadEl.value || '']];\n      }\n\n      if (companyNameInput) {\n        companyRange.values = [[companyNameInput.value || '']];\n      }\n\n      // Save assignees to Column C\n      assigneesRange.values = [[assignees]];\n      console.log('Saving assignees to column C:', assignees);\n\n      // Save Email Frequency (J) and Extra Note (K)\n      if (emailFrequencyEl) {\n        jRange.values = [[emailFrequencyEl.value || '']];\n      }\n      if (extraNoteEl) {\n        kRange.values = [[extraNoteEl.value || '']];\n      }\n\n      const existing = (hRange.values && hRange.values[0] && hRange.values[0][0])\n        ? String(hRange.values[0][0])\n        : '';\n\n      const lines = existing\n        .split(/\\r?\\n/)\n        .map(s => s.trim())\n        .filter(Boolean);\n\n      const nonTaskLines = lines.filter(l => !parseTaskLine(l));\n      const newTaskLines = [];\n\n      // Parse existing tasks to preserve dates\n      const existingTasks = {};\n      lines.forEach(l => {\n        const parsed = parseTaskLine(l);\n        if (parsed) {\n          existingTasks[parsed.name.toLowerCase()] = parsed;\n        }\n      });\n\n      // Helper to get today's date in d-MMM-yyyy format\n      const getTodayFormatted = () => {\n        const d = new Date();\n        const months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];\n        return `${String(d.getDate()).padStart(2,'0')} ${months[d.getMonth()]} ${String(d.getFullYear()).slice(-2)}`;\n      };\n\n      // Helper to compute dates based on status and existing task\n      // Only show ONE date field based on current status (last action):\n      // - To Do: Task initiated\n      // - In Progress: Status updated\n      // - Done: Completed\n      const computeDates = (name, newStatus, existingTask) => {\n        const today = getTodayFormatted();\n        const oldStatus = existingTask ? (existingTask.status || '').toLowerCase() : '';\n        const newStatusLower = (newStatus || '').toLowerCase();\n        \n        // Preserve existing dates (use empty string if not present)\n        let initiated = (existingTask && existingTask.initiated) ? existingTask.initiated : '';\n        let updated = (existingTask && existingTask.updated) ? existingTask.updated : '';\n        let completed = (existingTask && existingTask.completed) ? existingTask.completed : '';\n        \n        // Check if this task has ANY date - if not, it's effectively new\n        const hasAnyDate = initiated || updated || completed;\n\n        // Update the relevant date based on status\n        // We show only ONE date field based on current status (last action)\n        if (newStatusLower === 'to do') {\n          // For To Do: always show initiated date\n          initiated = initiated || today;\n          // Clear other dates for display\n          updated = '';\n          completed = '';\n        } else if (newStatusLower === 'in progress') {\n          // For In Progress: set updated date if new or status changed\n          if (!hasAnyDate || oldStatus !== newStatusLower) {\n            updated = today;\n          }\n          // Clear other dates for display\n          initiated = '';\n          completed = '';\n        } else if (newStatusLower === 'done') {\n          // For Done: set completed date if new or status changed\n          if (!hasAnyDate || !completed || oldStatus !== newStatusLower) {\n            completed = today;\n          }\n          // Clear other dates for display\n          initiated = '';\n          updated = '';\n        }\n\n        return { initiated, updated, completed };\n      };\n\n      if (isOther) {\n        const otherCard = getTaskCard('__other__');\n        const name = taskNameInput ? taskNameInput.value.trim() : '';\n        if (name) {\n          const status = getCardStatus(otherCard) || 'To Do';\n          const commentEl = otherCard ? otherCard.querySelector('[data-role=\"comment\"]') : null;\n          const deadlineEl = otherCard ? otherCard.querySelector('[data-role=\"deadline\"]') : null;\n          const taskAssigneeEl = otherCard ? otherCard.querySelector('[data-role=\"task-assignee\"]') : null;\n          // Use per-task assignee if set, otherwise fall back to global assignees\n          const taskAssignee = taskAssigneeEl && taskAssigneeEl.value ? taskAssigneeEl.value : assignees;\n          \n          // Look up existing task to preserve dates\n          const existingTask = existingTasks[name.toLowerCase()];\n          const dates = computeDates(name, status, existingTask);\n          \n          const payload = {\n            name,\n            status,\n            assignees: taskAssignee,\n            comment: commentEl ? commentEl.value.trim() : '',\n            giveUpId: '',\n            initiated: dates.initiated,\n            updated: dates.updated,\n            completed: dates.completed,\n            deadline: deadlineEl ? deadlineEl.value : ''\n          };\n          const builtLine = buildSummaryLine(payload);\n          newTaskLines.push({ line: builtLine, status });\n        }\n      } else {\n        const toggles = getSelectedTaskToggles();\n        const fixedNames = ['Broker Agreement','Give-up Agreement','Amend Annex A','KYC (produced by LCMC)','KYC External'];\n        toggles.forEach(name => {\n          if (!fixedNames.includes(name)) return;\n          const card = getTaskCard(name);\n          if (!card) return;\n          const status = getCardStatus(card);\n          const commentEl = card.querySelector('[data-role=\"comment\"]');\n          const deadlineEl = card.querySelector('[data-role=\"deadline\"]');\n          const giveUpIdEl = card.querySelector('[data-role=\"giveUpId\"]');\n          const taskAssigneeEl = card.querySelector('[data-role=\"task-assignee\"]');\n          // Use per-task assignee if set, otherwise fall back to global assignees\n          const taskAssignee = taskAssigneeEl && taskAssigneeEl.value ? taskAssigneeEl.value : assignees;\n          \n          // Look up existing task to preserve dates (handle legacy KYC name)\n          let existingTask = existingTasks[name.toLowerCase()];\n          if (!existingTask && name.toLowerCase() === 'kyc (produced by lcmc)') {\n            existingTask = existingTasks['kyc (internal)'];\n          }\n          const dates = computeDates(name, status, existingTask);\n          \n          const payload = {\n            name,\n            status,\n            assignees: taskAssignee,\n            comment: commentEl ? commentEl.value.trim() : '',\n            giveUpId: giveUpIdEl ? giveUpIdEl.value.trim() : '',\n            initiated: dates.initiated,\n            updated: dates.updated,\n            completed: dates.completed,\n            deadline: deadlineEl ? deadlineEl.value : ''\n          };\n          newTaskLines.push({ line: buildSummaryLine(payload), status });\n        });\n      }\n\n      // Sort task lines by status priority: To Do > In Progress > Done\n      const statusPriority = { 'to do': 1, 'in progress': 2, 'done': 3 };\n      newTaskLines.sort((a, b) => {\n        const aPriority = statusPriority[(a.status || '').toLowerCase()] || 4;\n        const bPriority = statusPriority[(b.status || '').toLowerCase()] || 4;\n        return aPriority - bPriority;\n      });\n      const sortedLines = newTaskLines.map(t => t.line);\n\n      const newValue = nonTaskLines.concat(sortedLines).filter(Boolean).join('\\n');\n      console.log('Saving to H - newTaskLines:', sortedLines, 'newValue:', newValue);\n\n      hRange.values = [[newValue]];\n\n      // Apply font color based on status priority: In Progress > To Do > Done\n      // Since Excel.js can't do per-line colors, use the \"most urgent\" status\n      if (sortedLines.length > 0) {\n        let hasInProgress = false;\n        let hasToDo = false;\n        let hasDone = false;\n        \n        sortedLines.forEach(line => {\n          const lower = line.toLowerCase();\n          if (lower.includes(': in progress')) hasInProgress = true;\n          else if (lower.includes(': to do')) hasToDo = true;\n          else if (lower.includes(': done')) hasDone = true;\n        });\n        \n        // Priority: In Progress (orange) > To Do (green) > Done (red)\n        // Use original Google Sheet colours: To Do #34a853, In Progress #ff9900, Done #cc6666\n        let fontColor;\n        if (hasInProgress) {\n          fontColor = '#ff9900'; // In Progress (orange)\n        } else if (hasToDo) {\n          fontColor = '#34a853'; // To Do (green)\n        } else if (hasDone) {\n          fontColor = '#cc6666'; // Done (soft red)\n        } else {\n          fontColor = '#34a853'; // default green\n        }\n        hRange.format.font.color = fontColor;\n      }\n\n      await context.sync();\n      console.log('Save completed successfully for row', uiRow);\n    });\n  }\n\n  // Clear form for a fresh new task entry\n  function clearFormForNewTask() {\n    // Clear company name\n    if (companyNameInput) companyNameInput.value = '';\n    \n    // Reset task category checkboxes\n    qsa('#taskCategories .category-toggle').forEach(cb => {\n      cb.checked = false;\n    });\n    \n    // Clear broker lead\n    if (brokerLeadEl) brokerLeadEl.value = '';\n    \n    // Clear all assignee checkboxes\n    document.querySelectorAll('#assignees input[type=checkbox]').forEach(cb => {\n      cb.checked = false;\n    });\n    \n    // Clear dates\n    if (initialRequestInput) initialRequestInput.value = '';\n    if (introEmailInput) introEmailInput.value = '';\n    if (remindersStartInput) remindersStartInput.value = '';\n    \n    // Clear email frequency and extra note\n    if (emailFrequencyEl) emailFrequencyEl.value = '';\n    if (extraNoteEl) extraNoteEl.value = '';\n    \n    // Uncheck all task toggles\n    qsa('#tasksChecklist .task-toggle').forEach(cb => {\n      cb.checked = false;\n    });\n    \n    // Reset all task cards (including Other Task card)\n    qsa('#taskCards .task-card, #otherTaskCard').forEach(card => {\n      // Reset status chips\n      const chips = card.querySelectorAll('[data-role=\"status-chips\"] .chip');\n      chips.forEach(c => c.classList.remove('active'));\n      \n      // Clear comment\n      const commentEl = card.querySelector('[data-role=\"comment\"]');\n      if (commentEl) commentEl.value = '';\n      \n      // Clear deadline\n      const deadlineEl = card.querySelector('[data-role=\"deadline\"]');\n      if (deadlineEl) deadlineEl.value = '';\n      \n      // Clear give-up ID\n      const giveUpIdEl = card.querySelector('[data-role=\"giveUpId\"]');\n      if (giveUpIdEl) giveUpIdEl.value = '';\n      \n      // Clear per-task assignee\n      const taskAssigneeEl = card.querySelector('[data-role=\"task-assignee\"]');\n      if (taskAssigneeEl) taskAssigneeEl.value = '';\n    });\n    \n    // Clear other task name\n    if (taskNameInput) taskNameInput.value = '';\n    \n    // Clear audit text\n    if (auditTextEl) auditTextEl.textContent = '';\n    \n    // Clear Last KYC date\n    const lastKycEl = qs('#lastKycDate');\n    if (lastKycEl) lastKycEl.textContent = '';\n    \n    // Clear search results\n    if (searchResults) {\n      searchResults.classList.remove('visible');\n      searchResults.innerHTML = '';\n    }\n\n    // Close email summary section\n    if (emailSummarySection) {\n      emailSummarySection.classList.remove('visible');\n    }\n\n    // Mark as new task for save logic\n    currentRowNum = 'new';\n\n    // Update email summary button state\n    updateEmailSummaryButton();\n    \n    // Clear date displays\n    updateDateDisplays();\n    \n    // Update visibility and placeholder\n    syncTasksVisibility();\n    updateExtraNotePlaceholder();\n\n    // Autofocus first visible task comment field after a short delay\n    setTimeout(() => {\n      const visibleCard = document.querySelector('#taskCards .task-card:not([style*=\"display: none\"]), #otherTaskCard:not([style*=\"display: none\"])');\n      if (visibleCard) {\n        const commentEl = visibleCard.querySelector('[data-role=\"comment\"]');\n        if (commentEl && typeof commentEl.focus === 'function') {\n          commentEl.focus();\n        }\n      }\n    }, 100);\n  }\n\n  // Delete the current row from Excel\n  async function deleteCurrentRow() {\n    if (currentRowNum === null || currentRowNum === 'new') {\n      throw new Error('No row to delete');\n    }\n    \n    await Excel.run(async (context) => {\n      const sheet = context.workbook.worksheets.getItemOrNullObject('TASK MANAGER FORM');\n      sheet.load('name');\n      await context.sync();\n      \n      if (sheet.isNullObject) {\n        throw new Error('Sheet TASK MANAGER FORM not found');\n      }\n      \n      // Delete the entire row\n      const rowRange = sheet.getRange(`${currentRowNum}:${currentRowNum}`);\n      rowRange.delete(Excel.DeleteShiftDirection.up);\n      \n      await context.sync();\n      console.log('Deleted row', currentRowNum);\n    });\n  }\n\n  // Add a new task to the next available row\n  async function addNewTask() {\n    await Excel.run(async (context) => {\n      const sheet = context.workbook.worksheets.getItemOrNullObject('TASK MANAGER FORM');\n      sheet.load('name');\n      await context.sync();\n      if (sheet.isNullObject) {\n        console.error('Sheet TASK MANAGER FORM not found');\n        return;\n      }\n\n      // Find the first empty row by scanning column A from row 2 onwards\n      const colA = sheet.getRange('A2:A1000');\n      colA.load('values');\n      await context.sync();\n\n      let nextRow = 2; // Start from row 2 (after header)\n      const values = colA.values || [];\n      for (let i = 0; i < values.length; i++) {\n        if (values[i][0] && String(values[i][0]).trim() !== '') {\n          nextRow = i + 3; // i is 0-indexed, row 2 is first data row, so next empty is i+2+1\n        } else {\n          // Found an empty cell\n          nextRow = i + 2; // i is 0-indexed from row 2\n          break;\n        }\n      }\n\n      // Collect current form data\n      const companyVal = companyNameInput ? companyNameInput.value.trim() : '';\n      const descVal = getSelectedCategories().join(', ');\n      const isOther = isOtherTaskSelected();\n      const brokerVal = brokerLeadEl ? brokerLeadEl.value : '';\n      const assignees = getSelectedAssignees().join(', ');\n\n      // Write company name to column A\n      sheet.getRange(`A${nextRow}`).values = [[companyVal]];\n      // Write task category to column B\n      sheet.getRange(`B${nextRow}`).values = [[descVal]];\n      // Write assignees to column C\n      sheet.getRange(`C${nextRow}`).values = [[assignees]];\n      // Write broker lead to column D\n      sheet.getRange(`D${nextRow}`).values = [[brokerVal]];\n\n      // Write dates to columns E, F, G\n      const dateE = formatDateForExcel(initialRequestInput ? initialRequestInput.value : '');\n      const dateF = formatDateForExcel(introEmailInput ? introEmailInput.value : '');\n      const dateG = formatDateForExcel(remindersStartInput ? remindersStartInput.value : '');\n      sheet.getRange(`E${nextRow}:G${nextRow}`).values = [[dateE, dateF, dateG]];\n\n      // Write Email Frequency (J) and Extra Note (K)\n      sheet.getRange(`J${nextRow}`).values = [[emailFrequencyEl ? emailFrequencyEl.value : '']];\n      sheet.getRange(`K${nextRow}`).values = [[extraNoteEl ? extraNoteEl.value : '']];\n\n      // Helper to get today's date in d-MMM-yy format\n      const getTodayFormatted = () => {\n        const d = new Date();\n        const months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];\n        return `${String(d.getDate()).padStart(2,'0')} ${months[d.getMonth()]} ${String(d.getFullYear()).slice(-2)}`;\n      };\n      const today = getTodayFormatted();\n\n      // Build Column H from selected tasks\n      const newTaskLines = [];\n      if (isOther) {\n        const otherCard = getTaskCard('__other__');\n        const name = taskNameInput ? taskNameInput.value.trim() : '';\n        if (name) {\n          const status = getCardStatus(otherCard) || 'To Do';\n          const commentEl = otherCard ? otherCard.querySelector('[data-role=\"comment\"]') : null;\n          const deadlineEl = otherCard ? otherCard.querySelector('[data-role=\"deadline\"]') : null;\n          const taskAssigneeEl = otherCard ? otherCard.querySelector('[data-role=\"task-assignee\"]') : null;\n          const taskAssignee = taskAssigneeEl && taskAssigneeEl.value ? taskAssigneeEl.value : assignees;\n          \n          // Set date based on status for new task\n          let initiated = '', updated = '', completed = '';\n          const statusLower = status.toLowerCase();\n          if (statusLower === 'to do') {\n            initiated = today;\n          } else if (statusLower === 'in progress') {\n            updated = today;\n          } else if (statusLower === 'done') {\n            completed = today;\n          }\n          \n          const payload = {\n            name,\n            status,\n            assignees: taskAssignee,\n            comment: commentEl ? commentEl.value.trim() : '',\n            giveUpId: '',\n            initiated,\n            updated,\n            completed,\n            deadline: deadlineEl ? deadlineEl.value : ''\n          };\n          newTaskLines.push(buildSummaryLine(payload));\n        }\n      } else {\n        const toggles = getSelectedTaskToggles();\n        const fixedNames = ['Broker Agreement','Give-up Agreement','Amend Annex A','KYC (produced by LCMC)','KYC External'];\n        toggles.forEach(name => {\n          if (!fixedNames.includes(name)) return;\n          const card = getTaskCard(name);\n          if (!card) return;\n          const status = getCardStatus(card) || 'To Do';\n          const commentEl = card.querySelector('[data-role=\"comment\"]');\n          const deadlineEl = card.querySelector('[data-role=\"deadline\"]');\n          const giveUpIdEl = card.querySelector('[data-role=\"giveUpId\"]');\n          const taskAssigneeEl = card.querySelector('[data-role=\"task-assignee\"]');\n          const taskAssignee = taskAssigneeEl && taskAssigneeEl.value ? taskAssigneeEl.value : assignees;\n          \n          // Set date based on status for new task\n          let initiated = '', updated = '', completed = '';\n          const statusLower = status.toLowerCase();\n          if (statusLower === 'to do') {\n            initiated = today;\n          } else if (statusLower === 'in progress') {\n            updated = today;\n          } else if (statusLower === 'done') {\n            completed = today;\n          }\n          \n          const payload = {\n            name,\n            status,\n            assignees: taskAssignee,\n            comment: commentEl ? commentEl.value.trim() : '',\n            giveUpId: giveUpIdEl ? giveUpIdEl.value.trim() : '',\n            initiated,\n            updated,\n            completed,\n            deadline: deadlineEl ? deadlineEl.value : ''\n          };\n          newTaskLines.push(buildSummaryLine(payload));\n        });\n      }\n\n      const hRangeNew = sheet.getRange(`H${nextRow}`);\n      hRangeNew.values = [[newTaskLines.join('\\n')]];\n\n      // Apply font color based on status priority: In Progress > To Do > Done\n      // Use original Google Sheet colours: To Do #34a853, In Progress #ff9900, Done #cc6666\n      if (newTaskLines.length > 0) {\n        let hasInProgress = false;\n        let hasToDo = false;\n        let hasDone = false;\n        \n        newTaskLines.forEach(line => {\n          const lower = line.toLowerCase();\n          if (lower.includes(': in progress')) hasInProgress = true;\n          else if (lower.includes(': to do')) hasToDo = true;\n          else if (lower.includes(': done')) hasDone = true;\n        });\n        \n        let fontColor;\n        if (hasInProgress) {\n          fontColor = '#ff9900'; // In Progress (orange)\n        } else if (hasToDo) {\n          fontColor = '#34a853'; // To Do (green)\n        } else if (hasDone) {\n          fontColor = '#cc6666'; // Done (soft red)\n        } else {\n          fontColor = '#34a853'; // default green\n        }\n        hRangeNew.format.font.color = fontColor;\n      }\n\n      await context.sync();\n\n      // Select the new row so user can see it\n      const newRowRange = sheet.getRange(`A${nextRow}`);\n      newRowRange.select();\n      await context.sync();\n\n      // Update current row number for save logic\n      currentRowNum = nextRow;\n    });\n  }\n\n  // Update date display helpers to show d-MMM-yyyy format\n  function updateDateDisplays() {\n    const dateFields = [\n      { input: '#initialRequest', display: '#initialRequestDisplay' },\n      { input: '#introEmail', display: '#introEmailDisplay' },\n      { input: '#remindersStart', display: '#remindersStartDisplay' }\n    ];\n    dateFields.forEach(({ input, display }) => {\n      const inputEl = qs(input);\n      const displayEl = qs(display);\n      if (inputEl && displayEl) {\n        const formatted = formatDateForDisplay(inputEl.value);\n        displayEl.textContent = formatted ? ` ${formatted}` : '';\n      }\n    });\n  }\n\n  // Wire date inputs to update displays\n  function wireDateInputs() {\n    const dateInputs = ['#initialRequest', '#introEmail', '#remindersStart'];\n    dateInputs.forEach(selector => {\n      const el = qs(selector);\n      if (el) {\n        el.addEventListener('change', updateDateDisplays);\n      }\n    });\n  }\n\n  // Wire deadline inputs to update warnings\n  function wireDeadlineInputs() {\n    qsa('[data-role=\"deadline\"]').forEach(input => {\n      input.addEventListener('change', () => {\n        applyDeadlineWarnings();\n      });\n    });\n  }\n\n  // ============== Email Summary Integration ==============\n\n  const emailSummaryBtn = qs('#viewEmailSummaryBtn');\n  const emailSummarySection = qs('#emailSummarySection');\n  const emailSummaryList = qs('#emailSummaryList');\n  const emailSummaryCount = qs('#emailSummaryCount');\n  const closeEmailSummaryBtn = qs('#closeEmailSummaryBtn');\n\n  // Update email summary button state based on company name\n  function updateEmailSummaryButton() {\n    const company = companyNameInput ? companyNameInput.value.trim() : '';\n    if (emailSummaryBtn) {\n      emailSummaryBtn.disabled = !company;\n    }\n  }\n\n  // Wire company name input to update button state\n  if (companyNameInput) {\n    companyNameInput.addEventListener('input', updateEmailSummaryButton);\n    companyNameInput.addEventListener('change', updateEmailSummaryButton);\n  }\n\n  // Wire email summary button click\n  if (emailSummaryBtn) {\n    emailSummaryBtn.addEventListener('click', async () => {\n      await loadEmailSummaries();\n    });\n  }\n\n  // Wire close button\n  if (closeEmailSummaryBtn) {\n    closeEmailSummaryBtn.addEventListener('click', () => {\n      if (emailSummarySection) {\n        emailSummarySection.classList.remove('visible');\n      }\n    });\n  }\n\n  // Load email summaries from Excel column L (populated by VBA SmartBrief macro)\n  async function loadEmailSummaries() {\n    console.log('=== LOADING EMAIL SUMMARIES ===');\n    const emailSummaryList = qs('#emailSummaryList');\n    if (!emailSummaryList) {\n      console.log('emailSummaryList element not found');\n      return;\n    }\n\n    const company = companyNameInput ? companyNameInput.value.trim() : '';\n    if (!company) {\n      showToast('No company name entered', 'error');\n      return;\n    }\n\n    // Must have a valid row to read from\n    if (currentRowNum === null || currentRowNum === 'new') {\n      showToast('Please save the task first or select an existing row', 'error');\n      return;\n    }\n\n    // Show the section with loading state\n    if (emailSummarySection) {\n      emailSummarySection.classList.add('visible');\n    }\n    if (emailSummaryList) {\n      emailSummaryList.innerHTML = '<div class=\"email-loading\">Loading summary from spreadsheet...</div>';\n    }\n\n    try {\n      // Read from Excel - extract data only, no DOM manipulation inside Excel.run\n      let summaryText = '';\n      await Excel.run(async (context) => {\n        const sheet = context.workbook.worksheets.getItemOrNullObject('TASK MANAGER FORM');\n        sheet.load('name');\n        await context.sync();\n\n        if (sheet.isNullObject) {\n          throw new Error('TASK MANAGER FORM sheet not found');\n        }\n\n        // Read column L for the current row (SmartBrief summary)\n        const cell = sheet.getRange(`L${currentRowNum}`);\n        cell.load('values');\n        await context.sync();\n\n        summaryText = (cell.values && cell.values[0] && cell.values[0][0])\n          ? String(cell.values[0][0]).trim()\n          : '';\n      });\n\n      // Excel can store in-cell line breaks as \"\\r\" on some platforms (not \"\\n\");\n      // normalize so parsing + rendering works consistently.\n      if (summaryText) {\n        summaryText = summaryText.replace(/\\r\\n/g, '\\n').replace(/\\r/g, '\\n');\n      }\n\n      // If column L is empty, try to fetch from API (only works in localhost dev due to mixed-content)\n      // In production, VBA macro should have already populated column L\n      if (!summaryText) {\n        // Only attempt API call in localhost development (HTTPS add-in can't call HTTP API in production)\n        const isLocalhost = typeof window !== 'undefined' \n          && window.location \n          && window.location.hostname === 'localhost';\n        \n        if (isLocalhost) {\n          if (emailSummaryList) {\n            emailSummaryList.innerHTML = '<div class=\"email-loading\">Fetching summary from API...</div>';\n          }\n\n          const initialRequest = initialRequestInput ? String(initialRequestInput.value || '') : '';\n          const introEmail = introEmailInput ? String(introEmailInput.value || '') : '';\n          const remindersStart = remindersStartInput ? String(remindersStartInput.value || '') : '';\n\n          const apiSummary = await fetchSmartBriefSummaryFromApi(company, initialRequest, introEmail, remindersStart);\n          summaryText = apiSummary || '';\n\n          if (summaryText) {\n            summaryText = summaryText.replace(/\\r\\n/g, '\\n').replace(/\\r/g, '\\n');\n          }\n\n          if (summaryText) {\n            await Excel.run(async (context) => {\n              const sheet = context.workbook.worksheets.getItemOrNullObject('TASK MANAGER FORM');\n              sheet.load('name');\n              await context.sync();\n\n              if (sheet.isNullObject) {\n                throw new Error('TASK MANAGER FORM sheet not found');\n              }\n\n              const cell = sheet.getRange(`L${currentRowNum}`);\n              cell.values = [[summaryText]];\n              await context.sync();\n            });\n          }\n        }\n      }\n\n      // Now do DOM updates outside of Excel.run\n      // Update count badge (1 if we have a summary, 0 if not)\n      if (emailSummaryCount) {\n        emailSummaryCount.textContent = summaryText ? '1' : '0';\n      }\n\n      // Display the summary\n      if (!summaryText) {\n        if (emailSummaryList) {\n          emailSummaryList.innerHTML = `\n            <div class=\"email-no-summaries\">\n              No email summary found for this row.<br>\n              <small>Run the SmartBrief macro (Alt+F8  SmartBrief) to fetch summaries.</small>\n            </div>`;\n        }\n        return;\n      }\n\n      // Parse the summary text from VBA format:\n      // \"[XX% match] Subject\\n\\nSummary text\"\n      const lines = summaryText.split(/\\n/);\n      const firstLine = (lines[0] || '').trim();\n      const restText = lines.slice(1).join('\\n').replace(/^\\n+/, '').trim();\n\n      const headerMatch = firstLine.match(/^\\[(\\d+)%\\s*match\\]\\s*(.*)$/);\n      let matchPercent = 100;\n      let subject = 'Email Summary';\n      let summaryBody = summaryText;\n\n      if (headerMatch) {\n        matchPercent = parseInt(headerMatch[1], 10);\n        subject = (headerMatch[2] || '').trim() || 'Email Summary';\n        summaryBody = restText;\n      } else if (lines.length > 1) {\n        subject = firstLine || 'Email Summary';\n        summaryBody = restText;\n      } else {\n        subject = 'Email Summary';\n        summaryBody = summaryText.trim();\n      }\n\n      // Color code by match quality\n      let matchClass = 'match-high';\n      if (matchPercent < 70) matchClass = 'match-medium';\n      if (matchPercent < 50) matchClass = 'match-low';\n\n      // Parse participants, detect category, and suggest tasks for \"Apply to Task\" feature\n      const participants = parseParticipantsFromSummary(summaryText);\n      const detectedCategory = detectCategoryFromSummary(summaryText);\n      const matchedAssignees = matchParticipantsToTeamMembers(participants);\n      const summaryNotes = parseSummaryBodyFromSummary(summaryText);\n      const suggestedTasks = detectTasksFromSummary(summaryText);\n\n      // Store for \"Apply to Task\" button\n      lastParsedSmartBrief = {\n        participants,\n        detectedCategory,\n        matchedAssignees,\n        summaryNotes,\n        suggestedTasks,\n        matchPercent,\n        subject\n      };\n\n      // Build participant chips HTML\n      let participantChipsHtml = '';\n      if (participants.length > 0) {\n        const chips = participants.map(p => {\n          const isInternal = isLcmCommoditiesEmail(p.email);\n          const chipClass = isInternal ? 'participant-chip matched' : 'participant-chip';\n          const title = p.email ? p.email : p.name;\n          return `<span class=\"${chipClass}\" title=\"${escapeHtml(title)}\">${escapeHtml(p.name)}</span>`;\n        }).join('');\n        participantChipsHtml = `\n          <div class=\"participants-section\">\n            <div class=\"participants-label\">Participants:</div>\n            <div class=\"participants-chips\">${chips}</div>\n          </div>\n        `;\n      }\n\n      // Build match warning HTML (if < 50%)\n      let matchWarningHtml = '';\n      if (matchPercent < 50) {\n        matchWarningHtml = `\n          <div class=\"match-warning\">\n             Low confidence match (${matchPercent}%)  verify this is the correct email thread\n          </div>\n        `;\n      }\n\n      // Build \"Apply to Task\" button HTML\n      let applyButtonHtml = '';\n      if (detectedCategory || matchedAssignees.length > 0 || summaryNotes) {\n        applyButtonHtml = `\n          <div class=\"smartbrief-actions\">\n            <button id=\"applySmartBriefBtn\" class=\"btn-apply-smartbrief\">\n               Review & Apply to Task\n            </button>\n          </div>\n        `;\n      }\n\n      // Remove participant names from summary body to avoid redundancy with chips\n      let cleanedSummaryBody = summaryBody;\n      // Remove the PARTICIPANTS section if present (already shown as chips)\n      cleanedSummaryBody = cleanedSummaryBody.replace(/## PARTICIPANTS[\\s\\S]*?(?=## |$)/, '').trim();\n      // Clean up any leading/trailing whitespace or empty lines\n      cleanedSummaryBody = cleanedSummaryBody.replace(/^\\n+/, '').replace(/\\n{3,}/g, '\\n\\n');\n\n      \n      if (emailSummaryList) {\n        emailSummaryList.innerHTML = `\n          ${matchWarningHtml}\n          <div class=\"email-summary-item\">\n            <div class=\"email-summary-subject\">\n              ${escapeHtml(subject)}\n              <span class=\"match-score ${matchClass}\" title=\"Match score from SmartBrief\">\n                ${matchPercent}% match\n              </span>\n            </div>\n            ${participantChipsHtml}\n            <div class=\"email-summary-text\">${formatSmartBriefBodyToHtml(cleanedSummaryBody)}</div>\n          </div>\n          ${applyButtonHtml}\n        `;\n\n        // Wire \"Apply to Task\" button to show confirmation modal\n        const applyBtn = qs('#applySmartBriefBtn');\n        if (applyBtn) {\n          applyBtn.addEventListener('click', () => showSmartBriefConfirmation());\n        }\n      }\n\n    } catch (err) {\n      console.error('Error loading email summary from column L:', err);\n      if (emailSummaryList) {\n        emailSummaryList.innerHTML = `<div class=\"email-no-summaries\">Error reading summary: ${escapeHtml(err.message)}</div>`;\n      }\n    }\n  }\n\n  // Show confirmation modal for SmartBrief suggestions\n  function showSmartBriefConfirmation() {\n    if (!lastParsedSmartBrief) {\n      showToast('No SmartBrief data available', 'error');\n      return;\n    }\n    \n    const { detectedCategory, matchedAssignees, summaryNotes, suggestedTasks } = lastParsedSmartBrief;\n    \n    // Build suggestion items with checkboxes\n    let suggestionsHtml = '';\n    let hasSuggestions = false;\n\n    if (detectedCategory) {\n      hasSuggestions = true;\n      suggestionsHtml += `\n        <div class=\"smartbrief-suggestion-item\">\n          <label>\n            <input type=\"checkbox\" id=\"sbApplyCategory\" checked>\n            <span class=\"suggestion-label\">Task Category:</span>\n            <span class=\"suggestion-value\">${escapeHtml(detectedCategory)}</span>\n          </label>\n        </div>\n      `;\n    }\n\n    // Individual checkboxes for each assignee (so users can uncheck irrelevant ones)\n    if (matchedAssignees && matchedAssignees.length > 0) {\n      hasSuggestions = true;\n      const assigneeCheckboxes = matchedAssignees.map((assignee, idx) => `\n        <label class=\"assignee-checkbox-item\">\n          <input type=\"checkbox\" class=\"sb-assignee-checkbox\" data-assignee=\"${escapeHtml(assignee)}\" checked>\n          <span>${escapeHtml(assignee)}</span>\n        </label>\n      `).join('');\n      \n      suggestionsHtml += `\n        <div class=\"smartbrief-suggestion-item smartbrief-assignees-group\">\n          <div class=\"suggestion-label\">Assignees:</div>\n          <div class=\"assignee-checkboxes-list\">\n            ${assigneeCheckboxes}\n          </div>\n        </div>\n      `;\n    }\n\n    // Task suggestions\n    if (suggestedTasks && suggestedTasks.length > 0) {\n      hasSuggestions = true;\n      \n      const taskCheckboxes = suggestedTasks.map(task => {\n        const suggestedAssignee = getMostCommonAssignee(task);\n        let assigneeHtml = '';\n        \n        if (suggestedAssignee) {\n          assigneeHtml = `\n            <span class=\"task-assignee-suggestion\">\n               <input type=\"checkbox\" class=\"sb-assignee-suggest\" data-task=\"${escapeHtml(task)}\" data-assignee=\"${escapeHtml(suggestedAssignee)}\" checked>\n              <span style=\"color:#1e40af;font-weight:500;\">${escapeHtml(suggestedAssignee)}</span>\n            </span>\n          `;\n        }\n        \n        return `\n          <label class=\"assignee-checkbox-item\">\n            <input type=\"checkbox\" class=\"sb-task-checkbox\" data-task=\"${escapeHtml(task)}\" checked>\n            <span>${escapeHtml(task)}${assigneeHtml}</span>\n          </label>\n        `;\n      }).join('');\n      \n      suggestionsHtml += `\n        <div class=\"smartbrief-suggestion-item smartbrief-assignees-group\">\n          <div class=\"suggestion-label\">Suggested Tasks <span style=\"font-size:11px;color:#64748b;\">(with pattern-based assignees)</span>:</div>\n          <div class=\"assignee-checkboxes-list\">\n            ${taskCheckboxes}\n          </div>\n        </div>\n      `;\n    }\n\n    \n    if (!hasSuggestions) {\n      showToast('No suggestions available - but check for missing fields', 'info');\n      // Still show missing fields even if no suggestions\n      const missingFields = [];\n      \n      // Check dates\n      if (initialRequestInput && !initialRequestInput.value) missingFields.push('Initial Request Date');\n      if (remindersStartInput && !remindersStartInput.value) missingFields.push('Reminders Start Date');\n      \n      // Check broker lead\n      if (brokerLeadEl && !brokerLeadEl.value) missingFields.push('Broker Lead');\n      \n      // Check email frequency\n      const emailFrequencyEl = qs('#emailFrequency');\n      if (emailFrequencyEl) {\n        const isEmpty = emailFrequencyEl.tagName === 'SELECT' \n          ? emailFrequencyEl.selectedIndex <= 0 || !emailFrequencyEl.value\n          : !emailFrequencyEl.value || emailFrequencyEl.value.trim() === '';\n        \n        if (isEmpty) {\n          missingFields.push('Email Frequency');\n        }\n      }\n      \n      // Check if any tasks are selected\n      const selectedTasks = document.querySelectorAll('#tasksChecklist .task-toggle:checked');\n      if (selectedTasks.length === 0) missingFields.push('Task Selection');\n      \n      // Check if any assignees are selected\n      const selectedAssignees = document.querySelectorAll('#assignees input[type=checkbox]:checked');\n      if (selectedAssignees.length === 0) missingFields.push('Assignees');\n      \n      if (missingFields.length > 0) {\n        setTimeout(() => {\n          showToast(` Still needed: ${missingFields.join(', ')}. Click Save when done!`, 'info', 10000);\n        }, 2000);\n      }\n      return;\n    }\n\n    // Create modal overlay\n    const overlay = document.createElement('div');\n    overlay.className = 'confirm-overlay';\n    overlay.id = 'smartbriefConfirmOverlay';\n\n    const box = document.createElement('div');\n    box.className = 'confirm-box smartbrief-confirm-box';\n    box.innerHTML = `\n      <div class=\"smartbrief-confirm-header\">\n        <span class=\"sparkle\"></span> Review Suggestions\n      </div>\n      <p class=\"smartbrief-confirm-desc\">Select which items to apply to the task:</p>\n      <div class=\"smartbrief-suggestions\">\n        ${suggestionsHtml}\n      </div>\n      <div class=\"smartbrief-confirm-buttons\">\n        <button class=\"btn-confirm-cancel\" id=\"sbCancel\">Cancel</button>\n        <button class=\"btn-apply-confirmed\" id=\"sbApply\">Apply Selected</button>\n      </div>\n    `;\n\n    overlay.appendChild(box);\n    document.body.appendChild(overlay);\n\n    // Wire buttons\n    const cancelBtn = overlay.querySelector('#sbCancel');\n    const applyBtn = overlay.querySelector('#sbApply');\n\n    cancelBtn.addEventListener('click', () => overlay.remove());\n    \n    applyBtn.addEventListener('click', () => {\n      const applyCategory = overlay.querySelector('#sbApplyCategory')?.checked;\n      const applyNotes = overlay.querySelector('#sbApplyNotes')?.checked;\n      \n      // Collect individually selected assignees\n      const selectedAssignees = [];\n      overlay.querySelectorAll('.sb-assignee-checkbox:checked').forEach(cb => {\n        selectedAssignees.push(cb.getAttribute('data-assignee'));\n      });\n      \n      // Collect selected tasks\n      const selectedTasks = [];\n      overlay.querySelectorAll('.sb-task-checkbox:checked').forEach(cb => {\n        selectedTasks.push(cb.getAttribute('data-task'));\n      });\n      \n      // Collect selected task-specific assignees\n      const taskAssignees = {};\n      overlay.querySelectorAll('.sb-assignee-suggest:checked').forEach(cb => {\n        const task = cb.getAttribute('data-task');\n        const assignee = cb.getAttribute('data-assignee');\n        if (!taskAssignees[task]) {\n          taskAssignees[task] = [];\n        }\n        taskAssignees[task].push(assignee);\n      });\n      \n      overlay.remove();\n      applySmartBriefSelections(applyCategory, selectedAssignees, applyNotes, selectedTasks, taskAssignees);\n    });\n\n    // Close on overlay click\n    overlay.addEventListener('click', (e) => {\n      if (e.target === overlay) overlay.remove();\n    });\n  }\n\n  // Apply selected SmartBrief suggestions to the task form\n  function applySmartBriefSelections(applyCategory, assigneesFromModal, applyNotes, tasksFromModal = [], taskAssignees = {}) {\n    if (!lastParsedSmartBrief) return;\n\n    const { detectedCategory, summaryNotes, matchedAssignees } = lastParsedSmartBrief;\n    let appliedItems = [];\n\n    // 1. Apply detected category\n    if (applyCategory && detectedCategory) {\n      const categoryCheckboxes = document.querySelectorAll('#taskCategories .category-toggle');\n      categoryCheckboxes.forEach(cb => {\n        if (cb.value === detectedCategory) {\n          cb.checked = true;\n          appliedItems.push(`Category: ${detectedCategory}`);\n        }\n      });\n      syncTasksVisibility();\n    }\n\n    // 2. Apply selected assignees\n    const selectedAssignees = [];\n    document.querySelectorAll('#smartbriefConfirmOverlay .sb-assignee-checkbox:checked').forEach(cb => {\n      selectedAssignees.push(cb.value);\n    });\n    \n    // Collect selected task-specific assignees from passed parameter\n    const taskAssigneesMap = new Map();\n    const allSuggestedAssignees = new Set();\n    \n    // Convert taskAssignees object to Map\n    Object.entries(taskAssignees).forEach(([task, assignees]) => {\n      taskAssigneesMap.set(task, assignees);\n      assignees.forEach(assignee => allSuggestedAssignees.add(assignee));\n    });\n    \n    // Combine global assignees with suggested assignees\n    const allAssigneesToSelect = new Set([...selectedAssignees, ...allSuggestedAssignees]);\n    \n    if (allAssigneesToSelect.size > 0) {\n      // Ensure these assignees are selected in the main assignees list\n      const allAssigneeCheckboxes = qsa('#assignees input[type=checkbox]');\n      allAssigneeCheckboxes.forEach(cb => {\n        if (allAssigneesToSelect.has(cb.value)) {\n          cb.checked = true;\n        }\n      });\n      updateTaskAssigneeDropdowns();\n      reorderCheckboxesToTop('#assignees');\n      appliedItems.push(`Assignees: ${[...allAssigneesToSelect].join(', ')}`);\n    }\n\n    // 3. Apply selected tasks\n    if (tasksFromModal && tasksFromModal.length > 0) {\n      const taskCheckboxes = document.querySelectorAll('#tasksChecklist .task-toggle');\n      taskCheckboxes.forEach(cb => {\n        if (tasksFromModal.includes(cb.value)) {\n          cb.checked = true;\n          // Trigger change event to show task detail cards\n          cb.dispatchEvent(new Event('change', { bubbles: true }));\n        }\n      });\n      \n      // Update task assignee dropdowns after showing cards\n      updateTaskAssigneeDropdowns();\n      \n      // Apply pattern-based assignee suggestions (only if checked) - delay to ensure cards exist\n      setTimeout(() => {\n        tasksFromModal.forEach(taskName => {\n          const selectedAssigneesForTask = taskAssigneesMap.get(taskName) || [];\n          const suggestedAssignee = selectedAssigneesForTask.length > 0 ? selectedAssigneesForTask[0] : null;\n          \n          if (suggestedAssignee) {\n            // Find the task card for this task\n            const taskCard = document.querySelector(`#taskCards .task-card[data-task=\"${taskName}\"]`);\n            \n            if (taskCard) {\n              const assigneeSelect = taskCard.querySelector('.task-assignee-select');\n              \n              if (assigneeSelect) {\n                // Check if the suggested assignee is in the dropdown\n                const option = Array.from(assigneeSelect.options).find(opt => opt.value === suggestedAssignee);\n                \n                if (option) {\n                  assigneeSelect.value = suggestedAssignee;\n                  // Add a visual indicator that this was auto-suggested\n                  assigneeSelect.style.backgroundColor = '#f0f9ff';\n                  assigneeSelect.title = `Auto-suggested based on pattern: ${taskName}  ${suggestedAssignee}`;\n                }\n              }\n            }\n          }\n        });\n      }, 100);\n      \n      // Set all task statuses to \"To Do\" by default\n      document.querySelectorAll('#taskCards .task-card').forEach(card => {\n        const statusChips = card.querySelectorAll('.chip[data-value=\"To Do\"]');\n        if (statusChips.length > 0) {\n          // Clear any existing selection\n          card.querySelectorAll('.chip').forEach(chip => chip.classList.remove('active'));\n          // Select \"To Do\"\n          statusChips.forEach(chip => chip.classList.add('active'));\n        }\n      });\n      \n      appliedItems.push(`Tasks: ${tasksFromModal.join(', ')}`);\n    }\n\n    \n    // Check for important fields that might still be empty BEFORE applying\n    const missingFields = [];\n    \n    // Check dates\n    if (initialRequestInput && !initialRequestInput.value) missingFields.push('Initial Request Date');\n    if (remindersStartInput && !remindersStartInput.value) missingFields.push('Reminders Start Date');\n    \n    // Check broker lead\n    if (brokerLeadEl && !brokerLeadEl.value) missingFields.push('Broker Lead');\n    \n    // Check email frequency\n    const emailFrequencyEl = qs('#emailFrequency');\n    if (emailFrequencyEl) {\n      const isEmpty = emailFrequencyEl.tagName === 'SELECT' \n        ? emailFrequencyEl.selectedIndex <= 0 || !emailFrequencyEl.value\n        : !emailFrequencyEl.value || emailFrequencyEl.value.trim() === '';\n      \n      if (isEmpty) {\n        missingFields.push('Email Frequency');\n      }\n    }\n    \n    // Check if any tasks are selected\n    const selectedTasks = document.querySelectorAll('#tasksChecklist .task-toggle:checked');\n    if (selectedTasks.length === 0) missingFields.push('Task Selection');\n    \n    // Check if any assignees are selected\n    const selectedAssigneeElements = document.querySelectorAll('#assignees input[type=checkbox]:checked');\n    if (selectedAssigneeElements.length === 0) missingFields.push('Assignees');\n\n    // Mark form as having unsaved changes\n    if (appliedItems.length > 0) {\n      setUnsavedChanges(true);\n      \n      // Build message AFTER checking missing fields\n      let message = '';\n      if (missingFields.length > 0) {\n        message = ` Still needed: ${missingFields.join(', ')}. `;\n      }\n      message += ` Applied to form - Click \"Save Changes\" to confirm!`;\n      \n      showToast(message, 'success', 10000); // Show for 10 seconds\n      \n      // Highlight the save button to draw attention\n      const saveBtn = document.getElementById('saveBtn');\n      if (saveBtn) {\n        saveBtn.style.animation = 'pulse 2s ease-in-out 3';\n        setTimeout(() => {\n          saveBtn.style.animation = '';\n        }, 6000);\n      }\n    } else {\n      showToast('No items selected', 'info');\n    }\n  }\n\n  // Format date for display\n  function formatEmailDate(dateStr) {\n    if (!dateStr) return 'Unknown date';\n    try {\n      const d = new Date(dateStr);\n      if (isNaN(d.getTime())) return dateStr;\n      return d.toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' });\n    } catch (e) {\n      return dateStr;\n    }\n  }\n\n  // Note: Email summaries are now populated by VBA SmartBrief macro into column L\n  // The add-in reads from column L instead of calling the API directly\n\n  // Initial load when Office host is ready\n  if (typeof Office !== 'undefined' && typeof Office.onReady === 'function') {\n  \n      Office.onReady((info) => {\n        if (info.host === Office.HostType.Excel) {\n          wireCardChips();\n          wireDateInputs();\n          wireDeadlineInputs(); // Wire deadline warnings\n          wireChangeTracking(); // Track unsaved changes\n          \n                  // Wire task checkbox visibility\n        qsa('#tasksChecklist .task-toggle').forEach(cb => {\n          cb.addEventListener('change', () => syncTasksVisibility());\n        });\n        // Wire category checkbox visibility\n        qsa('#taskCategories .category-toggle').forEach(cb => {\n          cb.addEventListener('change', () => syncTasksVisibility());\n        });\n        loadFromActiveRow().then(() => {\n          // Reset unsaved indicator after initial load\n          setUnsavedChanges(false);\n          \n          // Build task-assignee patterns from existing data\n          buildTaskAssigneePatterns();\n          // Auto-load active tasks on startup\n          performSearch();\n        });\n      }\n    });\n  }\n})();\n"],"names":["e","t","r","Symbol","n","iterator","o","toStringTag","i","c","prototype","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","length","l","TypeError","call","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","m","defineProperty","_invoke","enumerable","configurable","writable","_toConsumableArray","Array","isArray","_arrayLikeToArray","_arrayWithoutHoles","from","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","toString","slice","constructor","name","test","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","qs","s","document","querySelector","qsa","querySelectorAll","teamMembersLoaded","hasUnsavedChanges","taskAssigneePatterns","Map","buildTaskAssigneePatterns","_buildTaskAssigneePatterns","_callee1","_t4","_context1","Excel","run","_ref11","_callee0","context","sheet","row","hRange","hasValue","hasText","taskData","_context0","workbook","worksheets","getItemOrNullObject","load","sync","isNullObject","clear","getRange","concat","values","text","split","forEach","line","trim","entry","colonIndex","indexOf","taskName","substring","assignedToMatch","match","assignee","has","set","patternMap","get","_x8","console","error","showToast","message","type","undefined","duration","toast","textContent","className","setTimeout","classList","remove","checkMissingFields","missing","companyName","push","brokerLead","filter","card","style","display","id","dataset","task","activeChip","deadlineInput","otherTaskCard","taskNameInput","emailFrequency","tagName","selectedIndex","showMissingFieldsWarning","missingFields","successMessage","overlay","createElement","box","maxWidth","textAlign","title","innerHTML","marginBottom","appendChild","desc","fontSize","color","list","cssText","field","li","btnWrap","closeBtn","addEventListener","body","setUnsavedChanges","unsaved","indicator","toggle","isLcmCommoditiesEmail","email","String","toLowerCase","endsWith","parseParticipantsFromSummary","summaryText","participants","participantsMatch","startsWith","parseSummaryBodyFromSummary","summaryMatch","join","detectCategoryFromSummary","includes","detectTasksFromSummary","suggestedTasks","keywords","mapping","some","keyword","Set","matchParticipantsToTeamMembers","log","teamEntries","cb","map","raw","norm","replace","parts","Boolean","first","last","isSingleToken","matched","lcmParticipants","pEmail","matchedEntry","matchReason","find","lastParsedSmartBrief","fetchSmartBriefSummaryFromApi","_x","_x2","_x3","_x4","_fetchSmartBriefSummaryFromApi","_callee11","company","initialRequest","introEmail","remindersStart","isLocalhost","url","requestBody","doFetch","result","hasDates","suffix","data","summaries","best","subject","summary","matchScore","matchPercent","_t0","_context11","window","location","hostname","encodeURIComponent","threshold","initial_request","intro_email","reminders_start","_ref12","_callee10","bodyObj","response","serverMsg","errJson","_t5","_t6","_t8","_context10","fetch","method","headers","JSON","stringify","ok","status","json","_typeof","_x9","Error","match_score","parseFloat","Number","isFinite","Math","round","escapeHtml","div","formatSmartBriefBodyToHtml","bodyText","lines","out","lastWasBlank","headerMatch","normalizedLine","applyDeadlineWarnings","warningClass","deadlineStr","deadline","Date","isNaN","getTime","today","setHours","diffDays","ceil","getDueDateWarningClass","add","preventDefault","returnValue","companyNameInput","brokerLeadEl","initialRequestInput","introEmailInput","remindersStartInput","emailFrequencyEl","extraNoteEl","auditTextEl","tasksRowEl","taskCardsContainer","saveBtn","newTaskBtn","loadSelectedBtn","openKycPortalBtn","currentRowNum","showConfirmDialog","dialog","msgEl","cancelBtn","okBtn","cleanup","removeEventListener","onCancel","onOk","_callee","_t","_context","addNewTask","saveToActiveRow","_callee2","_t2","_context2","loadFromActiveRow","clearFormForNewTask","deleteTaskBtn","_callee3","_t3","_context3","deleteCurrentRow","kycListenerAttached","stopPropagation","kycOpening","open","tasksView","statsView","tasksHeader","statsHeader","openStatsBtn","returnToTasksBtn","refreshStatsBtn","loadStatistics","_loadStatistics","_callee13","_t1","_context14","_ref13","_callee12","dataRange","rows","todoCount","inProgressCount","doneCount","brokerStats","monthlyStats","kycMonthly","totalDuration","durationCount","overdueItems","upcomingItems","staleItems","sevenDaysFromNow","thirtyDaysAgo","_loop","activeTasks","totalStatus","renderAttentionGroup","monthlyChart","sortedMonths","maxTasks","maxKyc","maxVal","monthNames","brokerChart","sortedBrokers","_maxTasks","_context13","setDate","getDate","broker","taskSummary","taskDate","dateE","dateF","dateG","availableDates","monthKey","_context12","parseDate","reduce","min","getFullYear","getMonth","padStart","total","active","completed","lower","completedMatch","kycDate","taskNameMatch","assigneeMatch","deadlineMatch","daysUntil","detail","abs","initiatedMatch","updatedMatch","lastActionDate","daysSince","initiated","days","_regeneratorValues","width","items","groupId","listId","countId","group","container","countEl","item","assigneePart","sort","b","parseInt","keys","reverse","max","month","_month$split2","_slicedToArray","shortMonth","tasks","kyc","kycHeight","entries","_ref14","_ref16","_ref18","_ref19","stats","activeWidth","completedWidth","_x0","dateVal","excelEpoch","UTC","utcDate","getUTCFullYear","getUTCMonth","getUTCDate","dateStr","isoMatch","year","day","jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec","searchInput","searchInputWrap","searchBtn","searchResults","searchHint","searchTabs","currentSearchMode","loadRowHint","updateSearchUI","placeholder","tab","_callee4","_context4","getAttribute","performSearch","_callee5","_context5","_ref6","_callee6","_context6","key","hideAutocomplete","_x5","autocompleteDropdown","companyList","autocompleteTimeout","loadCompanyList","_loadCompanyList","_callee15","_t10","_context16","_ref20","_callee14","category","_context15","rowNum","_x1","showAutocomplete","query","q","allMatches","startsWithMatches","containsMatches","sortedMatches","categoryHint","_callee7","_context7","selectAndLoadRow","_performSearch","_callee18","_t11","_context20","_ref21","_callee17","rawValues","results","scannedRows","_loop2","totalRows","modeLabel","rawQuery","_context19","taskCategory","hasActiveTasks","dominantStatus","hasTodo","hasProgress","hasDone","todoDates","progressDates","doneDates","mostRecentDate","statusDateLabel","statusDateRaw","statusDateDisplay","_context18","dateArr","dStr","yyyy","mm","dd","every","parsed","parseTaskLine","st","updated","formatDateForDisplay","statusBadge","datePart","_callee16","_context17","_x10","_x6","_selectAndLoadRow","_callee20","_context22","_ref23","_callee19","_context21","select","_x11","findLastKycDate","_x7","_findLastKycDate","_callee22","_context24","_ref24","_callee21","usedRange","lastKycDate","rowCompany","_context23","getUsedRange","_x12","ymdMatch","clearTimeout","val","target","_callee8","_context8","formatDateForExcel","getSelectedCategories","isOtherTaskSelected","checked","getTaskCard","getTaskStatusChips","setCardStatus","getCardStatus","contains","syncTasksVisibility","isOther","otherCard","hasNonOtherCategory","selected","getSelectedTaskToggles","updateExtraNotePlaceholder","categories","reorderCheckboxesToTop","containerSelector","children","unchecked","loadTeamMembers","_loadTeamMembers","_callee24","_context26","initialized","_ref25","_callee23","teamMembers","noneOpt","_context25","opt","_x13","getSelectedAssignees","updateTaskAssigneeDropdowns","selectedAssignees","dropdown","currentValue","emptyOpt","basicMatch","exec","comment","giveUpId","commentMatch","giveUpMatch","buildSummaryLine","assignees","_loadFromActiveRow","_callee28","_context30","_ref27","_callee27","selectedRange","uiRow","companyRange","descRange","assigneesRange","brokerRange","datesRange","jRange","kRange","companyVal","descVal","brokerVal","assigneesVal","assigneesList","datesRow","toInputDate","freqVal","noteVal","parsedTasks","nonTaskLines","cand","statusPriority","sNorm","commentEl","deadlineEl","taskAssigneeEl","chosenAudit","lastKycEl","kycCompletedDate","_context29","dmmyMatch","mon","getSelectedRange","rowIndex","cat","giveUpIdEl","pt","ptName","cbName","date","updateDateDisplays","updateEmailSummaryButton","emailSummarySection","_x15","_saveToActiveRow","_callee30","_context32","_ref28","_callee29","existing","newTaskLines","existingTasks","getTodayFormatted","computeDates","taskAssignee","existingTask","dates","payload","builtLine","toggles","fixedNames","sortedLines","newValue","hasInProgress","hasToDo","fontColor","_context31","newStatus","oldStatus","newStatusLower","hasAnyDate","format","font","_x16","visibleCard","focus","_deleteCurrentRow","_callee32","_context34","_ref29","_callee31","_context33","delete","DeleteShiftDirection","up","_x17","_addNewTask","_callee34","_context36","_ref30","_callee33","colA","nextRow","statusLower","hRangeNew","_context35","_x18","input","_ref9","inputEl","displayEl","formatted","emailSummaryBtn","emailSummaryCount","closeEmailSummaryBtn","disabled","loadEmailSummaries","_loadEmailSummaries","_callee37","emailSummaryList","apiSummary","firstLine","restText","summaryBody","matchClass","detectedCategory","matchedAssignees","summaryNotes","participantChipsHtml","chips","matchWarningHtml","applyButtonHtml","cleanedSummaryBody","applyBtn","_t12","_context39","_ref31","_callee35","cell","_context37","_x19","_ref32","_callee36","_context38","_x20","chipClass","showSmartBriefConfirmation","_lastParsedSmartBrief","suggestionsHtml","hasSuggestions","assigneeCheckboxes","idx","taskCheckboxes","suggestedAssignee","patterns","size","maxCount","mostCommonAssignee","count","getMostCommonAssignee","assigneeHtml","_overlay$querySelecto","_overlay$querySelecto2","applyCategory","applyNotes","selectedTasks","taskAssignees","assigneesFromModal","tasksFromModal","_lastParsedSmartBrief2","appliedItems","taskAssigneesMap","allSuggestedAssignees","_ref1","_ref10","allAssigneesToSelect","dispatchEvent","Event","bubbles","selectedAssigneesForTask","taskCard","assigneeSelect","options","backgroundColor","statusChips","chip","getElementById","animation","applySmartBriefSelections","_callee9","_context9","Office","onReady","info","host","HostType","closest","selector","el"],"ignoreList":[],"sourceRoot":""}